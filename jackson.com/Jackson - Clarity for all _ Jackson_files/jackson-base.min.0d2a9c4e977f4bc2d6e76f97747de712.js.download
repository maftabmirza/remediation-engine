function getCookie(name) {
        var v = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
        return v ? v[2] : null;
}

function parseCookie(name) {
        var cookie = getCookie(name);
        if (cookie !== null) {
        	try{
                return JSON.parse(atob(cookie.split(/\./)[1]));
        	}catch(e){

        	}
        }
        return {
           "groups": [],
           "name": "",
           "id": ""
      	};
}

function gotoPreviousPage() {
	window.history.back();
    return false;
}

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.Utility = function() {

        const Constants = {
            Attribute : {
                ariaExpanded : 'aria-expanded'
            },
            Key : {
                enter : 'Enter',
                space : ' ',
                end : 'End',
                home : 'Home',
                arrowLeft : 'ArrowLeft',
                arrowRight : 'ArrowRight',
                arrowUp : 'ArrowUp',
                arrowDown : 'ArrowDown',
                escape : 'Escape',
                tab : "Tab"
            }
        };

        let scrollToElement = function (element) {
            try {
                $([document.documentElement, document.body]).animate({
                    scrollTop: $(element).offset().top - window.JCOM.FragmentNavigation.calculatedValues.fixedElementsHeight
                }, 250);
            } catch (error) {
                console.log(error);
            }
        };

        let init = function() {
        };

        return {
            scrollToElement : scrollToElement,
            init : init,
            Constants : Constants
        }
    }();
})($j);

var JCOM = JCOM || {};

JCOM.Constants = function() {
	var isFirefox = /firefox/.test(navigator.userAgent.toLowerCase());
    var isSafari = /safari/.test(navigator.userAgent.toLowerCase());

    return {
        isFirefox : isFirefox,
        isSafari : isSafari
    }
}();
(function($) {
window.JCOM = window.JCOM || {};

window.JCOM.session = function() {

    const SELECTOR_AUTH_PUBLIC = '.auth-public';
    const SELECTOR_PROFILE_SELECT = '#profileSelect';
    const SELECTOR_TIMEOUT_PANEL = '.session-timeout-panel';
    let remainingCount;
    let countDownStartTimer;
    let userLoggedIn = false;
    let remainingCountElement = null;
    let countDownUpdateInterval = null;
    let USER_TIMEOUT_IN_MINUTE = 180;
    let REMAINING_COUNT_INITIAL_VALUE = 60;
    let HEARTBEAT_INTERVAL_IN_MILLISECOND = 120000;

    var DASHBOARD_URL = "/dashboard/dashboard.xhtml";
    let SH_HUB_URL = "/statefarm/index.html";

    let verifyAndValidateSecurity,
        initSessionTracking,
        keepAlive,
        heartBeatPoll,
        countDownStart,
        updateCountDown,
        invalidateSession,
        updateWaitTimeToStartCountDown,
        stopCountDown,
        processForLoggedInUser;

    let init = function () {
        if (typeof authorRunMode === 'undefined' || !authorRunMode) {
            verifyAndValidateSecurity();
        } else {
            $(SELECTOR_AUTH_PUBLIC).removeClass('hidden');
        }
        window.JCOM.FragmentNavigation.refresh();
    }

    let toggleAuthElementVisibility = function (isPublic) {
        if(isPublic === true) {
            $(".auth-private").addClass('hidden');
            $(SELECTOR_AUTH_PUBLIC).removeClass('hidden');
        } else {
            $(SELECTOR_AUTH_PUBLIC).addClass('hidden');
            $(".auth-private").removeClass('hidden');
            $(".broker-check-link").remove();
        }
        window.JCOM.FragmentNavigation.refresh();
    };

    let delayAuthElementVisibility = function (isPublic) {
        if (window.ContextHub && ContextHub.SegmentEngine) {
            ContextHubJQ(function() {
                ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                    toggleAuthElementVisibility(isPublic);
                });
            });
        }
        // run a second time so we can capture pages not being targeted along with pages being targeted
        toggleAuthElementVisibility(isPublic);
    };

    let processForPublicUser = function(refresh) {
        if (refresh) {
            location.reload();
        }

        delayAuthElementVisibility(true);

        // Enable session tracking if legacy component is included in the page
        if ($(".legacy-component").length > 0) {
            initSessionTracking();
        }
    }

	let profileSort = function(o1, o2) {
        let a = o1.profileName;
        let b = o2.profileName;

        let returnVal = 0;
        if (a > b) {
            returnVal = 1;
        } else if (a < b) {
        	returnVal = -1;
        }
        return returnVal;
    }

    let updateHeroImageLink = function (jacksonCookieData) {
        let heroImageLink = $(".masthead .image a");
        let isStateFarmTemplate = $('meta[name="template"][content*="state-farm"]').length > 0;

         // logo link not found, exit updating link
        if (heroImageLink.length === 0) {
            return;
        }

        if (jacksonCookieData.profiles === undefined && jacksonCookieData.jacksonhub === 'statefarm') {
            // state farm SSO only
            heroImageLink.attr("href", SH_HUB_URL);
            heroImageLink.attr("target", "_self");
        } else if (jacksonCookieData.profiles !== undefined && !isStateFarmTemplate) {
            // dashboard profiles foound and not on SF page, direct to dashboard
            heroImageLink.attr("href", DASHBOARD_URL);
        }
    }

	processForLoggedInUser = function(msg) {
		// Valid cookie found
        userLoggedIn = true;
        let jacksonCookieData = parseCookie("jackson");
        let userName = $(".breadcrumb .user-name");

        // dynamically update hero link to dashboard or state farm home based on jackson cookie
        updateHeroImageLink(jacksonCookieData);

        // SSO will have cookie, but may not have profile as with state farm
        if(jacksonCookieData.profiles === undefined) {
            return;
        }

        delayAuthElementVisibility(false);

		if(jacksonCookieData.profiles.length > 1) {
			jacksonCookieData.profiles.sort(profileSort);
        }

        for (let i=0; i<jacksonCookieData.profiles.length; i++) {
            $(SELECTOR_PROFILE_SELECT).append(new Option(jacksonCookieData.profiles[i].profileName, jacksonCookieData.profiles[i].profileId))
         }

        $(SELECTOR_PROFILE_SELECT).val(jacksonCookieData.pid).addClass('populated');
        $("#topProfileName").html(jacksonCookieData.name);

        if(jacksonCookieData.profiles.length > 1) {
            $("#userProfile").show();
            $('.auth-breadcrumb').hide();
        }

        if (userName.length > 0) {
            userName.text(msg.data.userName);
        }

		// Updating timeout to 30 minutes for logged in user
        USER_TIMEOUT_IN_MINUTE = 30;

        var breadcrumbFirstLink = $(".breadcrumb li.cmp-breadcrumb__item:first a");
        if (breadcrumbFirstLink && breadcrumbFirstLink.length > 0) {
        	breadcrumbFirstLink.attr("href", DASHBOARD_URL);
    	}
        // Showing all the secured links for logged in users
        $(".secure-link").removeClass("hidden");

        // Initializing the session tracking
        initSessionTracking();
	}

	verifyAndValidateSecurity = function() {
        // Checking if the user is logged in or not
        $.ajax({
            type: 'GET',
            cache: false,
            url:'/content/services/securityServlet.html',
            success: function(msg){
                if (msg.data.userLoggedIn === true) {
                    processForLoggedInUser(msg);
                } else {
                    processForPublicUser(msg.data.refreshPage);
                }
            },
            error: function(msg) {
                processForPublicUser(false);
            }
        }).always(function () {
            $(document).trigger('ui-update');
            window.JCOM.FragmentNavigation.refresh();
        });
    }

    initSessionTracking = function() {
        $(SELECTOR_TIMEOUT_PANEL).dialog({
            autoOpen: false,
            modal : true,
            dialogClass: 'session-timeout-dialog',
            title: 'Important'
        });
        remainingCountElement = document.getElementById('remainingCount');
        keepAlive("false");
        heartBeatPoll();
    }

	let performAction = function(waitTimeToStartCountDown) {
		if (waitTimeToStartCountDown > 0) {
			if (countDownStartTimer) {
				clearTimeout(countDownStartTimer);
			}
			countDownStartTimer = setTimeout(countDownStart, waitTimeToStartCountDown);
		} else if (remainingCount === REMAINING_COUNT_INITIAL_VALUE) {
            //just started count down
		    remainingCountElement.innerHTML = remainingCount;
		    if (userLoggedIn === true) {
			    window.focus();
                $(SELECTOR_TIMEOUT_PANEL).parent().css({position:"fixed"}).end().dialog('open');
		    }
		    countDownUpdateInterval = setInterval(updateCountDown, 1000);
        } else if (remainingCount === 0) {
            // count down ends
		    invalidateSession();
		}
	}

	countDownStart = function() {
		remainingCount = REMAINING_COUNT_INITIAL_VALUE;
		updateWaitTimeToStartCountDown();
	}

	updateCountDown = function() {
		if (remainingCount === 0) {
			// about to invalidate session
	    	stopCountDown();
	    	updateWaitTimeToStartCountDown();
		} else {
	  		remainingCountElement.innerHTML = remainingCount;
			remainingCount = remainingCount - 1;
		}
	}

	stopCountDown = function() {
        $(SELECTOR_TIMEOUT_PANEL).dialog('close');
		clearInterval(countDownUpdateInterval);
	}

	let continueSession = function() {
		keepAlive("false");
	}

	invalidateSession = function() {
        if (userLoggedIn === true) {
			window.location.href = "/logout";
        } else {
			window.location.reload();
        }
	}

	keepAlive = function(aliveFlag, callbackFn) {
        $.ajax({
            type: 'GET',
            url:'/external/sessionManagerWebService/keepAlive?hearBeatRequest='+aliveFlag,
            success: function(msg){
                if (msg.status === 'success') {
                    updateWaitTimeToStartCountDown();
                }
                if (callbackFn && typeof(callbackFn) === 'function') {
                    callbackFn();
                }
            }
        });
	}

	updateWaitTimeToStartCountDown= function() {
         $.ajax({
            type: 'GET',
            url:'/external/sessionManagerWebService/calculateWaitTimeToStartCountDown?userTimeoutInMinute='+USER_TIMEOUT_IN_MINUTE+'&hearBeatRequest=true',
            success: function(msg){
                if (msg.status === 'success') {
                    performAction(msg.waitTimeToStartCountDown);
                }
            }
        });
	}

    heartBeatPoll = function() {
        setInterval( function() { keepAlive("true"); }, HEARTBEAT_INTERVAL_IN_MILLISECOND );
	}

    $(SELECTOR_PROFILE_SELECT).change(function() {
		$(SELECTOR_PROFILE_SELECT).closest("form")
     	    .append($j('<input>', {
                'name': 'profileSelect',
                'value': $(SELECTOR_PROFILE_SELECT).val(),
                'type': 'hidden'
            }))
            .submit();
    })

    return {
        init : init,
        stopCountDown : stopCountDown,
        continueSession : continueSession,
        invalidateSession : invalidateSession
    }
}();
})($j);


(function($) {
window.JCOM = window.JCOM || {};

window.JCOM.security = function() {

    const SELECTOR_EXPERIENCE_FRAGMENT = '[class*=experiencefragment]';
    const SELECTOR_AUTH_URL = '[data-auth-url]';
    const ATTRIBUTE_AUTH_URL = 'data-auth-url';
    const SELECTOR_PAGE_MENU_NAVIGATION = ".page-menu-navigation .page-menu";

    // show or hide element based on supplied permission and traverse to applicable parent to hide if necessary
    let showOrHideElements = function (element, hasAccess) {
        if (hasAccess) {
            // user has access
            element.removeClass('hidden');
        } else {
            // user do not have access
            if (element.hasClass('cta-product-card-block')
                || element.hasClass('promo-card-block')
                || element.hasClass('product-line-card-block')
                || element.hasClass('permission-wrapper__content')) {
                    // Test if product card is embedded in an experience fragment
                    let isInXF = element.parent().parent().parent().is(SELECTOR_EXPERIENCE_FRAGMENT) || element.parent().parent().parent().parent().is(SELECTOR_EXPERIENCE_FRAGMENT);

                    // decide which component to hide, either the card itself or the fragment it's used in
                    let component = isInXF === true ? element.parents(SELECTOR_EXPERIENCE_FRAGMENT).first() : element.closest('.cta-product-card');

                    // remove permission wrapper if current element
                    component = element.hasClass('permission-wrapper__content') && !component.is(SELECTOR_EXPERIENCE_FRAGMENT) ? element.parent() : component;

                    // if hiding a promo card hide the parent container to correct the layout
                    component = element.hasClass('promo-card-block') ? element.closest('.promo-card') : component;

                    component.addClass('hidden');
            } else {
                if (element.hasClass('level-two-menu')) {
                    element.removeAttr('href');
                    element.removeClass('hidden');
                } else {
                    element.remove();
                }
            }
        }
    }

    // check if URL based permissions are applied to elements
    let verifyUrlAccess = function(hasNoAccessUrlArray) {
    	$(SELECTOR_AUTH_URL).each(function(){
            let element = $(this);
            let dataAuthUrl = element.attr(ATTRIBUTE_AUTH_URL);
            if (dataAuthUrl && dataAuthUrl.length > 0) {
            	let hasAccess = $.inArray(dataAuthUrl, hasNoAccessUrlArray) === -1 ? true : false;
                showOrHideElements(element, hasAccess )
            } else {
                element.removeClass('hidden');
            }
        });
    }

    let hideSiteMapColumnInFooter = function() {
        $(".site-map-wrapper .cta-list").each(function(){
			if ($(this).find('.small-links a').length ===0) {
                $(this).parent().remove();
            }
        });
    }

    let cleanUpPageMenuElements = function () {
        // hiding the dropdowns on performance pages where the user doesn't have permissions to at least one link
        $(SELECTOR_PAGE_MENU_NAVIGATION).each(function(index) {
            let element = $(this);
            if (element.find("a").length === 0 ) {
                element.remove();
            } else {
                element.removeClass("hidden");
            }
        });
    }

    let validateUrlPermissionsCallBack = function(data) {
        let hasNoAccessUrlArray = [];
        if (data instanceof Array && data.length > 0) {
            $.each(data, function(index, element) {
                if (element.access === "false") {
                    hasNoAccessUrlArray.push(element.url);
                }
            });
        }
        verifyUrlAccess(hasNoAccessUrlArray);
		hideSiteMapColumnInFooter();
        // hiding the individual sections where user didn't have permission to at least one product card
        $(".layout-container .cta-product-card-wrapper").each(function(index) {
            let element = $(this);
            if (element.find("> * > *:not(.hidden)").length === 0) {
                element.closest('.layout-container').remove();
            }
        });

        // Clean up page menu links once done above
        cleanUpPageMenuElements();

        let authResources = $("#authResources");
        if (authResources.nextAll().length > 0) {
            authResources.removeClass('hidden');
        }
        $(SELECTOR_AUTH_URL).removeAttr(ATTRIBUTE_AUTH_URL);
        $( ".primary-navigation .nav > li > ul" ).each(function() {
            if ($(this).children().legth === 0) {
                $(this).parent().remove();
            }
		});
    }

    let setCookie = function(name, value, expirationTime) {
    	// Secure flag should be removed for local testing
    	document.cookie = name + "=" + value + ";expires=" + expirationTime + ";secure;path=/";
    }

    // check and return state if manually supplied in URL
    let getStateOverrideQuery = function () {
        let query = document.location.search;
        if(query === '') {
            return null;
        }

        let state = query.match(/state-override=([^&]+)/);
        if(state !== null) {
            return state;
        }

        return null;
    }

    // show/hide content based on region/state validation
    let validateRegionAccess = function(request) {
        let headerRegion = request.getResponseHeader("Region-Code");

        // use region code override if defined, else use header defined value
        let regionCode = getStateOverrideQuery();
        if(regionCode === null) {
            regionCode = headerRegion !== null ? headerRegion : null;
        }

        // no region code found, leave suppressed content suppressed
        if(regionCode !== undefined && regionCode !== null) {
            let region = regionCode[1];
            $("[data-suppress-states]").each(function(){
                let element = $(this);

                //user does not have access if matching suppressed state
                let hasAccess = !element.attr("data-suppress-states").toLowerCase().includes(region.toLowerCase());
                showOrHideElements(element, hasAccess);
            });
        }
    }

    let validateAccess = function(urls, callbackFn) {
    	let navCookie = getCookie('NAV_COOKIE');
    	let jwtValue = 'PUBLIC';

    	// riaExitUrl and riaEntryUrl are coming from region properties
    	if(window.location.pathname === ("/") || window.location.pathname.indexOf(riaExitUrl) > -1) {
    		// Delete the cookie if the index page is accessed
    		setCookie('NAV_COOKIE', '', 'Thu, 01 Jan 1970 00:00:00 UTC');
    	} else if(navCookie != null && navCookie.indexOf(riaEntryUrl) !== -1) {
    		jwtValue = riaEntryUrl;
    	} else {
    		let url = window.location.pathname;
    		if(url.indexOf(riaEntryUrl) !== -1) {
    			setCookie('NAV_COOKIE', riaEntryUrl, -1);
    			jwtValue = riaEntryUrl;
    		}
    	}

        let request = $.post("/external/accessManagerService", {jwtTokenString:jwtValue, checkUrls: JSON.stringify(urls)}, function(data, status, xhr) {
            if (callbackFn && typeof(callbackFn) === 'function') {
                callbackFn(data);
            }
        }).fail(function(response) {
            callbackFn([]);
        }).always(function () {
            // product card links with no children links after access check need to be cleaned up(removed)
            $('.small-links').each(function () {
                let element = $(this);

                if($('a:not(hidden)', element).length === 0) {
                    element.remove();
                }
            });
            validateRegionAccess(request);
        });
    }

    let validateUrlPermissions = function() {
        let url;
        let urls = new Set();

        if ($(SELECTOR_AUTH_URL).length > 0) {
            $(SELECTOR_AUTH_URL).each(function(){
                url = $(this).attr(ATTRIBUTE_AUTH_URL);
                if (url && url.length > 0) {
                    urls.add(url);
                }
            });
            if (urls.size > 0) {
                let urlArray = [];
                urls.forEach(function (value) {
                    urlArray.push(value);
                });
                validateAccess(urlArray, validateUrlPermissionsCallBack);
            }
        } else if($("[data-suppress-states]").length > 0 && urls.size === 0) {
            // since accessmanagerservice is not needed, but state permissions exist, create ajax query to gather information for valication
            let request = $.get("/content/dam/jacksoncom/favicon.ico").always(function () {
                validateRegionAccess(request);
            });
        }

        // run cleanup for elements within page menu after other cleanup is complete to ensure this isn't missed
        if ($(SELECTOR_AUTH_URL).length === 0) {
            cleanUpPageMenuElements();
        }
    }

    let init = function () {
        if (typeof authorRunMode === 'undefined' || !authorRunMode) {
        	if (window.ContextHub && ContextHub.SegmentEngine) {
                ContextHubJQ(function() {
                    ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                        validateUrlPermissions();
                    });
                });
        	}
        	validateUrlPermissions();

            // listen for content-changed events, one instance is triggered by experience fragment personalization
            $(document.body).on('content-changed', validateUrlPermissions);
        } else {
            $(SELECTOR_AUTH_URL).removeClass('hidden');
            $("#authResources").removeClass('hidden');
        }
    }

    return {
        init : init
    }
}();
})($j);


(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.Tab = function() {

        const SELECTOR_TABS = '.tab-container .tab-container li[role="tab"]';

        // updates page form number for tabs with this defined
        let updateFormNumber = function(tabFormNumber, tabArchiveFormNumber){
            let formNumberElement = $('.form-number p:first-child');
            let archiveFormNumberElement = $('.form-number p.archive-form-number');
            if(tabFormNumber !== ''){
                formNumberElement.text(tabFormNumber);
            }

            if(tabArchiveFormNumber !== ''){
                archiveFormNumberElement.text(tabArchiveFormNumber);
            }
        };

        let checktabScrollState = function (tabElement) {
            let tabContainer = $('> .tab-container', tabElement);
            if(tabContainer.length > 0 && tabContainer.get(0).scrollWidth > tabContainer.get(0).clientWidth) {
                tabContainer.addClass('is-overflowing');
            } else {
                tabContainer.removeClass('is-overflowing');
            }
        };

        let attachEventListeners = function () {
            $('.tab:not(".event-setup")').each(function(){
                let element = $(this);
                element.addClass('event-setup');

                let tabs = element.find('> .tab-container > ul > li');
                let tabContents = element.find('> .tab-content-wrappper > .tab-content');

                if(element.parents('.hero-space').length > 0) {
                    tabs = element.find('[role="tab"]');
                    tabContents = element.find('.tab-content');
                }

                // marks active and shows selected tab, then changes form number to match
                let activateTab = function(tabs, tabContents, tabIndex) {
                    let selectedTab = tabs.eq(tabIndex);
                    let otherTabs = tabs.not(selectedTab);

                    otherTabs.removeClass('active');
                    otherTabs.attr('tabindex', '-1');
                    otherTabs.attr('aria-selected', 'false');

                    selectedTab.addClass('active');
                    selectedTab.attr('tabindex', '0');
                    selectedTab.attr('aria-selected', 'true');

                    tabContents.addClass('hidden');
                    tabContents.eq(tabIndex).removeClass('hidden');

                    let tabFormNumber = $('.tab-form-number', selectedTab).first().text();
                    let tabArchiveFormNumber = $('.tab-archive-form-number', selectedTab).first().text();
                    updateFormNumber(tabFormNumber, tabArchiveFormNumber);
                };

                // handles hash value changes
                let hashChangeHandler = function(){
                    let hash = window.location.hash;
                    if(hash !== "" && (hash.indexOf('jump-to-') !== 1) ){
                        let tabId = $(window.location.hash);
                        let tabPanel = $(hash).closest('[role="tabpanel"]');

                        // using original tabId to check if the tab is located in the 1st set of tabs. Also using the original tabId for 2nd tab component because tabPanel.length is > 0 for the first tab on the 2nd tab component and causes an incorect index to be passed to activateTab
                        let originalTabId = tabId;

                        if(tabPanel.length > 0) {
                            tabId = $("#" + tabPanel.attr("id").replace("-tab",""));
                        }

                        // check if a tab container exists inside a tab content container
                        if ($('.tab-content .tab-container').length > 0) {
                            // check if the tab is contained in the first tab container
                            if($('.tab-container').first().find(originalTabId).length > 0) {
                                // activate the tab in the first tab container
                                activateTab(tabs, tabContents, tabs.index(tabId));
                            } else {
                                // activate the tab in the second tab container
                                let tabs2 = element.find(SELECTOR_TABS);
                                let tabContents2 = element.find(".tab-container .tab-content");
                                activateTab(tabs2, tabContents2, tabs2.index(originalTabId));
                            }
                        } else {
                            // activate tabs using the normal process
                            activateTab(tabs, tabContents, tabs.index(tabId));
                        }

                    }
                };

                // shows first tab by default
                activateTab(tabs, tabContents, 0);


                // handles request to change tab to a selected one on the 1st tab component
                let tabSelectionHandler = function(e) {
                    let tab = $(this);

                    let tabIndex = e.data.tabs.index(tab);

                    activateTab(e.data.tabs, e.data.tabContents, tabIndex);

                    // replace current tab in browsing history
                    if (tab.attr('id')){
                        history.replaceState(null, null, '#' + tab.attr('id'));
                    } else {
                        history.replaceState(null, null, ' ');
                    }

                    e.preventDefault();
                };

                // attach mouse/touch listener
                tabs.on("click", {tabs: tabs,
                                  tabContents: tabContents
                                 }, tabSelectionHandler);

                // attach keydown listener to prevent scrolling on special keys
                let keyDownHandler = function(e) {
                    if( [
                        window.JCOM.Utility.Constants.Key.space,
                        window.JCOM.Utility.Constants.Key.end,
                        window.JCOM.Utility.Constants.Key.home
                    ].includes(e.key) ) {
                        e.preventDefault();
                    }
                };

                tabs.on("keydown", keyDownHandler);

                // attached broad keyboard listener to handle standard keyboard interactions
                let keyUpHandler = function(e) {
                    e.preventDefault();

                    let tab= $(this);
                    let tabIndex = e.data.tabs.index(tab);
                    let maxTabIndex = e.data.tabs.length - 1;
                    let keycode = e.key;
                    let nextIndex = 0;

                    switch(keycode) {
                        // View currently focused tab
                        case window.JCOM.Utility.Constants.Key.enter:
                        case window.JCOM.Utility.Constants.Key.space:
                            // triggered the click event handler instead of using .call so the correct data is passed to tabSelectionHandler
                            tab.triggerHandler("click");
                            break;

                        // handle focus change commands below
                        case window.JCOM.Utility.Constants.Key.arrowLeft:
                            nextIndex = (tabIndex === 0) ? maxTabIndex : tabIndex - 1;
                            e.data.tabs.eq(nextIndex).focus();
                            break;

                        case window.JCOM.Utility.Constants.Key.arrowRight:
                            nextIndex = (tabIndex === maxTabIndex) ? 0 : tabIndex + 1;
                            e.data.tabs.eq(nextIndex).focus();
                            break;

                        case window.JCOM.Utility.Constants.Key.end:
                            e.data.tabs.eq(maxTabIndex).focus();
                            break;

                        case window.JCOM.Utility.Constants.Key.home:
                            e.data.tabs.eq(0).focus();
                            break;
                    }
                };

                tabs.on("keyup", {tabs: tabs}, keyUpHandler);

                // Remaining code to handle a 2nd tab container located inside the 1st tab container
                if (element.find(SELECTOR_TABS) != null) {
                    let tabs2 = element.find(SELECTOR_TABS);
                    // selects tab content in the 2nd tab component
                    let tabContents2 = element.find(".tab-container .tab-content");

                    activateTab(tabs2, tabContents2, 0);

                    tabs2.on("click", {tabs: tabs2,
                                       tabContents: tabContents2
                                      }, tabSelectionHandler);

                    tabs2.on("keydown", keyDownHandler);

                    tabs2.on("keyup", {tabs: tabs2}, keyUpHandler);
                }

                // check for url hash and show corresponding tab
                window.JCOM.FragmentNavigation.addHashHandler(hashChangeHandler);

                checktabScrollState(element);
                $(window).on('resize.tabResize', function () {
                    checktabScrollState(element);
                });
            });
        };

        // page load init
        let init = function () {
            if (window.ContextHub && ContextHub.SegmentEngine) {
                ContextHubJQ(function() {
                    ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                        attachEventListeners();
                    });
                });
        	}
            attachEventListeners();
        }

        return {
            init : init
        }
    }();

})($j);
(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.HeroSpace = function() {
        const EVENT_CLICK_HIDE_QUOTES = 'click.hideQuotes';

        let homeHero = $('.hero-space, .ria-herospace');
        let skipLink = $('<div class="skip" />');
        let accessibilityHelper = $('.accessibility-helper', homeHero);

        let alertScreenReader = function (message) {
            setTimeout(function () {
                accessibilityHelper.text(message);
                setTimeout(function () {
                    accessibilityHelper.text('');
                }, 3000)
            }, 500)
        };

        let attachQuoteEvents = function () {
            $('.quote-callout').each(function () {
                let element = $(this);
                let quote = $('.quote-expanded', element);
                let close = $("<button class='close-quote' tabindex='0' aria-label='Close dialog.'>X</button>");
                quote.prepend(close);

                element.on('click keyup', function (e) {
                    let closeQuote = function () {
                        element.removeClass('expand');
                        $(document).off(EVENT_CLICK_HIDE_QUOTES);
                        element.children('button').attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded, false);
                        element.children('button').focus();
                    };

                    if (e.type === 'keyup') {
                        let keycode = e.key;
                        if ([
                                window.JCOM.Utility.Constants.Key.enter,
                                window.JCOM.Utility.Constants.Key.space
                            ].indexOf(keycode) === -1) {

                            return;
                        }
                    }

                    e.stopPropagation();

                    element.toggleClass('expand');

                    if(element.is('.expand')) {
                        $(document).on(EVENT_CLICK_HIDE_QUOTES, closeQuote);

                        close.on(EVENT_CLICK_HIDE_QUOTES, function (e) {
                            e.stopPropagation();
                            closeQuote();
                        });

                        close.focus();

                        close.off('keydown');
                        close.on('keydown', function (e) {
                            e.preventDefault();
                            let keycode = e.key;
                            if ([
                                    window.JCOM.Utility.Constants.Key.enter,
                                    window.JCOM.Utility.Constants.Key.space,
                                    window.JCOM.Utility.Constants.Key.escape,
                                    window.JCOM.Utility.Constants.Key.tab
                                ].indexOf(keycode) >= 0 ) {

                                closeQuote();
                            }
                        });

                        element.children('button').attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded, true);
                    } else {
                        element.children('button').attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded, false);
                    }
                });

                quote.on('click', function (e) {
                    e.stopPropagation();
                });
            });
        };

        let init = function () {
            attachQuoteEvents();
        };

        let home = $('.home, .ria-herospace');
        if(home.length > 0) {
            let scrollToElement = $('.content-wrapper > *:has([class*=hero]), .content-wrapper > [class*=hero]').first().next();
            homeHero.append(skipLink);
            skipLink.on('click.skip', function () {
                $([document.documentElement, document.body]).animate({
                    scrollTop: scrollToElement.offset().top - window.JCOM.FragmentNavigation.calculatedValues.fixedElementsHeight
                }, {
                complete : function () { // scrolling again to account for change in height of nav
                    $([document.documentElement, document.body]).animate({
                        scrollTop: scrollToElement.offset().top - window.JCOM.FragmentNavigation.calculatedValues.fixedElementsHeight
                        },{
                            easing : 'linear',
                            duration : 500
                        });
                    },
                    easing : 'linear',
                    duration : 500
                });
            });

            let tabs = $('.tab-container li[role="tab"]', homeHero);

            tabs.each(function () {
                let element = $(this);

                element.on('click.herobg keyup', function (event) {
                    if(
                        event.type === 'keyup' &&
                        [
                            window.JCOM.Utility.Constants.Key.enter,
                            window.JCOM.Utility.Constants.Key.space
                        ].indexOf(event.key) === -1) {

                        return;
                    }

                    let supChars = [];
                    let tab = $(this);
                    let tabIndex = tabs.index(tab);
                    let tabContents = $(".hero-space .tab-content");

                    $(".headline sup", tabContents.not(tabContents.eq(tabIndex))).each(function() {
                        supChars.push($(this).text());

                    });

                    if (supChars.length > 0) {
                        $(".disclosure sup").each(function() {
                            let element = $(this);
                            if ($.inArray(element.text(), supChars) > -1) {
                                element.parent().addClass('hidden');
                            } else {
                                element.parent().removeClass('hidden');
                            }
                        });
                    }

                    alertScreenReader('Content above has changed.');
                });
            });

            $('.tab-container li[role="tab"]:eq(0)', homeHero).trigger('click');
        }

        return {
            init : init
        }
    }();
})($j);

(function($) {
    $('.video.playable img').on('click.player keyup.player', function (e) {
        if(
            e.type === 'keyup' &&
            e.key !== window.JCOM.Utility.Constants.Key.enter &&
            e.key !== window.JCOM.Utility.Constants.Key.space
        ) {
            return;
        }

        var element = $(this).closest('.video');
        var videoPlayer = element.find('iframe');
        videoPlayer.attr('src', videoPlayer.data('src'));

        element.addClass('playing');
        element.off('click.player keyup.player');
    })
})($j);
(function($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.CustomDropdown = function() {

        const EVENT_CLICK_CUSTOMDROPDOWN = 'click.customDropdown';

        //===================================================================================
        // Custom Dropdown Script
        // Usage: Add the class 'custom-dropdown' to any <select> element.
        //        This will create an html UI for a select list. Requires jQuery and jQuery UI.
        //===================================================================================
        let customDropdown = function(selectInput) {
            this.selectInput = $(selectInput);

            // templated elements for dropdown generation
            this.focusInput = $('<input type=text class="custom-dropdown-focus" />');
            this.focusContainer = $('<div class="hidden-accessible" />');
            this.elementWrapper = $('<div class="custom-dropdown" />');
            this.panel = $('<div class="custom-dropdown-panel hidden" />');
            this.trigger = $('<div class="custom-dropdown-trigger" />');
            this.label = $('<div class="custom-dropdown-label" />');
            this.hiddenContainer = $('<div class="hidden" />');
            this.itemWrapper = $('<div class="custom-dropdown-items-wrapper" />');
            this.itemContainer = $('<ul class="custom-dropdown-items custom-dropdown-list" />');
            this.panelElements = []; // quick access to items within panel
            this.focusSkip = false; // used to bypass focus event

            // holds context to allow backreferences within event listened function calls
            let $this = this;

            // create elements used in pseudo select menu
            this.init = function() {
                let itemTemplate = $('<li class="custom-dropdown-item custom-dropdown-list-item" />');

                // build pseudo item list for dropdown panel
                this.selectInput.children().each(function() {
                    let option = $(this);
                    let pseudoItem = itemTemplate.clone().text(option.text());

                    if($this.selectInput.val() === option.text()) { // set active state to what is currently selected
                        pseudoItem.addClass('active');
                    }

                    pseudoItem.addClass(option.attr('class'));

                    pseudoItem.appendTo($this.itemContainer);

                });

                // store pseudo select options for later usage
                this.panelElements = this.itemContainer.children();

                // assemble DOM for this pseudo element
                this.hiddenContainer.appendTo(this.elementWrapper)
                this.focusInput.appendTo(this.focusContainer);
                this.focusContainer.appendTo(this.elementWrapper);
                this.label.appendTo(this.elementWrapper);
                this.trigger.appendTo(this.elementWrapper);

                // dropdown panel is detached from node structure of this dropdown and appended to body
                this.itemContainer.appendTo(this.itemWrapper);
                this.itemWrapper.appendTo(this.panel);
                this.panel.appendTo(document.body);

                // select input is replaced and placed inside new wrapper
                this.selectInput.before(this.elementWrapper);
                this.selectInput.appendTo(this.hiddenContainer); // important to use appendTo or some other method that will retain event listeners

                // add any classes that may have been on original select input to the new wrapper
                this.elementWrapper.addClass(this.selectInput.attr('class'));
                this.panel.addClass(this.selectInput.attr('class')).removeClass('custom-dropdown');

                // mobile device fix preventing keyboard appearance on input focus
                if(matchMedia('(pointer:coarse)').matches) {
                    this.focusInput.attr('readonly', true);
                }

                // initialization vectors
                this.updateLabel();
                this.updateLabelWidth();
                this.updateSize();
                this.bindEvents();
            };

            // set value to first option in list, useful on browser back button, resets to original value
            this.resetValue = function() {
                this.selectInput.val(this.selectInput.children().get(0).value);
            };

            // update currently selected item
            this.updateLabel = function() {
                this.label.text(this.selectInput.children(':selected').text());
            };

            // sets the label width to the longest value
            this.updateLabelWidth = function() {
                this.label.width(this.panel.width());
            };

            // resize panel to match size of dropdown
            this.updateSize = function() {
				this.panel.width(this.elementWrapper.outerWidth());
            };

            // move dropdown menu into place on page below triggered menu
            this.repositionDropDown = function() {
                this.panel.css({left: '', top: ''}).position({
                    my: 'left top',
                    at: 'left bottom',
                    of: this.elementWrapper,
                    collision: 'none'
                });
            };

            // open the dropdown panel
            this.openPanel = function() {
                $this.repositionDropDown();

                // only perform if hidden
                if($this.panel.is(":hidden")) {
                    $this.panel.removeClass('hidden');
                    $this.elementWrapper.addClass('open');

                    // panel open, close when window resizes
                    $(window).on('resize.customDropdown', function () {
                        $this.closePanel();
                        $(window).off('resize.customDropdown');
                    });

                    // after panel is open, add listener to close it if clicked somewhere else
                    $('body').on(EVENT_CLICK_CUSTOMDROPDOWN, function(e) {
                        // if click target is not in tree of select element, close panel
                        if(!$.contains($this.elementWrapper.get(0), e.target)) {
                            $this.closePanel(e);
                            $('body').off(EVENT_CLICK_CUSTOMDROPDOWN);
                        }
                    });
                }
            }

            // close the dropdown panel
            this.closePanel = function(e) {

                this.panel.addClass('hidden');
                this.elementWrapper.removeClass('open');

                // cleanup event listener if closed by a path other than clicking off it
                $('body').off(EVENT_CLICK_CUSTOMDROPDOWN);
            };

            // move currently selection option up and down, controlled by keyboard entry
            this.navigateOptionsPanel = function(delta) {

                // open panel if closed to allow visibility into actions
                if(this.panel.is(":hidden")) {
                    this.openPanel();
                }

                let element = this.itemContainer.find('.active');
                let index = this.panelElements.index(element);

                // by default, at index 0, -1 causes wrapping to last item, but behavior doesn't happen if at last index and navigating 1
                // so this prevents the one case from index 0
                index = (index === 0 && delta === -1) ? 0 : index + delta;

                // sets active item
                element = $(this.panelElements.get(index));
                element.siblings().removeClass('active');
                element.addClass('active');

                // set value of focus input to allow screen reader access to highlighted option
                this.focusInput.val(element.text());
            };

            // selection made, update input value, fire events, and close dropdown panel
            this.selectOption = function(index) {
                $(this.selectInput.children()[index]).prop('selected', true);
                this.updateLabel();
                this.repositionDropDown();
                this.elementWrapper.click();
                this.selectInput.change();
                this.closePanel();
            };

            // create event listeners for user initiated actions for the dropdown
            this.bindEvents = function() {

                // sets focus on input when dropdown clicked, to allow further event listeners
                this.elementWrapper.click(function(e) {
                    $this.focusSkip = false;
                    $this.focusInput.focus();
                });

                this.focusInput.on('focus', function() { // open panel on focus
                    // prevent focus action if flag is set
                    if($this.focusSkip === true) {
                        $this.focusSkip = false;
                        return;
                    }
                    $this.focusInput.val($this.selectInput.val()); // added val for screen reader to read the first option
                    $this.openPanel();
                })
                .on('keydown', function (e) { // controls keyboard access when panel is open
                    let keycode = e.key;
                    switch(keycode) {
                        case window.JCOM.Utility.Constants.Key.arrowUp: // up arrow, change highlighted option
                            $this.navigateOptionsPanel(-1);
                            break;
                        case window.JCOM.Utility.Constants.Key.arrowDown: // down arrow, change highlighted option
                            $this.navigateOptionsPanel(1);
                            break;
                        case window.JCOM.Utility.Constants.Key.enter: // enter key, select highlighted option
                            let index = $this.panelElements.index($this.itemContainer.find('.active'));
                            $this.selectOption(index);
                            break;
                        case window.JCOM.Utility.Constants.Key.escape: // escape key, close panel
                        case window.JCOM.Utility.Constants.Key.tab: // tab key, close panel and navigate onward
                            $this.closePanel(e);
                            break;
                        default:
                            // TODO: implement navigating selection list by keyboard sequence within a time period
                            break;
                    }

                    // allow tabbing away from dropdown focus, preventing all others for capture and action above
                    if(keycode !== 9) {
                        e.preventDefault();
                    }
                });

                this.itemContainer.children().hover(function() { // hovering items in panel, changes highlighted option
                    let element = $(this);
                    element.siblings().removeClass('active');
                    element.addClass('active');

                    // set value of focus input to allow screen reader access to highlighted option
                    $this.focusInput.val(element.text());
                })
                .click(function() { // clicking on an option changes selected value for dropdown
                    let index = $this.panelElements.index(this);
                    $this.selectOption(index);
                    $this.focusSkip = true;
                });

                this.selectInput.on('change', function () {
                    $this.updateLabel();
                });
            };

            // start setup of current menu
            this.init();
        };

        let init = function () {
            // Run emulation on each matching element and skip delay loaded dropdowns
            $('.custom-dropdown:not(.populate-delay)').each(function() {
                new customDropdown(this);
            });

            // run on delay load drop down elements
            $(document).on('ui-update', function () {
                $('.custom-dropdown.populated').each(function() {
                    new customDropdown(this);
                });
            });
        };

        return {
            init : init
        }
    }();
})($j);

(function($) {
window.JCOM = window.JCOM || {};

window.JCOM.FormFields = function() {

    var textareaChangeHandler = function () {
        var element = $(this);

        element.css({height : 5});
        element.css({height : this.scrollHeight + 20});
    };

    var init = function () {
        var formFields = $('.field input, .field select, .field textarea');

        formFields.each(function () {
            var element = $(this);
            var parent = element.parent('.field');
            var value = element.val();


            if(element.is('[class*=drop-down]')) {
                value = $(':selected', element).val();
            }

            if(value !== '' || element.is('[type="date"]')) {
                parent.addClass('focus');
            }

            element.on('focus', function(){
                parent.addClass('focus');
            });

            element.on('blur', function(){
                var value = element.val();

                if(element.is('[class*=drop-down]')) {
                    value = $(':selected', element).val();
                }

                if(value === '' && !element.is('[type="date"]')) {
                    parent.removeClass('focus');
                }
            });

            if(element.is('[maxlength]')) {
                var countContainer = $('.char-count', parent);
                var countElement = $('.count', countContainer);

                var handleCharCount = function () {
                    var length = element.val().length;

                    countElement.text(length);

                    if(length === 0) {
                        countContainer.addClass('hidden');
                    } else {
                        countContainer.removeClass('hidden');
                    }
                };

                element.bind('input propertychange', handleCharCount);
                handleCharCount();
            }
        });

        formFields.filter('textarea:not([name="messageLead"])').each(textareaChangeHandler).on('input', textareaChangeHandler)
    };

    return {
        init : init
    }
}();
})($j);

(function($) {
window.JCOM = window.JCOM || {};

window.JCOM.ResourceFilter = function() {

	const SELECTOR_FILTER_TOPIC = '#filter-topic';
	const SELECTOR_FILTER_TEXT = '#filter-text';
	const SELECTOR_FILTER_TYPE = '#filter-type';
	let appliedFilters = {};
	let filterableResources;
	let emptyMessage;
	let resourcesTab;

	let config = {
		minimumSearchInputCharacters : 3
	};

	// add a new filter to array of currently applied filters
	let addFilter = function (filterType, filter) {
		appliedFilters[filterType] = filter;
	};

	// removes a filter from currently applied filters
	let removeFilter = function (filterType) {
		delete appliedFilters[filterType];
	};

	// checks listing if empty, show messaging
    let checkForEmptyListings = function () {
        if (filterableResources.filter(':not([class$="hidden"])').length > 0 || resourcesTab !== true) { // if there are results in the listing and message is visible, hide it
            emptyMessage.addClass('hidden'); // hide messaging
        } else {
            emptyMessage.removeClass('hidden'); // show messaging
        }
    }

	// run all on page resources against array of filters selected
	let runFilters = function () {

		// clone resources on page into new filtered array
		let filteredResources = filterableResources;

		// hide all resources by default
		filterableResources.parent().parent().addClass('hidden');

		// loop through each stored filter and apply it
		for (let filter in appliedFilters) {
			filteredResources = filteredResources.filter(appliedFilters[filter]);
		}

		// show only resources that have not been filtered out
		filteredResources.parent().parent().removeClass('hidden');

		// show hide the empty listing messaging
		checkForEmptyListings();

	};

	// create a new breadcrumb node
	let createCrumb = function (element, isLinked) {
		let crumb;

        let crumbClickListener = function (e) {
            let element = e.data.element;
            let select = $(SELECTOR_FILTER_TOPIC);
            select.val(element.attr('value'));
            select.trigger('change');

            e.preventDefault();
        };

		isLinked = isLinked === undefined ? true : false;

		if(isLinked) {
			crumb = $('<li />').append($('<a href="#" />').html(element.text()));
			crumb.on('click', {element : element}, crumbClickListener);
		} else {
			crumb = $('<li />').html(element.text());
		}

		return crumb;

	};

	// update breadcrumbs with currently selected category/subcategory
	let updateBreadcrumbs = function (element) {

		// supplied element is select element, get selected <option />
		element = element.children(':selected');

		// store elements for use
		let breadcrumbContainer = $('.breadcrumbs ul');

		// remove previous breadcrumb updates if any
		breadcrumbContainer.find('li:gt(0)').remove();

		// add parent category first if sub category is selected
		if(element.is('.subcategory')) {
			let parentCrumb = createCrumb(element.prevAll(':not(.subcategory):first'));
			breadcrumbContainer.append(parentCrumb);
		}

		// add selected category to breadcrumb
		let crumb = createCrumb(element, false);
		breadcrumbContainer.append(crumb);
	};

	// run when category input changed
	let categoryChangeListener = function () {

		// get selected value
		let element = $(this);
		let value = element.val();

		if(value === "All") { // show all by removing any category filters set
			removeFilter('category');
		} else { // show only in selected category
			addFilter('category', function () {
				// check if field contains category
				return $(this).is('[data-categories*="' + value + '"]');
			});
		}

		// update the breadcrumb trail with current category selection
		updateBreadcrumbs(element);

		// execute filters
		runFilters();
	};

	// run when content type inpue changed
	let contentTypeChangeListener = function () {

		// get selected value
		let element = $(this);
		let value = element.val();

		if(value === "All") { // show all by removing any content type filters set
			removeFilter('contentType');
		} else { // show only in selected content type
			addFilter('contentType', function () {
				// check if content type exactly matches what's selected
				return $(this).is('[data-content-type="' + value + '"]');
			});
		}

		// execute filters
		runFilters();
	};

	// run when user clicks search field - used for IE 'x' to clear field
	let checkClearSearchInputListener = function () {
		let element = $(this);
		let value = element.val().toLowerCase();

		if(value.length === 0) {
			removeFilter('search');
			runFilters();
		}
	};

	// run when user types search term
	let searchInputListener = function () {

		// get input value, case insensitive toLowerCase
		let element = $(this);
		let value = element.val().toLowerCase();

		if(value.length < config.minimumSearchInputCharacters) { // remove search filter if input is less than 4 characters
			removeFilter('search');
		} else {
			addFilter('search', function () { // show results that include inputted text; case insensitive = toLowerCase
				// check if any content within element matches what's searched
				return $(this).text().toLowerCase().indexOf(value) !== -1;
			});
		}

		runFilters();
	};

	// this listener is just a proxy for the keyup event on the search field to cover case where that didn't fire and the user wishes to search
	let searchButtonListener = function () {
		// get input value, case insensitive toLowerCase
		let element = $(SELECTOR_FILTER_TEXT);
		let value = element.val().toLowerCase();

		if(value.length === 0) { // remove search filter if input is less than 4 characters
			removeFilter('search');
		} else {
			addFilter('search', function () { // show results that include inputted text; case insensitive = toLowerCase
				// check if any content within element matches what's searched
				return $(this).text().toLowerCase().indexOf(value) !== -1;
			});
		}

		runFilters();
	};

	// reset all filters on tools & resources
	let breadCrumbResetListener = function (e) {
		$(SELECTOR_FILTER_TOPIC).get(0).selectedIndex = 0;
		$(SELECTOR_FILTER_TOPIC).change();
		$(SELECTOR_FILTER_TYPE).get(0).selectedIndex = 0;
		$(SELECTOR_FILTER_TYPE).change();
		$(SELECTOR_FILTER_TEXT).val('').trigger('keyup');
		e.preventDefault();
	};

	// handle all input listeners
	let attachEventListeners = function () {
		$(SELECTOR_FILTER_TOPIC).on('change', categoryChangeListener);
		$(SELECTOR_FILTER_TYPE).on('change', contentTypeChangeListener);
		$(SELECTOR_FILTER_TEXT).on('keyup', searchInputListener);
		$(SELECTOR_FILTER_TEXT).on('input', checkClearSearchInputListener);
		$('.search-button').on('click', searchButtonListener);
		$('.breadcrumbs .filter-reset').on('click', breadCrumbResetListener);
	};
    
    let setRIAFilter = function(){
        let filter = $('div.filter-controls li.topic select');
	
        if (filter.length == 1) {
            filter[0].value="ria-and-wealth-managers";
            filter.trigger('change');
        }
    };
    
    let checkForRIACookie = function() {
        let cookieIndex = document.cookie.indexOf("NAV_COOKIE=/ria;");
        
        if (cookieIndex != -1){
            setRIAFilter();
        }
    };

	let init = function () {

		filterableResources = $('.resource-container-wrapper .base-resource');
		emptyMessage = $('.empty-message');

		// attaching event listeners
		attachEventListeners();
        
        checkForRIACookie();
	};

	return {
	    init : init
	}
}();
})($j);

(function($) {
    $('.locations-column').on('click', function () {
		var element = $(this);
        element.siblings().removeClass('expanded');
        element.addClass('expanded');
    });
})($j);

// ****************************************************************************************************************************************************
//
// YOU ARE ACCESSING CONFIDENTIAL AND PROPRIETARY INFORMATION OF JACKSON NATIONAL LIFE INSURANCE COMPANY (https://www.jackson.com). DO NOT DISCLOSE.
//
// ****************************************************************************************************************************************************

(function($) {
    // namespace Navigation intentionally different from PrimaryNavigation
    window.JCOM = window.JCOM || {};

    window.JCOM.FragmentNavigation = function() {

        const DROPDOWN_EXPANDED_CLASS = 'fragment-navigation__dropdown--expanded';
        const TRIGGER_EXPANDED_CLASS = 'fragment-navigation__link--dropdown-trigger--expanded';
        const EVENT_CLICK_CLOSE = 'click.close';
        const SELECTOR_DROPDOWN = '.js-navigation-dropdown';
        const SELECTOR_NAVIGATION_WRAPPER = '.fragment-navigation__wrapper';
        const SELECTOR_NAVIGATION_DROPDOWN_TRIGGER = '.js-navigation-dropdown-trigger';
        const SELECTOR_NAVIGATION_LIST_ITEM = '.fragment-navigation__list-item';
        const SELECTOR_MASTHEAD = '.js-masthead';
        const CLASS_MOBILE_MENU_EXPANDED = 'fragment-navigation__dropdown--expand-minimal';
        const CLASS_NAVIGATION_MINIMAL = 'fragment-navigation__wrapper--minimal';
        const CLASS_NAVIGATION_TRIGGER = 'js-navigation-dropdown-trigger';
        let mobileBreakpointQuery = window.matchMedia('(min-width: 770px)');
        let breakpointQuery;

        // key codes for Event.Key consumption
        const key = {
            enter : 'Enter',
            space : ' ',
            spacebar : 'Spacebar', //IE11
            end : 'End',
            home : 'Home',
            left : 'Left', //IE11
            leftArrow : 'ArrowLeft',
            right : 'Right', //IE11
            rightArrow : 'ArrowRight',
            escape : 'Escape'
        };

        let elements = {
            window : $(window),
            document : $(document),
            body : $(document.body),
            rootResponsive : $('.responsive'),
            header : $('.masthead'),
            headerNav : $('.masthead.nav-open'),
            contentTop : $('#mastContainer ~ .page-header, #mastContainer ~ .pageWrapper'),
            toggle : $('.toggle-container, #userProfile').filter(':first'),
            navigationComponent: $('.navigation-menu'),
            get placeholder() {
                return this.header.parent()
            },
            navItems : $('#primary-navigation > li, .aside li'),
            navTrigger : $('.primary-navigation .nav-trigger'),
            logo : $('.masthead .column-content > div:first-child img'),
            bannerNotifications : $('.aem-Grid>.full-width-container:has(.notification-message)')
        };

        let hashHandlerCallbackCollector = [];

        let scrollOffsetY = 0;

        let calculatedValues = {
            navHeight : Math.floor(elements.header.outerHeight()),
            toggleHeight : Math.floor(elements.toggle.outerHeight()),
            bannerNotificationsHeight : Math.floor(elements.bannerNotifications.outerHeight())
        };

        let recalculate = function () {
            calculatedValues.toggleHeight =  Math.floor(elements.toggle.outerHeight());
            calculatedValues.bannerNotificationsHeight = elements.bannerNotifications.length > 0 ? Math.floor(elements.bannerNotifications.outerHeight()) : 0;
            calculatedValues.navHeight = Math.floor(elements.header.outerHeight());
            calculatedValues.fixedElementsHeight = calculatedValues.navHeight + calculatedValues.toggleHeight + calculatedValues.bannerNotificationsHeight;
        };

        // stick header
        let setFixedHeader = function () {
            elements.toggle.addClass('fixed');
            elements.header.addClass('fixed');
            elements.bannerNotifications.addClass('fixed-notifications');
        };

        // attach/detach sticky header at correct location
        let scrollHandler = function (e) {
            elements.placeholder.css({paddingTop : (mobileBreakpointQuery.matches) ? calculatedValues.fixedElementsHeight : '0'});
            elements.header.css('top', (mobileBreakpointQuery.matches) ? calculatedValues.toggleHeight + calculatedValues.bannerNotificationsHeight : '0');
            elements.toggle.css('top', (mobileBreakpointQuery.matches) ? calculatedValues.bannerNotificationsHeight : '0');
            if(mobileBreakpointQuery.matches) {
                elements.header.css('left', -$(this).scrollLeft());
                if(elements.toggle.length !== 0) {
                    elements.toggle.css('left', -$(this).scrollLeft());
                }
            }
        };

        // recalculate element heights
        let refresh = function () {
            if($('.fragment-navigation').length > 0) {
                recalculate();
                scrollHandler();
            }
        };

        let initStickyNav = function () {
            recalculate();
            $(window).on('DOMContentLoaded load resize scroll', scrollHandler);
            setFixedHeader();
            scrollHandler();
        };


        let hashHandlerCallback = function () {
            for(let i in hashHandlerCallbackCollector) {
                hashHandlerCallbackCollector[i]();
            }
        };

        let addHashHandler = function (callback, immediate) {
            hashHandlerCallbackCollector.push(callback);
            immediate = immediate === undefined ? true : false;
            if(immediate === true) {
                callback();
            }
        };

        let hashScrollHandler = function () {
            let hash = window.location.hash;
            let target;
            let targetParent;

            if ( hash !== undefined && hash !== '' && hash !== '#' && (hash.indexOf('jump-to-') !== 1) && hash.indexOf('?') < 0 ) {
                target = $(hash + ' , a[name="' + hash.substring(1) + '"]');

                if(target.length === 0) {
                    return;
                }

                targetParent = target.parents('.background-container');

                if(targetParent.length > 0) { // if target has a background-container as an ancestor, use that instead
                    target = targetParent;
                }

                hashHandlerCallback();

                $('html,body').stop().animate({
                  scrollTop: target.offset().top - calculatedValues.fixedElementsHeight //offsets for fixed header
                }, {
                    complete : function () { // additional scroll accounting for changing height nav
                        $('html,body').stop().animate({
                          scrollTop: target.offset().top - calculatedValues.fixedElementsHeight //offsets for fixed header
                        }, 'linear');
                    },
                    easing : 'linear'
                });
            }
        };

        let initHashHandler = function () {
            elements.window.on('hashchange', hashScrollHandler);
            hashScrollHandler();
        };

        let toggleCompactNavigation = function () {
            if(breakpointQuery.matches === true) {
                $(SELECTOR_NAVIGATION_WRAPPER).addClass(CLASS_NAVIGATION_MINIMAL);
            } else {
                $(SELECTOR_NAVIGATION_WRAPPER).removeClass(CLASS_NAVIGATION_MINIMAL);
            }
        };

        // creates media query breakpoint for navigation and responsive views
        let attachSizingListener = function () {
            initStickyNav();
            $(SELECTOR_NAVIGATION_WRAPPER).removeClass(CLASS_NAVIGATION_MINIMAL);
            let navWrapper = $(SELECTOR_NAVIGATION_WRAPPER);
            let breakpoint = navWrapper.children('.js-primary-nav').width() + 240; // 240 includes padding to edges of viewport and padding between logo and nav
            $(breakpointQuery).off('change');
            breakpointQuery = window.matchMedia('(max-width: ' + breakpoint + 'px)');
            $(breakpointQuery).on('change', toggleCompactNavigation);
            toggleCompactNavigation();
        };

        let collapseDropdown = function (clickTarget, expandedDropdownTrigger) {
            expandedDropdownTrigger = $(expandedDropdownTrigger);
            let dropdown = expandedDropdownTrigger.next(SELECTOR_DROPDOWN);

            if(!expandedDropdownTrigger.is(clickTarget) && dropdown.has(clickTarget).length > 0) {
                return; // cancels close
            }
            $(document).off('click.closenav keyup.closenav');
            expandedDropdownTrigger.removeClass(TRIGGER_EXPANDED_CLASS).parent().removeClass('expanded').parent().removeClass('expanded');
            dropdown.removeClass(DROPDOWN_EXPANDED_CLASS);
            dropdown.css({left: ""});
        };

        let closeOtherDropdowns = function (triggerElement) {
            $('.' + TRIGGER_EXPANDED_CLASS, '.js-primary-nav, .js-secondary-nav').not(triggerElement).map(collapseDropdown);
        };

        let expandmobileSubmenu = function ($trigger, e) {
            e.preventDefault();
            let dropdown = $trigger.parent();
            if(dropdown.is('.expanded')) {
                dropdown.removeClass('expanded');
            } else {
                dropdown.addClass('expanded');
                dropdown.siblings().removeClass('expanded');
            }
        };

        let positionDropdown = function (dropdown, width) {
            let dropdownWidth = dropdown.outerWidth();
            let dropdownSidePosition = dropdown.offset().left + dropdownWidth;
            let dropdownOffsetPosition = width - dropdownSidePosition;
            if(dropdownOffsetPosition < 0 && dropdown.parent().is(':not(.fragment-navigation__list-item--mobile)')) {
                let offset = dropdown.is(':not(.fragment-navigation__dropdown--search)') ? 20 : 3;
                dropdown.css({left : dropdownOffsetPosition - offset});
            } else {
                dropdown.css({left : ''});
            }
        };

        let expandDropdown = function ($trigger, e) {
            e.preventDefault();
            let dropdown = $trigger.next(SELECTOR_DROPDOWN);
            if($trigger.is('.' + TRIGGER_EXPANDED_CLASS)) {
                collapseDropdown(e.target, $trigger);
                return;
            }

            closeOtherDropdowns($trigger);

            let width = $(document).width();
            dropdown.addClass(DROPDOWN_EXPANDED_CLASS);
            positionDropdown(dropdown, width);
            $trigger.addClass(TRIGGER_EXPANDED_CLASS);

            if($trigger.parent().is('.fragment-navigation__list-item--mobile')) {
                $trigger.parent().addClass('expanded');
                $trigger.parent().parent().addClass('expanded');
            }

            $(window).on('resize.sizing', function(){
                if ($(document.activeElement).attr('type') !== 'text') {
                    collapseDropdown(null, $trigger);
                    $(window).off('resize.sizing');
                }
            });

            $('.primary-cta-button.fragment-navigation__link, .js-minimal-nav-trigger').on('focusin.sizing', function() {
                collapseDropdown(null, $trigger);
                $('.primary-cta-button.fragment-navigation__link, .js-minimal-nav-trigger').off('focusin.sizing');
            });
        };

        let buildSideNav = function (button) {
            let homeLink = $(".masthead .image a").attr('href');
            let output = $('<header><a href="' + homeLink + '"><img src="/content/dam/jacksoncom/graphics/logos/jackson-logo-normal.png" alt="Jackson Logo"></a><div class="js-button"></div><button class="navigation-menu__icon-close navigation-menu__icon-close--main close" aria-label="Close Menu" tabindex="0"></button></header>');
            output.children('.js-button').append(button.clone());
            return output;
        };

        let expandMinimalNav = function ($trigger) {
            let $nav = $('#primary-fragment-navigation').clone();
            let $button = $('.primary-cta-button', $nav);
            let $container = $trigger.next('.fragment-navigation__list--minimal .js-navigation-dropdown');
            if($container.children().length === 0) {
                let navContent = buildSideNav($button);
                $container.append(navContent);
                $('.fragment-navigation__list-item--site-section', $nav).addClass('fragment-navigation__list-item--mobile').removeClass('fragment-navigation__list-item--site-section');
                $('.fragment-navigation__link--site-section', $nav).addClass('fragment-navigation__link--mobile-section').removeClass('fragment-navigation__link--site-section');
                $('.fragment-navigation__link--dropdown-trigger', $nav).addClass('fragment-navigation__link--mobile-expandable').removeClass('fragment-navigation__link--dropdown-trigger')
                let iconMenu = $('.las.la-bars',$nav).parent();

                $('.fragment-navigation__list-item--button', $nav).remove();
                $('.fragment-navigation__list-item--search', $nav).remove();
                iconMenu.parent().addClass('fragment-navigation__list-item--open');
                iconMenu.remove();
                $container.append($nav);
            }
            $($container).on(EVENT_CLICK_CLOSE, '.close', function () {
                $container.removeClass(CLASS_MOBILE_MENU_EXPANDED);
                $($container).off(EVENT_CLICK_CLOSE);
            });
            $container.addClass(CLASS_MOBILE_MENU_EXPANDED);
        };

        // ignore focus when item is clicked, to prevent focus and click from duplicating open/close menu
        let ignoreFocus = false;

        let mousedownHandler = function (e) {
            if(e.target.classList.contains(CLASS_NAVIGATION_TRIGGER)) {
                e.stopImmediatePropagation();
                e.preventDefault();
                document.activeElement.blur();
                ignoreFocus = true;
            }
        };

        let focusinHandler = function (e) {
            if(ignoreFocus === true) {
                return;
            }
            let inNavigationContainer = $(e.target).closest(SELECTOR_NAVIGATION_LIST_ITEM).length > 0;
            if(inNavigationContainer && e.target.classList.contains(CLASS_NAVIGATION_TRIGGER) && !e.target.classList.contains(TRIGGER_EXPANDED_CLASS)) {
                e.stopImmediatePropagation();
                expandDropdown($(e.target), e);
            } else if(!inNavigationContainer) {
                closeOtherDropdowns($(e.target));
            }
        };

        let clickHandler = function (e) {
            ignoreFocus = false;
            let inNavigationContainer = $(e.target).not('a').closest(SELECTOR_NAVIGATION_LIST_ITEM).length > 0;
            if(e.target.classList.contains(CLASS_NAVIGATION_TRIGGER)) {
                e.stopImmediatePropagation();
                e.preventDefault();
                expandDropdown($(e.target), e);
            } else if(e.target.classList.contains('fragment-navigation__list-heading')) {
                e.stopImmediatePropagation();
                e.preventDefault();
                expandmobileSubmenu($(e.target), e);
            } else if(e.target.classList.contains('nav-cludo-search-close')) {
                e.stopImmediatePropagation();
                e.preventDefault();
                $('.' + TRIGGER_EXPANDED_CLASS).click();
            } else if(inNavigationContainer) {
                e.stopImmediatePropagation();
                e.preventDefault();
                return;
            }
        };

        let minimalNavHandler = function (e) {
            if(e.target.classList.contains('js-minimal-nav-trigger')) {
                e.stopImmediatePropagation();
                expandMinimalNav($(e.target));
            }
        };

        let outsideNavHandler = function (e) {
            $('.fragment-navigation__dropdown--expanded').not($('.fragment-navigation__dropdown--expanded').has(e.target)).siblings('a').map(function(x,y){collapseDropdown(e.target,$(y))});
        };

        let checkNavKeyHandler = function (e) {
            let menuExpanded = $('.' + TRIGGER_EXPANDED_CLASS).length > 0;
            let inNavigationContainer = $(e.target).closest(SELECTOR_NAVIGATION_LIST_ITEM).length > 0;
            if(menuExpanded && !inNavigationContainer) {
                    $('.' + TRIGGER_EXPANDED_CLASS).focus();
            }
        };

        // attach keydown listener to prevent scrolling on special keys
        let keyDownHandler = function(e) {
            if( [
                    key.space,
                    key.spacebar,
                    key.end,
                    key.home
                ].indexOf(e.key) > -1 ) {
                e.preventDefault();
            }
        };

        // listen for keyboard events for accessibility
        let keyupHandler = function (e) {
            e.preventDefault();

            let element = $(this);
            let siblings = element.parent().children();
            let index = siblings.index(element);
            let maxIndex = siblings.length - 1;
            let nextIndex = 0;
            let nextElement;

            switch(e.key) {
                // close open navigation menus or blur activeElement
                case key.escape:
                    let inMobileNavigationContainer = $('.' + CLASS_MOBILE_MENU_EXPANDED).length > 0;
                    let menuExpanded = $('.' + TRIGGER_EXPANDED_CLASS).length > 0;
                    if(inMobileNavigationContainer) {
                        let $container = $(e.target).next('.fragment-navigation__list--minimal .js-navigation-dropdown');
                        $container.removeClass(CLASS_MOBILE_MENU_EXPANDED);
                        $($container).off(EVENT_CLICK_CLOSE);
                    } else if(menuExpanded){
                        element.children('a').focus().removeClass(TRIGGER_EXPANDED_CLASS).parent().removeClass('expanded').parent().removeClass('expanded');
                        element.children('a').next().removeClass(DROPDOWN_EXPANDED_CLASS);
                     } else {
                        document.activeElement.blur();
                     }
                    break;

                // handle focus change commands below
                case key.left:
                case key.leftArrow:
                    nextIndex = (index === 0) ? maxIndex : index - 1;
                    nextElement = siblings.eq(nextIndex).children('a').first().focus();
                    if(!nextElement.is(SELECTOR_NAVIGATION_DROPDOWN_TRIGGER)) {
                        closeOtherDropdowns(nextElement);
                    }
                    break;

                case key.right:
                case key.rightArrow:
                    nextIndex = (index === maxIndex) ? 0 : index + 1;
                    nextElement = siblings.eq(nextIndex).children('a').first().focus();
                    if(!nextElement.is(SELECTOR_NAVIGATION_DROPDOWN_TRIGGER)) {
                        closeOtherDropdowns(nextElement);
                    }
                    break;

                case key.end:
                    nextElement = siblings.eq(maxIndex).children('a').first().focus();
                    if(!nextElement.is(SELECTOR_NAVIGATION_DROPDOWN_TRIGGER)) {
                        closeOtherDropdowns(nextElement);
                    }
                    break;

                case key.home:
                    nextElement = siblings.eq(0).children('a').first().focus();
                    if(!nextElement.is(SELECTOR_NAVIGATION_DROPDOWN_TRIGGER)) {
                        closeOtherDropdowns(nextElement);
                    }
                    break;
            }
        };

        let setRIABreadcrumb = function () {
            let breadcrumbList = $('div.breadcrumb ul li');
            let addItem = '<li><a href="/ria-and-wealth-managers.html" >RIA &amp; Wealth Managers</a></li>';

            $(breadcrumbList[0]).after(addItem);
        };

        let checkRIACookie = function () {
            let cookieIndex = document.cookie.indexOf("NAV_COOKIE=/ria;");
            let locationIndex = document.location.href.indexOf('/ria-and-wealth-managers');
            let registrationIndex = document.location.href.indexOf('/registration/ria');

            if ((cookieIndex != -1) && (locationIndex == -1) && (registrationIndex == -1)){
                setRIABreadcrumb();
            }
        };

        let getPageHeadOffset = function () {
            let mastHead = document.getElementById("mastheadContainer");
            let userProfile = document.getElementById("userProfile");
            let pageHeadOffset = 0;
            pageHeadOffset += (userProfile != null) ? userProfile.offsetHeight : 0;
            pageHeadOffset += (mastHead != null) ? mastHead.offsetHeight : 0;
            return pageHeadOffset;
        };

        let init = function () {
            const masthead = $(SELECTOR_MASTHEAD);
            attachSizingListener();
            initHashHandler();
            if(window.$j === undefined) { // verify if page loaded directly
                checkRIACookie();
            }

            masthead.on('mousedown', mousedownHandler);
            masthead.on('click', clickHandler);
            masthead.on('focusin', focusinHandler);
            masthead.on('keydown', '.js-site-section, .fragment-navigation__list-item--button', keyDownHandler);
            masthead.on('keyup', '.js-primary-nav > li, .js-secondary-nav > li, .fragment-navigation__list li', keyupHandler);
            masthead.on('click', '.js-minimal-nav-trigger', minimalNavHandler);
            $(document).on('click', outsideNavHandler);
            $(document).on('keydown', checkNavKeyHandler);
        }();

        return {
            init : init,
            calculatedValues,
            attachSizingListener : attachSizingListener,
            refresh: refresh,
            addHashHandler : addHashHandler,
            getPageHeadOffset : getPageHeadOffset
        }
	}();
})(jQuery);

(function($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.PressRelease = function() {

        var initializePressReleases = function () {
            $('body').on('change', '.press-releases .year-selector', function() {
                var year = $(this).val();
                if (year !== '') {
                    var cssKey = 'year-' + year;
                    $('.press-releases .articles-area > div.' + cssKey).removeClass("hidden");
                    $('.press-releases .articles-area > div:not(.' + cssKey + ")").addClass("hidden");
                }
            });

            $('.press-releases .year-selector option:first-child').prop("selected", true).change();
        };

        var initializePressReleaseList = function () {
            $('.press-release-list').each(function () {
                var scope = this;
                var releases = $('.articles-area [class*=year-]', scope);
                var years = [];

                // Gather list of authored release years
                releases.each(function () {
                    var element = $(this);
                    var year = parseInt(element.data('year'));
                    if(years.indexOf(year) === -1) {
                        years.push(year);
                    }
                });

                // Build list of years
                years.sort(function (a,b) { return b-a});
                var yearSelector = $('.year-selector', scope);
                for(var i=0; i < years.length; i = i + 1) {
                    yearSelector.append($('<option />').attr('value', years[i]).text(years[i]));
                }

                // if input changes, show/hide associated releases
                yearSelector.on('change', function () {
                    $('.articles-area [class*=year-]', scope).addClass('hidden');
                    $('.articles-area .year-' + $(this).val(), scope).removeClass('hidden');
                });

                // run change command if not in authoring mode
                if(Granite === undefined || (Granite !== undefined && Granite.author === undefined)) {
                    $('.year-selector option:first-child', scope).prop("selected", true).change();
                }
            });
        };

        var init = function () {
            initializePressReleases();
            initializePressReleaseList();
        }

        return {
            init : init
        }
    }();
})($j);


(function($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.PerformanceCenter = function() {


        var legacy;

        var initLegacy = function () {
            var legacyFound = $('#legacyFound').val();

            if (legacyFound === 'false') {
                var legacyVal = $('#legacyUrl').val();

                if (window.location.search.length > 0 && window.location.search !== '') {
                    legacyVal += window.location.search;
                }

                legacy.load(legacyVal);
           }

            $('.legacy-component meta').remove();
        };

        var isNy = function () {
            return /isJNY=true/.test(document.location.search)
        };

        var formNumberSwap = function (view) {
                $('#disclosure').addClass('hidden');

                var formNumber = $('#formNumber').text();
                var nyPrefix = isNy() ? 'ny-' : '';
                var authoredFormNumber = legacy.data('form-number-' + nyPrefix + view);

                if (typeof authoredFormNumber !== 'undefined') {
                    formNumber = authoredFormNumber;
                }

                $('.form-number .form-number p:first-child').text(formNumber);
        }

        var updateCurrentFormNumber = function () {
            var currentView = $j('.tabSubNav .selected').attr('href').split("'")[1];
            if(typeof currentView !== 'undefined') {
                formNumberSwap(currentView);
            }
        };

        var activateFormNumberSwap = function () {
            var originalChangeTabFn = window.changeTab;

            window.changeTab = function () {
                originalChangeTabFn.apply(null, arguments);
                formNumberSwap(arguments[0]);
            };
        };

        var init = function() {
            legacy = $('#legacy');

            initLegacy();

            if(legacy.data('form-number') === true) {
                activateFormNumberSwap();
                updateCurrentFormNumber();
            }
        }

        return {
            init : init
        }
    }();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.Wcmmode = function() {

        // url parameter added to links when wcmmode=disabled
        var wcmFlag = "wcmmode=disabled";

        // function to append wcmmode flag given a link
        var appendWcmmode = function (href) {
            var result;

            var separator = (href.indexOf("?") === -1) ? "?" : "&";

            // if link has a hash applied, add wcmmode flag before the hash
            if (href.indexOf('#') >= 0) {
                var parts = href.split('#');
                result = parts[0] + separator + wcmFlag + '#' + parts[1];
            } else {
                result = href + separator + wcmFlag;
            }

            return result;
        };

        var init = function () {

            // get global variable and do not run if undefined
            if(typeof wcmmodeDisabled === 'undefined') {
                return;
            }

            // run on all anchor tags with a href parameter
            $('a[href]').each(function () {
                var link = $(this);

                // add wcmmode flag if it's not an external link
                if (link.attr('href').indexOf('http') !== 0 && link.attr('href') !== '#' && link.attr('href') !== '' ) {
                    link.attr('href', appendWcmmode(link.attr('href')));
                }
            });

            // for special case jump to list elements, append wcmmode flag
            $('.jumpToList option').each(function () {
                var element = $(this);
                var value = element.attr('value');
                if(value !== undefined && value.trim() !== "") {
                    element.val(element.val() + wcmFlag)
                }
            });
        };

        return {
            init : init
        };

    }();
})($j);

(function($) {
    const EVENT_DBLCLICK_OVERLAY = 'dblclick.overlay';
    const SELECTOR_BODY_CONTENT = '.body-content';
    let overlay;

    let showPageEditor = function () {
        window.open("/editor.html" + document.location.pathname,'_blank');
    };

    let buildButton = function (button) {
        let element = $('<button />').text(button.name);
        element.on('click', button.action);
        return element;
    };

    let attachAuthorOverlay = function () {
        overlay = $('<div></div>').css({position:'fixed',right:0,top:0,zIndex:99});
        let buttons = [
            {
                name : 'Editor',
                action : showPageEditor
            },
            {
                name : 'Run authoring issue validation',
                action : executePreFlightChecks
            }
        ];

        let removeAuthorOverlay = function () {
            overlay.remove();
            $(document).off(EVENT_DBLCLICK_OVERLAY);
            $(document).on(EVENT_DBLCLICK_OVERLAY, attachAuthorOverlay);
        };

        for(let i in buttons) {
            overlay.append(buildButton(buttons[i]));
        }

        $('body').prepend(overlay);
        $(document).off(EVENT_DBLCLICK_OVERLAY);
        $(document).on(EVENT_DBLCLICK_OVERLAY, removeAuthorOverlay);
    };

    // returns list of elements that contain text directly
    let getTextElements = function () {
        return $('a,address,dl,dt,em,h1,h2,h3,h4,h5,h6,i,label,li,span,strong,td,th', SELECTOR_BODY_CONTENT);
    };

    // find nearest parent of supplied element with a set background and return
    let getParentWithBackground = function ($element) {
        let parents = $element.parents();
        let result = null;

        parents.each(function () {
            let bg = $(this).css('background-color');
            if(bg !== 'rgba(0, 0, 0, 0)') {
                result = bg;
                return false; // end each loop
            }
        });

        return result;
    };

    // calculate luminance value for defined RGB
    let luminance = function (r, g, b) {
        var a = [r, g, b].map(function (v) {
            v /= 255;
            return v <= 0.03928
                ? v / 12.92
                : Math.pow( (v + 0.055) / 1.055, 2.4 );
        });
        return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
    }

    let colorContrastChecker = function () {
        // get elements to check for issue
        let elements = getTextElements();
        let errors = [];

        // loop through elements
        elements.each(function () {
            // check contrast of element
            const $element = $(this);
            const parentbg = getParentWithBackground($element);
            
            if(parentbg !== null) {
                // read color values
                const bgRGB = /([0-9]{1,3}), ([0-9]{1,3}), ([0-9]{1,3})/.exec(parentbg);
                const bgLuminance = luminance(bgRGB[1], bgRGB[2], bgRGB[3]);

                const textRGB = /([0-9]{1,3}), ([0-9]{1,3}), ([0-9]{1,3})/.exec($element.css('color'));
                const textLuminance = luminance(textRGB[1], textRGB[2], textRGB[3]);

                // calculate ratio
                const ratio = bgLuminance > textLuminance 
                    ? ((textLuminance + 0.05) / (bgLuminance + 0.05))
                    : ((bgLuminance + 0.05) / (textLuminance + 0.05));

                if(ratio > 1/4.5) {
                    // store elements with issue
                    errors.push($element);
                }
            }
        });

        // store issue summary
        return errors;
    };

    // looks for all elements with id, returns array with list of duplicate
    let duplicateIDChecker = function () {
        let elements = $('[id]', SELECTOR_BODY_CONTENT);
        let ids = [];
        let errors = [];

        elements.each(function () {
            let element = $(this);
            let id = element.attr('id');

            if(id !== undefined && ids[id] !== undefined) {
                errors.push({id:id});
            }
            ids[id] = element;
        });
        
        return errors;
    }

    // looks for all elements with id, returns array with list of duplicate
    let tableHeadingChecker = function () {
        let elements = $('table:not(:has(th))', SELECTOR_BODY_CONTENT);
        let errors = [];

        elements.each(function () {
            errors.push(this.outerHTML);
        });
        
        return errors;
    }

    // displays error on page noting all issue related elements
    let displayErrors = function (errors) {
        let errorMessages = errors.join('');
        let $close = $('<div><a href="#">Dismiss</a></div>');
        let $message = $(`<div class="content-wrapper"><div class="notification-message">
            <div class="content-area">
                <div class="notification-message__wrapper notification-message__wrapper--warning">
                    <div class="notification-message__icon notification-message__icon--warning">
                        <i class="las la-exclamation-triangle"></i>
                    </div>
                    <div class="notification-message__label">Authoring Issues</div>
                    <div class="notification-message__content">
                        <div class="content-area">
                            <div class="cmp-text authoring-issues">
                            <ul>${errorMessages}</ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div></div>`);

        // allows dismissal of messages
        $($close).on('click', function (e) {
            e.preventDefault();
            $message.remove();
        })

        $('.notification-message__content .content-area', $message).prepend($close);
        $('.root').prepend($message);
    };

    // runs defined tests to note issues on page
    let executePreFlightChecks = function () {
        let allIssues = [];

        let contrastIssues = colorContrastChecker();
        for(let i in contrastIssues) {
            let issue = contrastIssues[i];
            allIssues.push("<li>Color Contrast Issue found for text below. Please use a different color to improve readability.<br /><strong>" + issue[0].innerText + "</strong></li>")
        }

        let duplicateIdIssues = duplicateIDChecker();
        for(let i in duplicateIdIssues) {
            let issue = duplicateIdIssues[i];
            allIssues.push("<li>Issue with duplicate ID below. Please change so each ID is unique:<br /><strong>" + issue.id + "</strong></li>")
        }

        let tableHeadingIssues = tableHeadingChecker();
        for(let i in tableHeadingIssues) {
            let issueHTML = tableHeadingIssues[i];
            allIssues.push("<li>Issue table below. Please define table headings:<br />" + issueHTML + "</li>")
        }

        if(allIssues.length > 0) {
            displayErrors(allIssues);
        }
    };

    // if in authoring and preview of page, display helpful tools
    if(typeof wcmmodeDisabled !== "undefined" && wcmmodeDisabled === true) {
        $(document).on(EVENT_DBLCLICK_OVERLAY, attachAuthorOverlay);
    }
})($j);


(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.Accordion = function() {

        var registerAccordionClickHandler = function () {
            $('.accordion .accordion-item .accordion-title').on('click', function() {
                var element = $(this);
                var parent = element.parents('.accordion-item');
                var button = element.find('button');

                if (parent.hasClass('expanded')) {
                    parent.removeClass('expanded');
                    button.attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded,'false');
                } else {
                    parent.addClass('expanded');
                    button.attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded,'true');

                    // replace current accordion in browsing history
                    if(element.attr('id')) {
                        history.replaceState(null, null, '#' + element.attr('id'));
                    }
                }
            });
        };

        /**
         * Handles the hash change event in the URL.
         * If the hash corresponds to an accordion title button, it triggers a click event on the button and sets focus to it.
         */
        var hashChangeHandler = function () {
            const hash = window.location.hash;
            if (hash === "") {
                return;
            }

            const button = $(hash + ".accordion-title  button");
            if (button.length === 0) {
                return;
            }

            button.trigger("click").focus();
        };

        var init = function () {
            if (window.ContextHub && ContextHub.SegmentEngine) {
                ContextHubJQ(function() {
                    ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                        var accordion = $('.accordion');
                        if(accordion.length > 0) {
                            registerAccordionClickHandler();
                            window.JCOM.FragmentNavigation.addHashHandler(hashChangeHandler);
                        }
                    });
                });
                var accordion = $('.accordion');
                if(accordion.length > 0) {
                    registerAccordionClickHandler();
                    window.JCOM.FragmentNavigation.addHashHandler(hashChangeHandler);
                }
            }
        };

        return {
            init : init
        };

    }();

})($j);
(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.OptOut = function() {

        var options = $('input[name="optStatus"]');
        var showConsentPreferences = $('a[href="#showConsentPreferences"]');

        var scrollToElement = function (element) {
            $([document.documentElement, document.body]).animate({
                scrollTop: $(element).offset().top - window.JCOM.FragmentNavigation.calculatedValues.fixedElementsHeight
            },
            250,
            function () {
                $('input[name="optStatus"]:checked').focus();
            });


        };

        // command to show or hide the prompt based on document location hash
        var updateOptOutVisibility = function (e) {
            var hash = window.location.hash;
            var optOutBlock = $('.opt-out-block');

            // listen for showPrivacyOptions in hash to know to open prompt, remove from hash after
            if(hash === "#showPrivacyOptions") {
                if(e !== undefined) {
                    e.preventDefault();
                }

                optOutBlock.toggleClass('expanded');

                // hide updated message if prompt is closed, so further updates can be made without confusion
                if(!optOutBlock.is('.expanded')) {
                    $('.status').removeClass('updated');
                } else {
                    scrollToElement("#showPrivacyOptions");
                }

                history.replaceState(null, null, ' ');
            }
        };

        // update selected state of options based on cookie set
        var updateSelectedOption = function() {
            var currentStatus = getCookie("CMOptout");
            if(currentStatus == null) { currentStatus = ""; }

            options.each(function () {
                var option = $(this);
                var value = option.val();

                if(value === currentStatus) {
                    option.prop("checked", true);
                } else {
                    option.prop("checked", false);
                }
            });
        }

        // set opt out state, store in cookie and display message
        var setOptOut = function(value,msg) {
            var statusContainer = $('.status');
            var status = $('.current-status', statusContainer);

            status.text(msg);

            statusContainer.addClass('updated');
          var futureDate = new Date();
          futureDate.setFullYear(futureDate.getFullYear() + 20);
          document.cookie = "CMOptout=" + value + "; expires=" + futureDate.toGMTString() + "; path=/";
        }

        var attachPrivacyOptionsListeners = function () {
            // don't run if relevant component not found
            if(options.length < 1) {
                return;
            }

            // update display of currently set option selection
            updateSelectedOption();

            // when clicking on the update link, set the value in cookie and show status
            $('.opt-out .primary-cta-button.update').on('click', function (e) {
                e.preventDefault();
                var option = $('input[name="optStatus"]:checked');
                var value = option.val();
                var text = option.parent('label').text().replace(':','');
                setOptOut(value, text);
            });

            // listen for hash change signifying the need for displaying the selection prompt
            $(window).on('hashchange', updateOptOutVisibility);

            // if page loads with a request to open the selection prompt, allow it
            updateOptOutVisibility();
        };

        var attachConsentPreferencesListeners = function () {
            // don't run if relevant component not found
            if(showConsentPreferences.length > 0) {
                showConsentPreferences.addClass('ot-sdk-show-settings');
            }
        };

        var init = function () {
            attachPrivacyOptionsListeners();
            attachConsentPreferencesListeners();
        }

        return {
            init : init
        }
    }();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.ContactUs = function() {

        const SECURITY_ISSUE = "Security Issue";
        const SELECTOR_RESPONSE_METHOD = "[name='responseMethod']";
        const SELECTOR_FORM = ".contact-us .contact-form form, .accessibility-form form";
        const SELECTOR_CONTACTS = ".contact-us .contact-details";
        const SELECTOR_ALL_CONTACT_FIELDS = "[name='phoneNumber'], [name='extension'], [name='fax'], [name='streetAddress'], [name='city'], [name='state'], [name='zipCode']";
        const FIRST_RADIO_INPUT = $( ".contact-reason input[name=reasons]:radio" ).eq(0);

        let radioInput = $( ".contact-reason input[name=reasons]:radio" );

        let hideContactFields = function (){
            $(SELECTOR_ALL_CONTACT_FIELDS, SELECTOR_FORM).parent().addClass('hidden');
        };

        function radioInputChangeHandler() {
            let inputValue = $(this).val();
            $('button[name=reset]').trigger('click');
            if(inputValue.length > 0){
                $('.field', SELECTOR_FORM).removeClass('hidden');
                $(SELECTOR_CONTACTS + ' > div').addClass('hidden');
                $('[name="contactReason"]').remove();
                $('<input type="hidden" name="contactReason" />').val(inputValue).appendTo($('.contact-form form'));

                switch (inputValue){
                    case "Contract Owner":
                        $('.contact-details-1, .contact-details-2, .contact-details-3, .contact-details-4', SELECTOR_CONTACTS).removeClass('hidden');
                        break;
                    case "Financial Professional":
                        $('[name="policyNo"], [name="last4SsnDigits"]', SELECTOR_FORM).parent().addClass('hidden');
                        $('.contact-details-5, .contact-details-6, .contact-details-7', SELECTOR_CONTACTS).removeClass('hidden');
                        break;
                    case "Other":
                        $('[name="policyNo"], [name="last4SsnDigits"]', SELECTOR_FORM).parent().addClass('hidden');
                        $('.contact-details-8, .contact-details-9, .contact-details-10', SELECTOR_CONTACTS).removeClass('hidden');
                        break;
                    case SECURITY_ISSUE:
                        $('[name="policyNo"], [name="last4SsnDigits"], [name="topic"]', SELECTOR_FORM).parent().addClass('hidden');
                        $('.contact-details-11', SELECTOR_CONTACTS).removeClass('hidden');
                        break;
                }
            }

            $('input, select, textarea', SELECTOR_FORM).filter(':not(:hidden)').val('').trigger('change').trigger('blur').trigger('input');
        }

        let responseMethodChangeHandler = function () {
            let methodValue = $( this ).val();

            switch (methodValue){
                case "Email":
                case "No response required":
                    hideContactFields();
                    break;
                case "Phone":
                    hideContactFields();
                    $('[name="phoneNumber"], [name="extension"]', SELECTOR_FORM).parent().removeClass('hidden');
                    break;
                case "Fax":
                    hideContactFields();
                    $('[name="fax"]', SELECTOR_FORM).parent().removeClass('hidden');
                    break;
                case "Mail":
                    hideContactFields();
                    $('[name="streetAddress"], [name="city"], [name="state"], [name="zipCode"]', SELECTOR_FORM).parent().removeClass('hidden');
                    break;
                default:
                    hideContactFields();
                    break;
            }
        };

        let contactFormResetHandler = function (event) {
            window.JCOM.Validation.resetForm(event);
            hideContactFields();
            $(':focusable', SELECTOR_FORM)[0].focus();
        };

        let init = function () {
            hideContactFields();

            radioInput.change(radioInputChangeHandler);
            $(SELECTOR_RESPONSE_METHOD).change(responseMethodChangeHandler);
            FIRST_RADIO_INPUT.trigger('click');

            $('button[name=send]', SELECTOR_FORM).on('click', window.JCOM.Validation.submitForm);
            $('button[name=reset]', SELECTOR_FORM).on('click', contactFormResetHandler);
        };

        return {
            init : init
        }
    }();

})($j);

(function($) {
window.JCOM = window.JCOM || {};

window.JCOM.recaptcha = function() {

	var reCaptchaVerify = function(response) {
        window.JCOM.Validation.validateCaptcha.call(document.querySelector('.g-recaptcha-response'));
	}

    var reCaptchaExpired = function() {
        window.JCOM.Validation.validateCaptcha.call(document.querySelector('.g-recaptcha-response'));
    }

    window.reCaptchaCallback = function() {
        if ($("#recaptchaPublicKey").length  > 0) {
            var publicKey = $("#recaptchaPublicKey").val();
            grecaptcha.render('recaptcha', {
                'sitekey': publicKey,
                'callback': reCaptchaVerify,
                'expired-callback': reCaptchaExpired
            });
        }
    }

    return {
    }
}();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.Validation = function() {
        const ATTRIBUTE_REQUIRED_MESSAGE = 'data-cmp-required-message';
        const ATTRIBUTE_PATTERN_MESSAGE = 'data-cmp-pattern-message';
        const SELECTOR_PROCESSING_ERROR = '.processing-error';
        const SELECTOR_PROCESSING_ERROR_MESSAGE = ".processing-error__message";
        const CONTENT_PROCESSING_ERROR_MESSAGE = "There are concerns with some of your entries. URLs and some special characters are not supported in this form. Please review and adjust your entries to resubmit this form.";
        const CONTENT_MISMATCH_MESSAGE = "URLs and some special characters are not supported";
        const CLASS_ATTEMPTED_VALIDATION = 'attempted-validation';

        let showError = function (message, errorElem, elementContainer) {
            errorElem.html(message);
            errorElem.addClass('active');
            elementContainer.addClass('invalid');
        };

        let hideError = function (errorElem, elementContainer) {
            errorElem.html('');
            errorElem.removeClass('active');
            elementContainer.removeClass('invalid');
        };

        let validateInput = function (fieldObject) {
            const regex = /[\\/:]|www.[^s]+/;
            let field;
            if (fieldObject.target) {
                let target = $(fieldObject.target);
                field = target[0];
            } else {
                field = fieldObject;
            }
            let fieldContainer = $(field.parentElement);
            let errorElem = $('div.error', fieldContainer);
            let message;

            field.setCustomValidity('');
            if (field.validity.valueMissing) {
                message = fieldContainer.attr(ATTRIBUTE_REQUIRED_MESSAGE);
                field.setCustomValidity(message);
             } else if (!field.validity.valid && (field.validity.patternMismatch || field.validity.rangeOverflow)) {
                message = fieldContainer.attr(ATTRIBUTE_PATTERN_MESSAGE);
                field.setCustomValidity(message);
            } else if (!['date', 'number', 'email'].includes(field.type) && regex.test(field.value)) {
                message = CONTENT_MISMATCH_MESSAGE;
                field.setCustomValidity(message);
                field.checkValidity();
            } else if ((field.validity.valid ) || !fieldContainer.is(':visible')) {
                hideError(errorElem, fieldContainer);
            }
        };

        let validateCaptcha = function (event) {
            let input = $(this);
            let form = input.parents('form');
            let container = input.parents('.field');
            return handleCaptchaValidation(form, container);
        };

        let validateCaptchaForm = function (element) {
            let form = element.parents('form');
            let container = element.parents('.field');
            return handleCaptchaValidation(form, container);
         };

         let handleCaptchaValidation = function (form, container) {
            let errorElem = $('div.error', container);
            let message = $(container).attr(ATTRIBUTE_REQUIRED_MESSAGE) || 'Please complete the reCAPTCHA';
            let recaptchaValidity = false;

            if (typeof grecaptcha !== 'undefined' && grecaptcha.getResponse().length > 0) {
                hideError(errorElem, container);
                recaptchaValidity = true;
            } else {
                showError(message, errorElem, container);
                $(form).addClass(CLASS_ATTEMPTED_VALIDATION);
            }
            return recaptchaValidity;
        };

        let validateForm = function (event, formObj) {
            let isValidForm = false;
            let form = formObj[0];
            let formFields = Array.from(form.elements);
            formFields.forEach(field => {
                let inHiddenContainer = $(field).closest('.hidden').length > 0;
                if (!inHiddenContainer) {
                    validateInput(field);
                }
            });

            form.checkValidity();
            let invalidFields = $('.field.invalid:not(.hidden)', form);
            if (invalidFields.length > 0) {
                let target = invalidFields.children('input, textarea, select, #recaptcha').first();
                target.focus();
                window.JCOM.Utility.scrollToElement(target);
            } else {
                isValidForm = true;
            }

            let recaptchaValid = validateCaptchaForm($('[name=g-recaptcha-response]'));
            if (!isValidForm || !recaptchaValid) {
                // cancel invalid form submission
                event.preventDefault();
                event.stopImmediatePropagation();
            }

            // return true or false on if invalid fields are detected
            return recaptchaValid && isValidForm;
        };

        let submitForm = function (event) {
            event.preventDefault();
            event.stopImmediatePropagation();
            let form = $(event.target).closest('form');
            let isValidForm = validateForm(event, form);
            if (isValidForm) {
                $.ajax(form.attr('action'), {
                    method: 'POST',
                    data: form.serialize(),
                    success: handleFormSubmitSuccess,
                    error: handleFormSubmitError
                }).always(function (event) {
                    console.log(event);
                });
            }
        };

        let resetForm = function (event) {
            let form = $(event.target).closest('form');
            let formFields = Array.from(form[0].elements);
            event.preventDefault();
            $(event.target)
                .closest('form')
                .find('input, select, textarea')
                .not(':hidden')
                .val('')
                .end()
                .trigger('change blur input');
            resetRecaptcha();
            resetErrorMessage();
            formFields.forEach(field => {
                let container = $(field.parentElement);
                let errorElem = $('div.error', container);
                hideError(errorElem, container);
            });
        };

        let resetRecaptcha = function () {
            if (window.grecaptcha) {
                window.grecaptcha.reset();
            }
        };

        let displayErrorMessage = function () {
            $(SELECTOR_PROCESSING_ERROR).removeClass('status-hidden');
             window.JCOM.Utility.scrollToElement(SELECTOR_PROCESSING_ERROR);
             $(SELECTOR_PROCESSING_ERROR_MESSAGE).text(CONTENT_PROCESSING_ERROR_MESSAGE);
        };

        let resetErrorMessage = function () {
            $(SELECTOR_PROCESSING_ERROR).addClass('status-hidden');
            $(SELECTOR_PROCESSING_ERROR_MESSAGE).text('');
        };

        let handleFormSubmitError = function (event) {
            console.error('Form submission error:', event);
            resetRecaptcha();
            displayErrorMessage();
        };

        let handleFormSubmitSuccess = function () {
            window.location.href = '/content/jackson-aem/us/confirmation.html';
        };

        let handleInvalidInput = function (event) {
            let target = $(event.target);
            let targetContainer = target.parent();
            let targetErrorElem = $('div.error', targetContainer);
            let inHiddenContainer = target.closest('.hidden').length > 0;
            if (!inHiddenContainer) {
                targetErrorElem.prop('id', target.attr('id') + '-error');
                showError(target[0].validationMessage, targetErrorElem, target.parent());
                target.attr('aria-describedby', targetErrorElem.attr('id'));
            }
        };

        let init = function () {

            $('form.validation').each(function () {
                let form = $(this);
                form.noValidate = true;
                form.addClass(CLASS_ATTEMPTED_VALIDATION);
                $('input[type=text], input[type=tel], input[type=date], input[type=number], input[type=email], input[type=radio], textarea, select', form).on('invalid', handleInvalidInput);
                $('input[type=text], input[type=number], input[type=email], textarea, select', form).on('input', validateInput);
                $('input[type=radio], select', form).on('change', validateInput);
                $(form).on('submit', validateForm);
            });

            $('body').on('input keyup change focus blur click', 'input', function(event) {
                if(event.target.value.length > 0) {
                    $(event.target).addClass('entry-exists');
                } else {
                    $(event.target).removeClass('entry-exists');
                }
            });
        };

        return {
            init : init,
            handleFormSubmitError : handleFormSubmitError,
            handleFormSubmitSuccess : handleFormSubmitSuccess,
            validateForm : validateForm,
            validateCaptcha : validateCaptcha,
            submitForm : submitForm,
            resetForm : resetForm
        }
    }();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.CTAProductCard = function() {

        var init = function () {
            var productCards = $('.cta-product-card');
            if(productCards.length > 0 && window.location.hash !== "") {
                $(window.location.hash).addClass('focused');
            }
        };

        return {
            init : init
        }
    }();

})($j);

(function($) {

    window.JCOM.FormNumber = function() {
        var updateFormNumber = function (file, state) {
            var formNumber = $('[data-form-number]').data('form-number');
            var archiveFormNumber = $('[data-archive-form-number]').data('archive-form-number');
            var formNumberElement = $('.form-number > p:first-child');
            var archiveFormNumberElement = $('.form-number > p.archive-form-number');

            if(formNumberElement.text().trim() === '') {
                formNumberElement.text(formNumber);
            }
            if(archiveFormNumber !== undefined && archiveFormNumberElement.text().trim() === '') {
                archiveFormNumberElement.text(archiveFormNumber);
            }
        };

        var init = function () {
            var targetEvents = "";
            if ("adobe" in window && adobe.target && adobe.target.event) {
                var targetRenderingEvents = [
                    adobe.target.event.CONTENT_RENDERING_FAILED,
                    adobe.target.event.CONTENT_RENDERING_SUCCEEDED
                ]
                targetEvents = targetRenderingEvents.join(" ");
            } else {
                // Using the actual string values for the above 2 target constants
                // if target is not available at the time of executing this function
                targetEvents = "at-content-rendering-failed at-content-rendering-succeeded";
            }
            $(document).on(targetEvents, updateFormNumber);
            updateFormNumber();
        };

        return {
            init : init
        }
    }();
})($j);
(function($) {
window.JCOM = window.JCOM || {};

window.JCOM.PromoArea = function() {

    let promoFocusHandler = function (e) {
        let element = $(this);
        let container = element.closest('.promo');

        if(e.type === 'focus') {
            container.addClass('active')
        } else if (e.type === 'blur') {
            container.removeClass('active')
        }

    };

    let promoAreaExpandCollapse = function (e) {
        let trigger = $(this);
        let target = $(e.target);

        if(e.type == 'keyup' && e.key !== 'Enter') {
            return;
        }

        if(target.is('a')) {
            e.stopPropagation();
        } else {
            $('.promo-area__visibility-wrapper', trigger).toggleClass('promo-area__visibility-wrapper--visible');
            $('.promo-area__text-wrapper', trigger).toggleClass('promo-area__text-wrapper--expanded');
            $('.promo-area__trigger', trigger).toggleClass('promo-area__trigger--expanded');
            if(trigger.attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded) === 'false') {
                trigger.attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded, 'true');
            } else {
                trigger.attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded, 'false');
            }
        }
    }

    let init = function() {
        $('.promo-area .promo .primary-cta-button').on('focus blur', promoFocusHandler);
        $('.js-promo-area-trigger').on('click keyup', promoAreaExpandCollapse);
    }

    return {
        init : init
    }
}();
})($j);

(function($) {

    window.JCOM.CludoBanner = function() {
        var copyTextToClipboard = function(text) {
              var textArea = document.createElement("textarea");
              textArea.style.position = 'fixed';
              textArea.style.top = 0;
              textArea.style.left = 0;
              textArea.style.width = '2em';
              textArea.style.height = '2em';
              textArea.style.padding = 0;
              textArea.style.border = 'none';
              textArea.style.outline = 'none';
              textArea.style.boxShadow = 'none';
              textArea.style.background = 'transparent';
              textArea.value = text;
              document.body.appendChild(textArea);
              textArea.select();
              try {
                var successful = document.execCommand('copy');
                var msg = successful ? 'successful' : 'unsuccessful';
              } catch (err) {
              }
              document.body.removeChild(textArea);
        };

        var init = function () {
            var component = $('.cludo-banner');
            if(component.length > 0) {
                component.each(function () {
                    var row = $(this);
                    var button = row.find('.butn');
                    var banner = row.find('.cludo-banner-content');

                    row.hover(function () {
                        row.addClass('active');
                    }, function () {
                        row.removeClass('active');

                    });

                    button.on('click', function () {
                        copyTextToClipboard($('<div>').append(banner.clone()).html());
                        row.find('.message').show().delay(2000).fadeOut("slow");
                    });
                });
               };
        };

        return {
            init : init
        }
    }();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.Breadcrumb = function() {

        var setRIABreadcrumb = function(){
            var breadcrumbList = $('div.breadcrumb ol li');
            var addItem = '<li class="cmp-breadcrumb__item " itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a href="/content/jackson-aem/us/ria-and-wealth-managers.html" class="cmp-breadcrumb__item-link" itemprop="item"><span itemprop="name" aria-current="page">RIA &amp; Wealth Managers</span></a><meta itemprop="position" content="2"></li>';
            
            $(breadcrumbList[0]).after(addItem);
            for(var i=2; i<=breadcrumbList.length; i++){
                $(breadcrumbList[i-1]).children()[1].content = (i+1).toString();
            }
        };

        var checkForRIACookie = function() {
            var cookieIndex = document.cookie.indexOf("NAV_COOKIE=/ria;");
            var locationIndex = document.location.href.indexOf('/ria-and-wealth-managers');

            if ((cookieIndex != -1) && (locationIndex == -1)){
                setRIABreadcrumb();
            }
        };
        
        var init = function () {
            checkForRIACookie();
        };

        return {
            init : init
        }
    }();
})($j);

(function($) {
    if("PrimeFaces" in window) {
        PrimeFaces.widget.DataTable = PrimeFaces.widget.DataTable.extend({
            setupStickyHeader: function() {
                var table = this.thead.parent(),
                offset = table.offset(),
                win = $(window),
                $this = this,
                stickyNS = 'scroll.' + this.id,
                resizeNS = 'resize.sticky-' + this.id;

                this.stickyContainer = $('<div class="ui-datatable ui-datatable-sticky ui-widget"><table></table></div>');
                this.clone = this.thead.clone(false);
                this.stickyContainer.children('table').append(this.thead);
                table.prepend(this.clone);

                this.stickyContainer.css({
                    position: 'absolute',
                    width: table.outerWidth(),
                    top: offset.top,
                    left: offset.left,
                    'z-index': ++PrimeFaces.zindex
                });

                this.jq.prepend(this.stickyContainer);

                if(this.cfg.resizableColumns) {
                    this.relativeHeight = 0;
                }

                win.off(stickyNS).on(stickyNS, function() {
                    var scrollTop = win.scrollTop() + window.JCOM.FragmentNavigation.calculatedValues.fixedElementsHeight,
                    tableOffset = table.offset();

                    if(scrollTop > tableOffset.top) {
                        $this.stickyContainer.css({
                                                'position': 'fixed',
                                                'top': window.JCOM.FragmentNavigation.calculatedValues.fixedElementsHeight
                                            })
                                            .addClass('ui-shadow ui-sticky');

                        if($this.cfg.resizableColumns) {
                            $this.relativeHeight = scrollTop - tableOffset.top;
                        }

                        if(scrollTop >= (tableOffset.top + $this.tbody.height()))
                            $this.stickyContainer.hide();
                        else
                            $this.stickyContainer.show();
                    }
                    else {
                        $this.stickyContainer.css({
                                                'position': 'absolute',
                                                'top': tableOffset.top
                                            })
                                            .removeClass('ui-shadow ui-sticky');

                        if($this.stickyContainer.is(':hidden')) {
                            $this.stickyContainer.show();
                        }

                        if($this.cfg.resizableColumns) {
                            $this.relativeHeight = 0;
                        }
                    }
                })
                .off(resizeNS).on(resizeNS, function() {
                    $this.stickyContainer.width(table.outerWidth());
                });

                //filter support
                this.clone.find('.ui-column-filter').prop('disabled', true);
            }
        });
    }
})($j);
/*! jQuery UI - v1.12.1 - 2021-03-08
* http://jqueryui.com
* Includes: widget.js, position.js, data.js, disable-selection.js, focusable.js, form-reset-mixin.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/draggable.js, widgets/resizable.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/dialog.js, widgets/mouse.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(x){x.ui=x.ui||{};x.ui.version="1.12.1";var o,i=0,l=Array.prototype.slice;x.cleanData=(o=x.cleanData,function(t){for(var e,i,s=0;null!=(i=t[s]);s++)try{(e=x._data(i,"events"))&&e.remove&&x(i).triggerHandler("remove")}catch(t){}o(t)}),x.widget=function(t,i,e){var s,o,n,a={},l=t.split(".")[0],h=l+"-"+(t=t.split(".")[1]);return e||(e=i,i=x.Widget),x.isArray(e)&&(e=x.extend.apply(null,[{}].concat(e))),x.expr[":"][h.toLowerCase()]=function(t){return!!x.data(t,h)},x[l]=x[l]||{},s=x[l][t],o=x[l][t]=function(t,e){if(!this._createWidget)return new o(t,e);arguments.length&&this._createWidget(t,e)},x.extend(o,s,{version:e.version,_proto:x.extend({},e),_childConstructors:[]}),(n=new i).options=x.widget.extend({},n.options),x.each(e,function(e,s){function o(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}x.isFunction(s)?a[e]=function(){var t,e=this._super,i=this._superApply;return this._super=o,this._superApply=n,t=s.apply(this,arguments),this._super=e,this._superApply=i,t}:a[e]=s}),o.prototype=x.widget.extend(n,{widgetEventPrefix:s&&n.widgetEventPrefix||t},a,{constructor:o,namespace:l,widgetName:t,widgetFullName:h}),s?(x.each(s._childConstructors,function(t,e){var i=e.prototype;x.widget(i.namespace+"."+i.widgetName,o,e._proto)}),delete s._childConstructors):i._childConstructors.push(o),x.widget.bridge(t,o),o},x.widget.extend=function(t){for(var e,i,s=l.call(arguments,1),o=0,n=s.length;o<n;o++)for(e in s[o])i=s[o][e],s[o].hasOwnProperty(e)&&void 0!==i&&(x.isPlainObject(i)?t[e]=x.isPlainObject(t[e])?x.widget.extend({},t[e],i):x.widget.extend({},i):t[e]=i);return t},x.widget.bridge=function(n,e){var a=e.prototype.widgetFullName||n;x.fn[n]=function(i){var t="string"==typeof i,s=l.call(arguments,1),o=this;return t?this.length||"instance"!==i?this.each(function(){var t,e=x.data(this,a);return"instance"===i?(o=e,!1):e?x.isFunction(e[i])&&"_"!==i.charAt(0)?(t=e[i].apply(e,s))!==e&&void 0!==t?(o=t&&t.jquery?o.pushStack(t.get()):t,!1):void 0:x.error("no such method '"+i+"' for "+n+" widget instance"):x.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+i+"'")}):o=void 0:(s.length&&(i=x.widget.extend.apply(null,[i].concat(s))),this.each(function(){var t=x.data(this,a);t?(t.option(i||{}),t._init&&t._init()):x.data(this,a,new e(i,this))})),o}},x.Widget=function(){},x.Widget._childConstructors=[],x.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,e){e=x(e||this.defaultElement||this)[0],this.element=x(e),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=x(),this.hoverable=x(),this.focusable=x(),this.classesElementLookup={},e!==this&&(x.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=x(e.style?e.ownerDocument:e.document||e),this.window=x(this.document[0].defaultView||this.document[0].parentWindow)),this.options=x.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:x.noop,_create:x.noop,_init:x.noop,destroy:function(){var i=this;this._destroy(),x.each(this.classesElementLookup,function(t,e){i._removeClass(e,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:x.noop,widget:function(){return this.element},option:function(t,e){var i,s,o,n=t;if(0===arguments.length)return x.widget.extend({},this.options);if("string"==typeof t)if(n={},t=(i=t.split(".")).shift(),i.length){for(s=n[t]=x.widget.extend({},this.options[t]),o=0;o<i.length-1;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];if(t=i.pop(),1===arguments.length)return void 0===s[t]?null:s[t];s[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];n[t]=e}return this._setOptions(n),this},_setOptions:function(t){for(var e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(t){var e,i,s;for(e in t)s=this.classesElementLookup[e],t[e]!==this.options.classes[e]&&s&&s.length&&(i=x(s.get()),this._removeClass(s,e),i.addClass(this._classes({element:i,keys:e,classes:t,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(o){var n=[],a=this;function t(t,e){for(var i,s=0;s<t.length;s++)i=a.classesElementLookup[t[s]]||x(),i=o.add?x(x.unique(i.get().concat(o.element.get()))):x(i.not(o.element).get()),a.classesElementLookup[t[s]]=i,n.push(t[s]),e&&o.classes[t[s]]&&n.push(o.classes[t[s]])}return o=x.extend({element:this.element,classes:this.options.classes||{}},o),this._on(o.element,{remove:"_untrackClassesElement"}),o.keys&&t(o.keys.match(/\S+/g)||[],!0),o.extra&&t(o.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(i){var s=this;x.each(s.classesElementLookup,function(t,e){-1!==x.inArray(i.target,e)&&(s.classesElementLookup[t]=x(e.not(i.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var o="string"==typeof t||null===t,t={extra:o?e:i,keys:o?t:e,element:o?this.element:t,add:s};return t.element.toggleClass(this._classes(t),s),this},_on:function(o,n,t){var a,l=this;"boolean"!=typeof o&&(t=n,n=o,o=!1),t?(n=a=x(n),this.bindings=this.bindings.add(n)):(t=n,n=this.element,a=this.widget()),x.each(t,function(t,e){function i(){if(o||!0!==l.options.disabled&&!x(this).hasClass("ui-state-disabled"))return("string"==typeof e?l[e]:e).apply(l,arguments)}"string"!=typeof e&&(i.guid=e.guid=e.guid||i.guid||x.guid++);var s=t.match(/^([\w:-]*)\s*(.*)$/),t=s[1]+l.eventNamespace,s=s[2];s?a.on(t,s,i):n.on(t,i)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(e).off(e),this.bindings=x(this.bindings.not(t).get()),this.focusable=x(this.focusable.not(t).get()),this.hoverable=x(this.hoverable.not(t).get())},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(x(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(x(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(x(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(x(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,e,i){var s,o,n=this.options[t];if(i=i||{},(e=x.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],o=e.originalEvent)for(s in o)s in e||(e[s]=o[s]);return this.element.trigger(e,i),!(x.isFunction(n)&&!1===n.apply(this.element[0],[e].concat(i))||e.isDefaultPrevented())}},x.each({show:"fadeIn",hide:"fadeOut"},function(n,a){x.Widget.prototype["_"+n]=function(e,t,i){var s;"string"==typeof t&&(t={effect:t});var o=t?!0!==t&&"number"!=typeof t&&t.effect||a:n;"number"==typeof(t=t||{})&&(t={duration:t}),s=!x.isEmptyObject(t),t.complete=i,t.delay&&e.delay(t.delay),s&&x.effects&&x.effects.effect[o]?e[n](t):o!==n&&e[o]?e[o](t.duration,t.easing,i):e.queue(function(t){x(this)[n](),i&&i.call(e[0]),t()})}});var s,z,P,n,a,h,r,c,C;x.widget;function D(t,e,i){return[parseFloat(t[0])*(c.test(t[0])?e/100:1),parseFloat(t[1])*(c.test(t[1])?i/100:1)]}function k(t,e){return parseInt(x.css(t,e),10)||0}z=Math.max,P=Math.abs,n=/left|center|right/,a=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,r=/^\w+/,c=/%$/,C=x.fn.position,x.position={scrollbarWidth:function(){if(void 0!==s)return s;var t,e=x("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),i=e.children()[0];return x("body").append(e),t=i.offsetWidth,e.css("overflow","scroll"),t===(i=i.offsetWidth)&&(i=e[0].clientWidth),e.remove(),s=t-i},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),e="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight?x.position.scrollbarWidth():0,height:e?x.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=x(t||window),i=x.isWindow(e[0]),s=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:i,isDocument:s,offset:!i&&!s?x(t).offset():{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:e.outerWidth(),height:e.outerHeight()}}},x.fn.position=function(p){if(!p||!p.of)return C.apply(this,arguments);p=x.extend({},p);var u,d,f,g,m,t,_=x(p.of),b=x.position.getWithinInfo(p.within),v=x.position.getScrollInfo(b),w=(p.collision||"flip").split(" "),y={},e=9===(t=(e=_)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:x.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()};return _[0].preventDefault&&(p.at="left top"),d=e.width,f=e.height,g=e.offset,m=x.extend({},g),x.each(["my","at"],function(){var t,e,i=(p[this]||"").split(" ");1===i.length&&(i=n.test(i[0])?i.concat(["center"]):a.test(i[0])?["center"].concat(i):["center","center"]),i[0]=n.test(i[0])?i[0]:"center",i[1]=a.test(i[1])?i[1]:"center",t=h.exec(i[0]),e=h.exec(i[1]),y[this]=[t?t[0]:0,e?e[0]:0],p[this]=[r.exec(i[0])[0],r.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===p.at[0]?m.left+=d:"center"===p.at[0]&&(m.left+=d/2),"bottom"===p.at[1]?m.top+=f:"center"===p.at[1]&&(m.top+=f/2),u=D(y.at,d,f),m.left+=u[0],m.top+=u[1],this.each(function(){var i,t,a=x(this),l=a.outerWidth(),h=a.outerHeight(),e=k(this,"marginLeft"),s=k(this,"marginTop"),o=l+e+k(this,"marginRight")+v.width,n=h+s+k(this,"marginBottom")+v.height,r=x.extend({},m),c=D(y.my,a.outerWidth(),a.outerHeight());"right"===p.my[0]?r.left-=l:"center"===p.my[0]&&(r.left-=l/2),"bottom"===p.my[1]?r.top-=h:"center"===p.my[1]&&(r.top-=h/2),r.left+=c[0],r.top+=c[1],i={marginLeft:e,marginTop:s},x.each(["left","top"],function(t,e){x.ui.position[w[t]]&&x.ui.position[w[t]][e](r,{targetWidth:d,targetHeight:f,elemWidth:l,elemHeight:h,collisionPosition:i,collisionWidth:o,collisionHeight:n,offset:[u[0]+c[0],u[1]+c[1]],my:p.my,at:p.at,within:b,elem:a})}),p.using&&(t=function(t){var e=g.left-r.left,i=e+d-l,s=g.top-r.top,o=s+f-h,n={target:{element:_,left:g.left,top:g.top,width:d,height:f},element:{element:a,left:r.left,top:r.top,width:l,height:h},horizontal:i<0?"left":0<e?"right":"center",vertical:o<0?"top":0<s?"bottom":"middle"};d<l&&P(e+i)<d&&(n.horizontal="center"),f<h&&P(s+o)<f&&(n.vertical="middle"),z(P(e),P(i))>z(P(s),P(o))?n.important="horizontal":n.important="vertical",p.using.call(this,t,n)}),a.offset(x.extend(r,{using:t}))})},x.ui.position={fit:{left:function(t,e){var i=e.within,s=i.isWindow?i.scrollLeft:i.offset.left,o=i.width,n=t.left-e.collisionPosition.marginLeft,a=s-n,l=n+e.collisionWidth-o-s;e.collisionWidth>o?0<a&&l<=0?(i=t.left+a+e.collisionWidth-o-s,t.left+=a-i):t.left=!(0<l&&a<=0)&&l<a?s+o-e.collisionWidth:s:0<a?t.left+=a:0<l?t.left-=l:t.left=z(t.left-n,t.left)},top:function(t,e){var i=e.within,s=i.isWindow?i.scrollTop:i.offset.top,o=e.within.height,n=t.top-e.collisionPosition.marginTop,a=s-n,l=n+e.collisionHeight-o-s;e.collisionHeight>o?0<a&&l<=0?(i=t.top+a+e.collisionHeight-o-s,t.top+=a-i):t.top=!(0<l&&a<=0)&&l<a?s+o-e.collisionHeight:s:0<a?t.top+=a:0<l?t.top-=l:t.top=z(t.top-n,t.top)}},flip:{left:function(t,e){var i=e.within,s=i.offset.left+i.scrollLeft,o=i.width,n=i.isWindow?i.scrollLeft:i.offset.left,a=t.left-e.collisionPosition.marginLeft,l=a-n,h=a+e.collisionWidth-o-n,r="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,i="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,a=-2*e.offset[0];l<0?((s=t.left+r+i+a+e.collisionWidth-o-s)<0||s<P(l))&&(t.left+=r+i+a):0<h&&(0<(n=t.left-e.collisionPosition.marginLeft+r+i+a-n)||P(n)<h)&&(t.left+=r+i+a)},top:function(t,e){var i=e.within,s=i.offset.top+i.scrollTop,o=i.height,n=i.isWindow?i.scrollTop:i.offset.top,a=t.top-e.collisionPosition.marginTop,l=a-n,h=a+e.collisionHeight-o-n,r="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,i="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,a=-2*e.offset[1];l<0?((s=t.top+r+i+a+e.collisionHeight-o-s)<0||s<P(l))&&(t.top+=r+i+a):0<h&&(0<(n=t.top-e.collisionPosition.marginTop+r+i+a-n)||P(n)<h)&&(t.top+=r+i+a)}},flipfit:{left:function(){x.ui.position.flip.left.apply(this,arguments),x.ui.position.fit.left.apply(this,arguments)},top:function(){x.ui.position.flip.top.apply(this,arguments),x.ui.position.fit.top.apply(this,arguments)}}};var t;x.ui.position,x.extend(x.expr[":"],{data:x.expr.createPseudo?x.expr.createPseudo(function(e){return function(t){return!!x.data(t,e)}}):function(t,e,i){return!!x.data(t,i[3])}}),x.fn.extend({disableSelection:(t="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}),enableSelection:function(){return this.off(".ui-disableSelection")}});x.ui.focusable=function(t,e){var i,s,o,n,a=t.nodeName.toLowerCase();return"area"===a?(s=(i=t.parentNode).name,!(!t.href||!s||"map"!==i.nodeName.toLowerCase())&&(0<(s=x("img[usemap='#"+s+"']")).length&&s.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(a)?(o=!t.disabled)&&(n=x(t).closest("fieldset")[0])&&(o=!n.disabled):o="a"===a&&t.href||e,o&&x(t).is(":visible")&&function(t){var e=t.css("visibility");for(;"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}(x(t)))},x.extend(x.expr[":"],{focusable:function(t){return x.ui.focusable(t,null!=x.attr(t,"tabindex"))}});x.ui.focusable,x.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):x(this[0].form)},x.ui.formResetMixin={_formResetHandler:function(){var e=x(this);setTimeout(function(){var t=e.data("ui-form-reset-instances");x.each(t,function(){this.refresh()})})},_bindFormResetHandler:function(){var t;this.form=this.element.form(),this.form.length&&((t=this.form.data("ui-form-reset-instances")||[]).length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t))},_unbindFormResetHandler:function(){var t;this.form.length&&((t=this.form.data("ui-form-reset-instances")).splice(x.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset"))}},x.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},x.ui.escapeSelector=(e=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(t){return t.replace(e,"\\$1")}),x.fn.labels=function(){var t,e,i;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(e=this.eq(0).parents("label"),(t=this.attr("id"))&&(i=(i=this.eq(0).parents().last()).add((i.length?i:this).siblings()),t="label[for='"+x.ui.escapeSelector(t)+"']",e=e.add(i.find(t).addBack(t))),this.pushStack(e))},x.fn.scrollParent=function(t){var e=this.css("position"),i="absolute"===e,s=t?/(auto|scroll|hidden)/:/(auto|scroll)/,t=this.parents().filter(function(){var t=x(this);return(!i||"static"!==t.css("position"))&&s.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&t.length?t:x(this[0].ownerDocument||document)},x.extend(x.expr[":"],{tabbable:function(t){var e=x.attr(t,"tabindex"),i=null!=e;return(!i||0<=e)&&x.ui.focusable(t,i)}}),x.fn.extend({uniqueId:(p=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++p)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&x(this).removeAttr("id")})}}),x.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var e,p,u=!1;x(document).on("mouseup",function(){u=!1});x.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(t){if(!0===x.data(t.target,e.widgetName+".preventClickEvent"))return x.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!u){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,i=1===t.which,s=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&x(t.target).closest(this.options.cancel).length;return i&&!s&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===x.data(t.target,this.widgetName+".preventClickEvent")&&x.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),u=!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(x.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&x.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,u=!1,t.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),x.ui.plugin={add:function(t,e,i){var s,o=x.ui[t].prototype;for(s in i)o.plugins[s]=o.plugins[s]||[],o.plugins[s].push([e,i[s]])},call:function(t,e,i,s){var o,n=t.plugins[e];if(n&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(o=0;o<n.length;o++)t.options[n[o][0]]&&n[o][1].apply(t.element,i)}},x.ui.safeActiveElement=function(e){var i;try{i=e.activeElement}catch(t){i=e.body}return(i=i||e.body).nodeName||(i=e.body),i},x.ui.safeBlur=function(t){t&&"body"!==t.nodeName.toLowerCase()&&x(t).trigger("blur")};x.widget("ui.draggable",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var e=this.options;return!(this.helper||e.disabled||0<x(t.target).closest(".ui-resizable-handle").length)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blurActiveElement(t),this._blockFrames(!0===e.iframeFix?"iframe":e.iframeFix),!0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=x(this);return x("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var e=x.ui.safeActiveElement(this.document[0]);x(t.target).closest(e).length||x.ui.safeBlur(e)},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),x.ui.ddmanager&&(x.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===x(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),x.ui.ddmanager&&!e.dropBehaviour&&x.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),x.ui.ddmanager&&x.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){e=this._uiHash();if(!1===this._trigger("drag",t,e))return this._mouseUp(new x.Event("mouseup",t)),!1;this.position=e.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",x.ui.ddmanager&&x.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e=this,i=!1;return x.ui.ddmanager&&!this.options.dropBehaviour&&(i=x.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||x.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?x(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",t)&&e._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),x.ui.ddmanager&&x.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),x.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new x.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!x(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var e=this.options,i=x.isFunction(e.helper),t=i?x(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return t.parents("body").length||t.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i&&t[0]===this.element[0]&&this._setPositionRelative(),t[0]===this.element[0]||/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),x.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==e&&x.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i,s=this.options,o=this.document[0];this.relativeContainer=null,s.containment?"window"!==s.containment?"document"!==s.containment?s.containment.constructor!==Array?("parent"===s.containment&&(s.containment=this.helper[0].parentNode),(i=(e=x(s.containment))[0])&&(t=/(scroll|auto)/.test(e.css("overflow")),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=e)):this.containment=s.containment:this.containment=[0,0,x(o).width()-this.helperProportions.width-this.margins.left,(x(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[x(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,x(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,x(window).scrollLeft()+x(window).width()-this.helperProportions.width-this.margins.left,x(window).scrollTop()+(x(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(t,e){e=e||this.position;var i="absolute"===t?1:-1,t=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:t?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:t?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s=this.options,o=this._isRootNode(this.scrollParent[0]),n=t.pageX,a=t.pageY;return o&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(i=this.relativeContainer?(i=this.relativeContainer.offset(),[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):this.containment,t.pageX-this.offset.click.left<i[0]&&(n=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(a=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(n=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(a=i[3]+this.offset.click.top)),s.grid&&(t=s.grid[1]?this.originalPageY+Math.round((a-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,a=!i||t-this.offset.click.top>=i[1]||t-this.offset.click.top>i[3]?t:t-this.offset.click.top>=i[1]?t-s.grid[1]:t+s.grid[1],t=s.grid[0]?this.originalPageX+Math.round((n-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,n=!i||t-this.offset.click.left>=i[0]||t-this.offset.click.left>i[2]?t:t-this.offset.click.left>=i[0]?t-s.grid[0]:t+s.grid[0]),"y"===s.axis&&(n=this.originalPageX),"x"===s.axis&&(a=this.originalPageY)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:o?0:this.offset.scroll.top),left:n-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:o?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,e,i){return i=i||this._uiHash(),x.ui.plugin.call(this,t,[e,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),x.Widget.prototype._trigger.call(this,t,e,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),x.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,i){var s=x.extend({},t,{item:i.element});i.sortables=[],x(i.options.connectToSortable).each(function(){var t=x(this).sortable("instance");t&&!t.options.disabled&&(i.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,s))})},stop:function(e,t,i){var s=x.extend({},t,{item:i.element});i.cancelHelperRemoval=!1,x.each(i.sortables,function(){var t=this;t.isOver?(t.isOver=0,i.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,s))})},drag:function(i,s,o){x.each(o.sortables,function(){var t=!1,e=this;e.positionAbs=o.positionAbs,e.helperProportions=o.helperProportions,e.offset.click=o.offset.click,e._intersectsWith(e.containerCache)&&(t=!0,x.each(o.sortables,function(){return this.positionAbs=o.positionAbs,this.helperProportions=o.helperProportions,this.offset.click=o.offset.click,this!==e&&this._intersectsWith(this.containerCache)&&x.contains(e.element[0],this.element[0])&&(t=!1),t})),t?(e.isOver||(e.isOver=1,o._parent=s.helper.parent(),e.currentItem=s.helper.appendTo(e.element).data("ui-sortable-item",!0),e.options._helper=e.options.helper,e.options.helper=function(){return s.helper[0]},i.target=e.currentItem[0],e._mouseCapture(i,!0),e._mouseStart(i,!0,!0),e.offset.click.top=o.offset.click.top,e.offset.click.left=o.offset.click.left,e.offset.parent.left-=o.offset.parent.left-e.offset.parent.left,e.offset.parent.top-=o.offset.parent.top-e.offset.parent.top,o._trigger("toSortable",i),o.dropped=e.element,x.each(o.sortables,function(){this.refreshPositions()}),o.currentItem=o.element,e.fromOutside=o),e.currentItem&&(e._mouseDrag(i),s.position=e.position)):e.isOver&&(e.isOver=0,e.cancelHelperRemoval=!0,e.options._revert=e.options.revert,e.options.revert=!1,e._trigger("out",i,e._uiHash(e)),e._mouseStop(i,!0),e.options.revert=e.options._revert,e.options.helper=e.options._helper,e.placeholder&&e.placeholder.remove(),s.helper.appendTo(o._parent),o._refreshOffsets(i),s.position=o._generatePosition(i,!0),o._trigger("fromSortable",i),o.dropped=!1,x.each(o.sortables,function(){this.refreshPositions()}))})}}),x.ui.plugin.add("draggable","cursor",{start:function(t,e,i){var s=x("body"),i=i.options;s.css("cursor")&&(i._cursor=s.css("cursor")),s.css("cursor",i.cursor)},stop:function(t,e,i){i=i.options;i._cursor&&x("body").css("cursor",i._cursor)}}),x.ui.plugin.add("draggable","opacity",{start:function(t,e,i){e=x(e.helper),i=i.options;e.css("opacity")&&(i._opacity=e.css("opacity")),e.css("opacity",i.opacity)},stop:function(t,e,i){i=i.options;i._opacity&&x(e.helper).css("opacity",i._opacity)}}),x.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,e,i){var s=i.options,o=!1,n=i.scrollParentNotHidden[0],a=i.document[0];n!==a&&"HTML"!==n.tagName?(s.axis&&"x"===s.axis||(i.overflowOffset.top+n.offsetHeight-t.pageY<s.scrollSensitivity?n.scrollTop=o=n.scrollTop+s.scrollSpeed:t.pageY-i.overflowOffset.top<s.scrollSensitivity&&(n.scrollTop=o=n.scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(i.overflowOffset.left+n.offsetWidth-t.pageX<s.scrollSensitivity?n.scrollLeft=o=n.scrollLeft+s.scrollSpeed:t.pageX-i.overflowOffset.left<s.scrollSensitivity&&(n.scrollLeft=o=n.scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(t.pageY-x(a).scrollTop()<s.scrollSensitivity?o=x(a).scrollTop(x(a).scrollTop()-s.scrollSpeed):x(window).height()-(t.pageY-x(a).scrollTop())<s.scrollSensitivity&&(o=x(a).scrollTop(x(a).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(t.pageX-x(a).scrollLeft()<s.scrollSensitivity?o=x(a).scrollLeft(x(a).scrollLeft()-s.scrollSpeed):x(window).width()-(t.pageX-x(a).scrollLeft())<s.scrollSensitivity&&(o=x(a).scrollLeft(x(a).scrollLeft()+s.scrollSpeed)))),!1!==o&&x.ui.ddmanager&&!s.dropBehaviour&&x.ui.ddmanager.prepareOffsets(i,t)}}),x.ui.plugin.add("draggable","snap",{start:function(t,e,i){var s=i.options;i.snapElements=[],x(s.snap.constructor!==String?s.snap.items||":data(ui-draggable)":s.snap).each(function(){var t=x(this),e=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e.top,left:e.left})})},drag:function(t,e,i){for(var s,o,n,a,l,h,r,c,p,u=i.options,d=u.snapTolerance,f=e.offset.left,g=f+i.helperProportions.width,m=e.offset.top,_=m+i.helperProportions.height,b=i.snapElements.length-1;0<=b;b--)h=(l=i.snapElements[b].left-i.margins.left)+i.snapElements[b].width,c=(r=i.snapElements[b].top-i.margins.top)+i.snapElements[b].height,g<l-d||h+d<f||_<r-d||c+d<m||!x.contains(i.snapElements[b].item.ownerDocument,i.snapElements[b].item)?(i.snapElements[b].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,x.extend(i._uiHash(),{snapItem:i.snapElements[b].item})),i.snapElements[b].snapping=!1):("inner"!==u.snapMode&&(s=Math.abs(r-_)<=d,o=Math.abs(c-m)<=d,n=Math.abs(l-g)<=d,a=Math.abs(h-f)<=d,s&&(e.position.top=i._convertPositionTo("relative",{top:r-i.helperProportions.height,left:0}).top),o&&(e.position.top=i._convertPositionTo("relative",{top:c,left:0}).top),n&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),a&&(e.position.left=i._convertPositionTo("relative",{top:0,left:h}).left)),p=s||o||n||a,"outer"!==u.snapMode&&(s=Math.abs(r-m)<=d,o=Math.abs(c-_)<=d,n=Math.abs(l-f)<=d,a=Math.abs(h-g)<=d,s&&(e.position.top=i._convertPositionTo("relative",{top:r,left:0}).top),o&&(e.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top),n&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),a&&(e.position.left=i._convertPositionTo("relative",{top:0,left:h-i.helperProportions.width}).left)),!i.snapElements[b].snapping&&(s||o||n||a||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,x.extend(i._uiHash(),{snapItem:i.snapElements[b].item})),i.snapElements[b].snapping=s||o||n||a||p)}}),x.ui.plugin.add("draggable","stack",{start:function(t,e,i){var s,i=i.options,i=x.makeArray(x(i.stack)).sort(function(t,e){return(parseInt(x(t).css("zIndex"),10)||0)-(parseInt(x(e).css("zIndex"),10)||0)});i.length&&(s=parseInt(x(i[0]).css("zIndex"),10)||0,x(i).each(function(t){x(this).css("zIndex",s+t)}),this.css("zIndex",s+i.length))}}),x.ui.plugin.add("draggable","zIndex",{start:function(t,e,i){e=x(e.helper),i=i.options;e.css("zIndex")&&(i._zIndex=e.css("zIndex")),e.css("zIndex",i.zIndex)},stop:function(t,e,i){i=i.options;i._zIndex&&x(e.helper).css("zIndex",i._zIndex)}});x.ui.draggable;x.widget("ui.resizable",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(t,e){if("hidden"===x(t).css("overflow"))return!1;var i=e&&"left"===e?"scrollLeft":"scrollTop",e=!1;return 0<t[i]||(t[i]=1,e=0<t[i],t[i]=0,e)},_create:function(){var t,e=this.options,i=this;this._addClass("ui-resizable"),x.extend(this,{_aspectRatio:!!e.aspectRatio,aspectRatio:e.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:e.helper||e.ghost||e.animate?e.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(x("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),e.autoHide&&x(this.element).on("mouseenter",function(){e.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())}).on("mouseleave",function(){e.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();function t(t){x(t).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()}var e;return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_setOption:function(t,e){this._super(t,e),"handles"===t&&(this._removeHandles(),this._setupHandles())},_setupHandles:function(){var t,e,i,s,o,n=this.options,a=this;if(this.handles=n.handles||(x(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=x(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},e=0;e<i.length;e++)s="ui-resizable-"+(t=x.trim(i[e])),o=x("<div>"),this._addClass(o,"ui-resizable-handle "+s),o.css({zIndex:n.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.append(o);this._renderAxis=function(t){var e,i,s;for(e in t=t||this.element,this.handles)this.handles[e].constructor===String?this.handles[e]=this.element.children(this.handles[e]).first().show():(this.handles[e].jquery||this.handles[e].nodeType)&&(this.handles[e]=x(this.handles[e]),this._on(this.handles[e],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=x(this.handles[e],this.element),s=/sw|ne|nw|se|n|s/.test(e)?i.outerHeight():i.outerWidth(),i=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[e])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){a.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=o&&o[1]?o[1]:"se")}),n.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(t){var e,i,s=!1;for(e in this.handles)(i=x(this.handles[e])[0])!==t.target&&!x.contains(i,t.target)||(s=!0);return!this.options.disabled&&s},_mouseStart:function(t){var e,i,s=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),s.containment&&(e+=x(s.containment).scrollLeft()||0,i+=x(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:e,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=x(".ui-resizable-"+this.axis).css("cursor"),x("body").css("cursor","auto"===s?this.axis+"-resize":s),this._addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var e=this.originalMousePosition,i=this.axis,s=t.pageX-e.left||0,e=t.pageY-e.top||0,i=this._change[i];return this._updatePrevProperties(),i&&(e=i.apply(this,[t,s,e]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(e=this._updateRatio(e,t)),e=this._respectSize(e,t),this._updateCache(e),this._propagate("resize",t),e=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),x.isEmptyObject(e)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges())),!1},_mouseStop:function(t){this.resizing=!1;var e,i,s,o=this.options,n=this;return this._helper&&(s=(e=(i=this._proportionallyResizeElements).length&&/textarea/i.test(i[0].nodeName))&&this._hasScroll(i[0],"left")?0:n.sizeDiff.height,i=e?0:n.sizeDiff.width,e={width:n.helper.width()-i,height:n.helper.height()-s},i=parseFloat(n.element.css("left"))+(n.position.left-n.originalPosition.left)||null,s=parseFloat(n.element.css("top"))+(n.position.top-n.originalPosition.top)||null,o.animate||this.element.css(x.extend(e,{top:s,left:i})),n.helper.height(n.size.height),n.helper.width(n.size.width),this._helper&&!o.animate&&this._proportionallyResize()),x("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,s=this.options,o={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:1/0,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:1/0};(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,s=o.maxHeight*this.aspectRatio,t=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),i>o.minHeight&&(o.minHeight=i),s<o.maxWidth&&(o.maxWidth=s),t<o.maxHeight&&(o.maxHeight=t)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,o=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,n=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,l=this.originalPosition.left+this.originalSize.width,h=this.originalPosition.top+this.originalSize.height,r=/sw|nw|w/.test(i),i=/nw|ne|n/.test(i);return n&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),o&&(t.height=e.maxHeight),n&&r&&(t.left=l-e.minWidth),s&&r&&(t.left=l-e.maxWidth),a&&i&&(t.top=h-e.minHeight),o&&i&&(t.top=h-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],o=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)i[e]=parseFloat(s[e])||0,i[e]+=parseFloat(o[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;e<this._proportionallyResizeElements.length;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,e=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||x("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize;return{top:this.originalPosition.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return x.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return x.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return x.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return x.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},_propagate:function(t,e){x.ui.plugin.call(this,t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),x.ui.plugin.add("resizable","animate",{stop:function(e){var i=x(this).resizable("instance"),t=i.options,s=i._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),n=o&&i._hasScroll(s[0],"left")?0:i.sizeDiff.height,a=o?0:i.sizeDiff.width,o={width:i.size.width-a,height:i.size.height-n},a=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,n=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(x.extend(o,n&&a?{top:n,left:a}:{}),{duration:t.animateDuration,easing:t.animateEasing,step:function(){var t={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};s&&s.length&&x(s[0]).css({width:t.width,height:t.height}),i._updateCache(t),i._propagate("resize",e)}})}}),x.ui.plugin.add("resizable","containment",{start:function(){var i,s,o=x(this).resizable("instance"),t=o.options,e=o.element,n=t.containment,a=n instanceof x?n.get(0):/parent/.test(n)?e.parent().get(0):n;a&&(o.containerElement=x(a),/document/.test(n)||n===document?(o.containerOffset={left:0,top:0},o.containerPosition={left:0,top:0},o.parentData={element:x(document),left:0,top:0,width:x(document).width(),height:x(document).height()||document.body.parentNode.scrollHeight}):(i=x(a),s=[],x(["Top","Right","Left","Bottom"]).each(function(t,e){s[t]=o._num(i.css("padding"+e))}),o.containerOffset=i.offset(),o.containerPosition=i.position(),o.containerSize={height:i.innerHeight()-s[3],width:i.innerWidth()-s[1]},t=o.containerOffset,e=o.containerSize.height,n=o.containerSize.width,n=o._hasScroll(a,"left")?a.scrollWidth:n,e=o._hasScroll(a)?a.scrollHeight:e,o.parentData={element:a,left:t.left,top:t.top,width:n,height:e}))},resize:function(t){var e=x(this).resizable("instance"),i=e.options,s=e.containerOffset,o=e.position,n=e._aspectRatio||t.shiftKey,a={top:0,left:0},l=e.containerElement,t=!0;l[0]!==document&&/static/.test(l.css("position"))&&(a=s),o.left<(e._helper?s.left:0)&&(e.size.width=e.size.width+(e._helper?e.position.left-s.left:e.position.left-a.left),n&&(e.size.height=e.size.width/e.aspectRatio,t=!1),e.position.left=i.helper?s.left:0),o.top<(e._helper?s.top:0)&&(e.size.height=e.size.height+(e._helper?e.position.top-s.top:e.position.top),n&&(e.size.width=e.size.height*e.aspectRatio,t=!1),e.position.top=e._helper?s.top:0),i=e.containerElement.get(0)===e.element.parent().get(0),o=/relative|absolute/.test(e.containerElement.css("position")),i&&o?(e.offset.left=e.parentData.left+e.position.left,e.offset.top=e.parentData.top+e.position.top):(e.offset.left=e.element.offset().left,e.offset.top=e.element.offset().top),o=Math.abs(e.sizeDiff.width+(e._helper?e.offset.left-a.left:e.offset.left-s.left)),s=Math.abs(e.sizeDiff.height+(e._helper?e.offset.top-a.top:e.offset.top-s.top)),o+e.size.width>=e.parentData.width&&(e.size.width=e.parentData.width-o,n&&(e.size.height=e.size.width/e.aspectRatio,t=!1)),s+e.size.height>=e.parentData.height&&(e.size.height=e.parentData.height-s,n&&(e.size.width=e.size.height*e.aspectRatio,t=!1)),t||(e.position.left=e.prevPosition.left,e.position.top=e.prevPosition.top,e.size.width=e.prevSize.width,e.size.height=e.prevSize.height)},stop:function(){var t=x(this).resizable("instance"),e=t.options,i=t.containerOffset,s=t.containerPosition,o=t.containerElement,n=x(t.helper),a=n.offset(),l=n.outerWidth()-t.sizeDiff.width,n=n.outerHeight()-t.sizeDiff.height;t._helper&&!e.animate&&/relative/.test(o.css("position"))&&x(this).css({left:a.left-s.left-i.left,width:l,height:n}),t._helper&&!e.animate&&/static/.test(o.css("position"))&&x(this).css({left:a.left-s.left-i.left,width:l,height:n})}}),x.ui.plugin.add("resizable","alsoResize",{start:function(){var t=x(this).resizable("instance").options;x(t.alsoResize).each(function(){var t=x(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.width()),height:parseFloat(t.height()),left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))})})},resize:function(t,i){var e=x(this).resizable("instance"),s=e.options,o=e.originalSize,n=e.originalPosition,a={height:e.size.height-o.height||0,width:e.size.width-o.width||0,top:e.position.top-n.top||0,left:e.position.left-n.left||0};x(s.alsoResize).each(function(){var t=x(this),s=x(this).data("ui-resizable-alsoresize"),o={},e=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];x.each(e,function(t,e){var i=(s[e]||0)+(a[e]||0);i&&0<=i&&(o[e]=i||null)}),t.css(o)})},stop:function(){x(this).removeData("ui-resizable-alsoresize")}}),x.ui.plugin.add("resizable","ghost",{start:function(){var t=x(this).resizable("instance"),e=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!1!==x.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},resize:function(){var t=x(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=x(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),x.ui.plugin.add("resizable","grid",{resize:function(){var t,e=x(this).resizable("instance"),i=e.options,s=e.size,o=e.originalSize,n=e.originalPosition,a=e.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,h=l[0]||1,r=l[1]||1,c=Math.round((s.width-o.width)/h)*h,p=Math.round((s.height-o.height)/r)*r,u=o.width+c,d=o.height+p,f=i.maxWidth&&i.maxWidth<u,g=i.maxHeight&&i.maxHeight<d,m=i.minWidth&&i.minWidth>u,s=i.minHeight&&i.minHeight>d;i.grid=l,m&&(u+=h),s&&(d+=r),f&&(u-=h),g&&(d-=r),/^(se|s|e)$/.test(a)?(e.size.width=u,e.size.height=d):/^(ne)$/.test(a)?(e.size.width=u,e.size.height=d,e.position.top=n.top-p):/^(sw)$/.test(a)?(e.size.width=u,e.size.height=d,e.position.left=n.left-c):((d-r<=0||u-h<=0)&&(t=e._getPaddingPlusBorderDimensions(this)),0<d-r?(e.size.height=d,e.position.top=n.top-p):(d=r-t.height,e.size.height=d,e.position.top=n.top+o.height-d),0<u-h?(e.size.width=u,e.position.left=n.left-c):(u=h-t.width,e.size.width=u,e.position.left=n.left+o.width-u))}});x.ui.resizable;var d=/ui-corner-([a-z]){2,6}/g;x.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var n=this,a=[];x.each(this.options.items,function(s,t){var e,o={};if(t)return"controlgroupLabel"===s?((e=n.element.find(t)).each(function(){var t=x(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),n._addClass(e,null,"ui-widget ui-widget-content ui-state-default"),void(a=a.concat(e.get()))):void(x.fn[s]&&(o=n["_"+s+"Options"]?n["_"+s+"Options"]("middle"):{classes:{}},n.element.find(t).each(function(){var t=x(this),e=t[s]("instance"),i=x.widget.extend({},o);"button"===s&&t.parent(".ui-spinner").length||((e=e||t[s]()[s]("instance"))&&(i.classes=n._resolveClassesValues(i.classes,e)),t[s](i),i=t[s]("widget"),x.data(i[0],"ui-controlgroup-data",e||t[s]("instance")),a.push(i[0]))})))}),this.childWidgets=x(x.unique(a)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var t=x(this).data("ui-controlgroup-data");t&&t[e]&&t[e]()})},_updateCornerClass:function(t,e){e=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(t,null,e)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,s={classes:{}};return s.classes[e]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],s},_spinnerOptions:function(t){t=this._buildSimpleOptions(t,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:e&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(i,s){var o={};return x.each(i,function(t){var e=s.options.classes[t]||"",e=x.trim(e.replace(d,""));o[t]=(e+" "+i[t]).replace(/\s+/g," ")}),o},_setOption:function(t,e){"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"!==t?this.refresh():this._callChildMethod(e?"disable":"enable")},refresh:function(){var o,n=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),o=this.childWidgets,this.options.onlyVisible&&(o=o.filter(":visible")),o.length&&(x.each(["first","last"],function(t,e){var i,s=o[e]().data("ui-controlgroup-data");s&&n["_"+s.widgetName+"Options"]?((i=n["_"+s.widgetName+"Options"](1===o.length?"only":e)).classes=n._resolveClassesValues(i.classes,s),s.element[s.widgetName](i)):n._updateCornerClass(o[e](),e)}),this._callChildMethod("refresh"))}});x.widget("ui.checkboxradio",[x.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,e=this,i=this._super()||{};return this._readType(),t=this.element.labels(),this.label=x(t[t.length-1]),this.label.length||x.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){e.originalLabel+=3===this.nodeType?x(this).text():this.outerHTML}),this.originalLabel&&(i.label=this.originalLabel),null!=(t=this.element[0].disabled)&&(i.disabled=t),i},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||x.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,e="input[name='"+x.ui.escapeSelector(t)+"']";return t?(this.form.length?x(this.form[0].elements).filter(e):x(e).filter(function(){return 0===x(this).form().length})).not(this.element):x([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each(function(){var t=x(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){if("label"!==t||e){if(this._super(t,e),"disabled"===t)return this._toggleClass(this.label,null,"ui-state-disabled",e),void(this.element[0].disabled=e);this.refresh()}},_updateIcon:function(t){var e="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=x("<span>"),this.iconSpace=x("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(e+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):e+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",e),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]);var f;x.ui.checkboxradio;x.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),null!=(t=this.element[0].disabled)&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===x.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,e){var i="iconPosition"!==t,s=i?this.options.iconPosition:e,t="top"===s||"bottom"===s;this.icon?i&&this._removeClass(this.icon,null,this.options.icon):(this.icon=x("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),i&&this._addClass(this.icon,null,e),this._attachIcon(s),t?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=x("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(s))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=(void 0===t.showLabel?this.options:t).showLabel,i=(void 0===t.icon?this.options:t).icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),(this.element[0].disabled=e)&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),!1!==x.uiBackCompat&&(x.widget("ui.button",x.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){"text"!==t?("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",e)}}),x.fn.button=(f=x.fn.button,function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?f.apply(this,arguments):(x.ui.checkboxradio||x.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}),x.fn.buttonset=function(){return x.ui.controlgroup||x.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))});x.ui.button;x.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var e=x(this).css(t).offset().top;e<0&&x(this).css("top",t.top-e)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&x.fn.draggable&&this._makeDraggable(),this.options.resizable&&x.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?x(t):this.document.find(t||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:x.noop,enable:x.noop,close:function(t){var e=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||x.ui.safeBlur(x.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){e._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!1,s=this.uiDialog.siblings(".ui-front:visible").map(function(){return+x(this).css("z-index")}).get(),s=Math.max.apply(null,s);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),i=!0),i&&!e&&this._trigger("focus",t),i},open:function(){var t=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=x(x.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;(t=t||this.element.find("[autofocus]")).length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(t){function e(){var t=x.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===t||x.contains(this.uiDialog[0],t)||this._focusTabbable()}t.preventDefault(),e.call(this),this._delay(e)},_createWrapper:function(){this.uiDialog=x("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===x.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);var e,i,s;t.keyCode!==x.ui.keyCode.TAB||t.isDefaultPrevented()||(e=this.uiDialog.find(":tabbable"),i=e.filter(":first"),s=e.filter(":last"),t.target!==s[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){s.trigger("focus")}),t.preventDefault()):(this._delay(function(){i.trigger("focus")}),t.preventDefault()))},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=x("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){x(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=x("<button type='button'></button>").button({label:x("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),t=x("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=x("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=x("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var s=this,t=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),x.isEmptyObject(t)||x.isArray(t)&&!t.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(x.each(t,function(t,e){var i;e=x.isFunction(e)?{click:e,text:t}:e,e=x.extend({type:"button"},e),i=e.click,t={icon:e.icon,iconPosition:e.iconPosition,showLabel:e.showLabel,icons:e.icons,text:e.text},delete e.click,delete e.icon,delete e.iconPosition,delete e.showLabel,delete e.icons,"boolean"==typeof e.text&&delete e.text,x("<button></button>",e).button(t).appendTo(s.uiButtonSet).on("click",function(){i.apply(s.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var o=this,n=this.options;function a(t){return{position:t.position,offset:t.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(t,e){o._addClass(x(this),"ui-dialog-dragging"),o._blockFrames(),o._trigger("dragStart",t,a(e))},drag:function(t,e){o._trigger("drag",t,a(e))},stop:function(t,e){var i=e.offset.left-o.document.scrollLeft(),s=e.offset.top-o.document.scrollTop();n.position={my:"left top",at:"left"+(0<=i?"+":"")+i+" top"+(0<=s?"+":"")+s,of:o.window},o._removeClass(x(this),"ui-dialog-dragging"),o._unblockFrames(),o._trigger("dragStop",t,a(e))}})},_makeResizable:function(){var o=this,n=this.options,t=n.resizable,e=this.uiDialog.css("position"),t="string"==typeof t?t:"n,e,s,w,se,sw,ne,nw";function a(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:t,start:function(t,e){o._addClass(x(this),"ui-dialog-resizing"),o._blockFrames(),o._trigger("resizeStart",t,a(e))},resize:function(t,e){o._trigger("resize",t,a(e))},stop:function(t,e){var i=o.uiDialog.offset(),s=i.left-o.document.scrollLeft(),i=i.top-o.document.scrollTop();n.height=o.uiDialog.height(),n.width=o.uiDialog.width(),n.position={my:"left top",at:"left"+(0<=s?"+":"")+s+" top"+(0<=i?"+":"")+i,of:o.window},o._removeClass(x(this),"ui-dialog-resizing"),o._unblockFrames(),o._trigger("resizeStop",t,a(e))}}).css("position",e)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=x(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),e=x.inArray(this,t);-1!==e&&t.splice(e,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,o={};x.each(t,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(o[t]=e)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(t,e){var i,s=this.uiDialog;"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:x("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&((i=s.is(":data(ui-draggable)"))&&!e&&s.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((i=s.is(":data(ui-resizable)"))&&!e&&s.resizable("destroy"),i&&"string"==typeof e&&s.resizable("option","handles",e),i||!1===e||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=x(this);return x("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!x(t.target).closest(".ui-dialog").length||!!x(t.target).closest(".ui-datepicker").length},_createOverlay:function(){var e;this.options.modal&&(e=!0,this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=x("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1))},_destroyOverlay:function(){var t;this.options.modal&&this.overlay&&((t=this.document.data("ui-dialog-overlays")-1)?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null)}}),!1!==x.uiBackCompat&&x.widget("ui.dialog",x.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}});x.ui.dialog});
(function($) {

    window.JCOM = window.JCOM || {};
    window.JCOM.PrimaryNavigation = function() {

        const SELECTOR_LEVEL_TWO_MENU = '.level-two-menu';

        let elements = {
            document : $(document),
            navigationComponent: $('.navigation-menu')
        };

        let isFocusReset = false;

        // Borrowed from JWEB to reduce dependencies
        let getTarget = function(event) {
            return event.target || event.srcElement;
        };

        // Borrowed from JWEB to reduce dependencies
        let initNavigationEvents = function () {
            // Activate or reset the primary navigation links
            elements.document.on('mouseup', '.nav-primary .level-two-menu, .nav-primary>li>a', function(event) {
                let target = getTarget(event);
                let li = $(target).closest('li');

                if (isFocusReset){
                    isFocusReset = false;
                    li.addClass('focused');
                } else if (li.hasClass('page-link')) {
                    li.addClass('focused');
                } else {
                    if (li.hasClass('expanded') && li.hasClass('focused') && event.type == 'mouseup') {
                        // close a menu if activated a second time
                        $('.expanded').removeClass('expanded').find(SELECTOR_LEVEL_TWO_MENU).removeAttr(window.JCOM.Utility.Constants.Attribute.ariaExpanded);
                    } else {
                        // open a menu
                        $('.focused').removeClass('focused');
                        $('.nav-primary .expanded').removeClass('expanded').removeClass('focused').find(SELECTOR_LEVEL_TWO_MENU).removeAttr(window.JCOM.Utility.Constants.Attribute.ariaExpanded);
                        li.addClass('focused').addClass('expanded').find(SELECTOR_LEVEL_TWO_MENU).attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded,'true');
                    }
                }
            });
            elements.document.on('focus', 'body:not(".nav-open") .nav-primary .level-two-menu', function(event) {
                let target = getTarget(event);
                let li = $(target).closest('li');
                if (isFocusReset){
                    isFocusReset = false;
                    li.addClass('focused');
                } else {
                    $('.focused').removeClass('focused');
                    $('.expanded').removeClass('expanded').find(SELECTOR_LEVEL_TWO_MENU).removeAttr(window.JCOM.Utility.Constants.Attribute.ariaExpanded);
                    li.addClass('focused').addClass('expanded').find(SELECTOR_LEVEL_TWO_MENU).attr(window.JCOM.Utility.Constants.Attribute.ariaExpanded,'true');
                    isFocusReset = true;
                }
            });
            // Deactivate the primary navigation when mouse events are detected elsewhere
            elements.document.on('mousedown', function(event) {
                let target = getTarget(event);
                if ($(target).closest('#primary-navigation, ul.aside, .nav-primary>li>a, .focused').length === 0) {
                    $('.nav-primary .focused').removeClass('focused');
                    $('.nav-primary .expanded').removeClass('expanded').find(SELECTOR_LEVEL_TWO_MENU).removeAttr(window.JCOM.Utility.Constants.Attribute.ariaExpanded);
                }
            });
            // Reset current index of the secondary menu when focus changes
            elements.document.on('focus', '.expanded ul li a', function(event) {
                let target = getTarget(event);
                $('.expanded ul li.focused').removeClass('focused');
                $(target).closest('li').addClass('focused');
            });
            // Reset current index of the secondary menu when focus changes
            elements.document.on('blur', '.expanded ul li a', function(event) {
                let target = getTarget(event);
                $(target).closest('li').removeClass('focused');
            });

            $('.navigation-menu .close').on('click keyup ', function (e) {
                if(e.type == "keyup") {
                    switch (e.key) {
                      case "Enter":
                      case "Spacebar":
                      case " ":// spacebar
                          hideResponsiveNav();
                          e.preventDefault();
                          e.stopPropagation();
                          break;
                    }
                } else {
                    hideResponsiveNav();
                    $(this).closest('li').removeClass('expanded').removeClass('focused').find(SELECTOR_LEVEL_TWO_MENU).removeAttr(window.JCOM.Utility.Constants.Attribute.ariaExpanded);
                }
            });
        };

        let init = function () {
            JCOM.Navigation = {};
            if($('.nav-primary').length > 0) {
                initNavigationEvents();
            }
        };

        return {
            init : init
        }
    }();

})($j);
(function ($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.externalIframe = function () {
        const SELECTOR_RILA_TOOL = '.rila-react-tool';
        let rilaToolLoaded = false;
        let triggerRilaToolError = function () {
            if (document.documentMode == undefined) { //checking if the browser is IE. If the browser is IE the error message will not be triggered
                $(SELECTOR_RILA_TOOL).addClass('hidden');
                $('#tool-tab .persona-scenario-wrapper').addClass('hidden');
                $('.step-progress-bar .tool-error-message').removeClass('hidden');
            }
        }
        let checkRilaToolLoad = function () {
            if (!rilaToolLoaded) {
                triggerRilaToolError();
            }
        }
        let removeRilaToolError = function () {
            $('.step-progress-bar .tool-error-message').addClass('hidden');
            $('#tool-tab .persona-scenario-wrapper').removeClass('hidden');
            $(SELECTOR_RILA_TOOL).removeClass('hidden');
        }

        let getLinkHrefUUID = function (href) {
            let uuidPos = href.lastIndexOf('uuid=');
            let breakPos = href.indexOf('&', uuidPos + 5);

            if (breakPos > 0) {
                return href.slice(uuidPos + 5, breakPos);
            } else {
                return href.slice(uuidPos + 5);
            }
        }

        let updateReportLinkHrefUUID = function (linkHref) {

            if (!linkHref) {
                return null;
            }

            let uuidPos = linkHref.lastIndexOf('uuid=');
            let uuid = randomString(12);

            if (uuidPos > 0) {
                let existingUuid = linkHref.substr(uuidPos + 5, 12); //number of characters 'uuid='(5) + uuid length (12)
                linkHref = linkHref.replace(existingUuid, encodeURI(uuid));
            } else {
                let separator = (linkHref.indexOf("?") === -1) ? "?" : "&";
                let newParam = separator + "uuid=" + encodeURI(uuid);
                linkHref += newParam;
            }

            return linkHref;
        }

        let randomString = function (length) {
            let intArr = new Uint8Array((length || 32) / 2);
            let crypto = window.crypto || window.msCrypto;

            crypto.getRandomValues(intArr);

            let retArr = [];

            for (let i = 0; i < intArr.length; i++) {
                retArr[i] = '' + dec2hex(intArr[i]);
            }

            return retArr.join('');
        }

        let dec2hex = function (dec) {
            return ('0' + dec.toString(16)).substr(-2);
        }

        // load and toggle visibility on iframe
        const toggleIframeDisplay = function (iframeToShow, iframeToHide) {
            // if iframe not currently loaded, load iframe
            if (undefined === iframeToShow.attr('src')) {
                iframeToShow.attr('src', iframeToShow.attr('data-src'))
            }

            // swap visibility of iframes
            iframeToShow.removeClass('hidden');
            iframeToHide.addClass('hidden');

            // swap visibility of related content
            $('.' + iframeToShow.attr('id')).removeClass('hidden');
            $('.' + iframeToHide.attr('id')).addClass('hidden');
        }

        // handle version toggle messages from iframe
        const handleRilaVersionMessage = function (data) {
            if (undefined === data.rilaVersion) {
                return;
            }

            const rila2 = $('#rila-tool');
            const rila1 = $('#rila-tool-v1');

            switch (data.rilaVersion) {
                case 'v1':
                    toggleIframeDisplay(rila1, rila2);
                    break;
                case 'v2':
                    toggleIframeDisplay(rila2, rila1);
                    break;
            }
        }

        let setJacksonRILAToolSize = function () {
            let iframe = $('#rila-tool, #rila-tool-v1');
            let toolTab = $("#tool");
            let counter = 0;
            let toolErrorTimeout = parseInt($('.tool-error-message').data('timeout'));

            iframe.attr('scrolling', 'auto');
            if (isNaN(toolErrorTimeout)) {
                toolErrorTimeout = 10000; /*Defaulting to 10 second timeout incase timeout is not authored */
            }
            setTimeout(checkRilaToolLoad, toolErrorTimeout);
            /* Listen for RILA postback messages when tool content changes & iframe needs resizing */
            $(window).on('message', function (e) {

                /* Only accept postback messages from jackson sub-domains */
                if (e.originalEvent.origin.match(/.+\.jackson\.com$/) !== null) {

                    if (e.originalEvent.data === 'scrollToTop') {
                        const toolContainer = document.getElementsByClassName("rila-react-tool");
                        let toolTop = toolContainer.length && toolContainer[0].offsetTop;
                        if (toolTop && window.scrollY > toolTop) {
                            $([document.documentElement, document.body]).animate({ scrollTop: toolTop }, 250);
                        }
                        return;
                    }

                    rilaToolLoaded = true;
                    if (e.originalEvent.data.message != undefined) {
                        if (e.originalEvent.data.message.data === 'client-report') {

                            let reportDataObj = {
                                downMarketData: e.originalEvent.data.message.downMarketData,
                                upMarketData: e.originalEvent.data.message.upMarketData,
                                recentMarketData: e.originalEvent.data.message.recentMarketData,
                                investmentAmount: e.originalEvent.data.message.investmentAmount,
                                productSelection: e.originalEvent.data.message.selectedProduct
                            }

                            let basereportHref = $('.rila-react-tool .stored-content #report-href').data('value');
                            let reportHref = updateReportLinkHrefUUID(basereportHref);
                            let uuid = getLinkHrefUUID(reportHref);
                            window.localStorage.setItem('reportValues' + uuid, JSON.stringify(reportDataObj));

                            window.open(reportHref, '_blank');

                            return;
                        }
                    }

                    if(e.originalEvent.data.height) {
                        iframe.not('.hidden').css('height', e.originalEvent.data.height);
                    }

                    handleRilaVersionMessage(e.originalEvent.data);

                    counter++;

                    /* On first load, scroll up so that entire top of tool is in view */
                    if (toolTab.hasClass("active") && counter === 1) {
                        window.JCOM.Utility.scrollToElement(toolTab);
                    }
                    if ($(SELECTOR_RILA_TOOL).hasClass('hidden')) {
                        removeRilaToolError();
                    }
                }
            });
        }

        const setTaxDeferralCalculatorToolSize = function () {
            const iframe = $('#tax-deferral-calculator-tool');

            /* Listen for postback messages when tool content changes & iframe needs resizing */
            $(window).on('message', function (e) {

                /* Only accept postback messages from trusted finmason public domains */
                if (null === e.originalEvent.origin.match(/.+\.finmason\.com/)) {
                    return;
                }

                /* height must be sent to set new height */
                if (null === e.originalEvent.data ||
                    undefined === e.originalEvent.data.height
                ) {
                    return;
                }

                const newHeight = e.originalEvent.data.height;
                iframe.css('height', newHeight);
            });
        }

        let adjustSocialSecurityToolPageScroll = function () {
            if (document.location.hash.length < 1) {
                let selector = 'button:not([id*="sessionManagerForm:noButton"]):not([id*="sessionManagerForm:yesButton"]), [href]:not(link), input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])';
                let firstFocusable = document.querySelectorAll(selector)[0];
                window.JCOM.Utility.scrollToElement(firstFocusable);
                //move focus back to the first focusable element
                firstFocusable.focus();
            } else {
                window.JCOM.Utility.scrollToElement($(document.location.hash));
                //move focus to the id in the url hash
                $(document.location.hash).focus();
            }
        }

        let init = function () {
            const rilaTool = $('#rila-tool');
            const socialSecurityTool = $('#social-security-calculator');
            const taxDeferralCalculatorTool = $('#tax-deferral-calculator-tool');

            if (rilaTool.length) {
                if (window.ContextHub && ContextHub.SegmentEngine) {
                    ContextHubJQ(function() {
                        ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                            setJacksonRILAToolSize();
                        });
                    });
                }
                setJacksonRILAToolSize();
            }

            if (socialSecurityTool.length !== 0) {
                socialSecurityTool.on("load", function () {
                    /* Wait until iframe content is loaded before showing to prevent browser from abruptly scrolling down */
                    adjustSocialSecurityToolPageScroll();
                });
            }

            if (taxDeferralCalculatorTool.length !== 0) {
                setTaxDeferralCalculatorToolSize();
            }
        };

        return {
            init: init
        }
    }();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.animations = function() {

        var removeAnimation = function (event) {
            $(event.target).removeClass('animate');
            event.target.removeEventListener("animationend", removeAnimation);
        }

        var addAnimationEventListener = function (nodeList) {
            var i;

            for (i = 0; i < nodeList.length; ++i) {
                nodeList[i].addEventListener("animationend", removeAnimation);
            }
        }

        var setupRilaAnimations = function() {
            var answers = '#assessment-tab .questionnaire .sortable .answer';
            var questionText = '#assessment-tab .questionnaire .question-text';
            var protectText = '#overview-tab .layout-container .header';

            if (window.sessionStorage.getItem('animated') === null) {
                $(answers).addClass("animate");
                $(questionText).addClass("animate");
                $(protectText).addClass("animate");
                window.sessionStorage.setItem('animated' ,1);
            }

            addAnimationEventListener(document.querySelectorAll(answers));
            addAnimationEventListener(document.querySelectorAll(questionText));
            addAnimationEventListener(document.querySelectorAll(protectText));
        }

        // End of Intersection Observer code for the Rila Overview Promo Cards

        var init = function () {
			var rilaTool = $('#rila-tool');
			if (rilaTool.length){
                setupRilaAnimations();
            }
        };

        return {
            init : init
        }
    }();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.RadioRender = function() {

        // page load init
        var init = function () {
            var buttons = $('.radio-render input');
            var defaultButton = $('.radio-render input.default');

            var activateTab = function() {
                var radioContents = $('.radio-content-wrappper div[id*="-tab"]');
                var selectedRadioIndex = buttons.index(this);

                radioContents.addClass('hidden');
                $(radioContents[selectedRadioIndex]).removeClass('hidden');
            };
            
            buttons.on('click', activateTab);

            window.onload = function(){
                if (defaultButton.length == 1) {
                    defaultButton.click();
                }
                else {
                    $(buttons[0]).click();
                }
            };
        };

        return {
            init : init
        }
    }();
})($j);
(function($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.Table = function() {

        var attachTableScrollWrapper = function () {
            var tables = $('table:not(:only-child)');
            tables.wrap('<div class="table-scroll__wrapper" />');
        };

        var init = function () {
            attachTableScrollWrapper();
        };

        return {
            init : init
        };

    }();
})($j);

(function($) {

    window.JCOM.PermissionWapper = function() {

        var adjustComponentClasses = function () {
            var fullWidthContainerClass = "permission-wrapper__content--full-width";
            // move class up to allow width function to work
            $('.' + fullWidthContainerClass).parent().addClass(fullWidthContainerClass);
        };

        var init = function () {
            if (window.ContextHub && ContextHub.SegmentEngine) {
                ContextHubJQ(function() {
                    ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                        adjustComponentClasses();
                    });
                });
        	}
            adjustComponentClasses();
        };

        return {
            init : init
        }
    }();
})($j);

(function($) {
    window.JCOM.BackgroundContainer = function() {
        var setMediaBreakpoints = function (e) {
            $('[data-media-query]').each(function(){
                let mediaQuery;
                let element = $(this);
                let query = element.data('media-query');
                let parent = element.parent();
                let displayToggle = function(e) {
                    if(e.matches === true) {
                        parent.removeClass('hidden');
                    } else {
                        parent.addClass('hidden');
                    }
                };

                mediaQuery = window.matchMedia(query);
                mediaQuery.addEventListener('change', displayToggle);
                displayToggle(mediaQuery);
            });
        };

        var init = function () {
            if(typeof authorRunMode === 'undefined' || !authorRunMode || (typeof wcmmodeDisabled !== "undefined" && wcmmodeDisabled === true)) {
                setMediaBreakpoints();
            }
        };

        return {
            init : init
        }
    }();
})($j);
(function ($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.WholesalerSearch = function () {
        const SELECTOR_WHOLESALER_SEARCH_ZIP_CODE = '#wholesaler-search-zip-code';
        const SELECTOR_FORM_TEXT_FIELD = '.cmp-form-text';
        const SELECTOR_FORM_FIELD_ERROR = ".field-status .error";
        const SELECTOR_RESULTS_NOT_FOUND = ".results-not-found";
        let key = {
            enter: 'Enter',
            space: ' '
        };

        let searchForWholesaler = function (zipCode) {
            resetWholesalerCard();
            if (zipCode.length == 0) {
                $(".field-status .error span").text('Please enter a Zip Code');
                $(SELECTOR_FORM_TEXT_FIELD).addClass('invalid');
                $(SELECTOR_FORM_FIELD_ERROR).addClass('active');
                return;
            } else if (zipCode.length !== 5) {
                $(".field-status .error span").text('Please enter 5 digits');
                $(SELECTOR_FORM_TEXT_FIELD).addClass('invalid');
                $(SELECTOR_FORM_FIELD_ERROR).addClass('active');
                return;
            } else {
                $(".results-not-found__zip").text(zipCode);
                $(SELECTOR_FORM_TEXT_FIELD).removeClass('invalid');
                $(SELECTOR_FORM_FIELD_ERROR).removeClass('active');
            }

            $.ajax({
                type: 'GET',
                cache: false,
                url: '/content/services/wholesalerServlet.html?zipCode=' + zipCode,
                success: function (msg) {
                    processWholesalerResponse(msg);
                },
                error: function (msg) {
                    processWholesalerErrorResponse(msg);
                }
            });
        }

        let resetWholesalerCard = function () {
            $(SELECTOR_RESULTS_NOT_FOUND).addClass('hidden');
            $(".wholesaler-search .wholesaler-card").addClass('hidden');
            $(".wholesaler-search .wholesaler-card .card-contact-phone").addClass('hidden');
            $(".wholesaler-search .wholesaler-card .card-contact-email").addClass('hidden');
        }

        let processWholesalerResponse = function (msg) {
            resetWholesalerCard();
            if (msg.status === 200) {
                if (msg.wholesaler) {
                    let resultsFound = false;
                    for (let key in msg.wholesaler) {
                        if (msg.wholesaler[key] !== null) {
                            resultsFound = true;
                        }
                    }
                    if (resultsFound) {
                        let wholesaler = msg.wholesaler;

                        let iwPhone = wholesaler.internalWSPhoneNumber;
                        let iwEmail = wholesaler.internalWSemailAddress;
                        let iwFirstName = wholesaler.internalWSFirstName;
                        let iwLastName = wholesaler.internalWSLastName;
                        let iwCard = $(".wholesaler-search .wholesaler-card.internal");
                        populateWholeSalerDetails(iwCard, iwPhone, iwEmail, iwFirstName, iwLastName);

                        let ewPhone = wholesaler.externalWSPhoneNumber;
                        let ewEmail = wholesaler.externalWSemailAddress;
                        let ewFirstName = wholesaler.externalWSFirstName;
                        let ewLastName = wholesaler.externalWSLastName;
                        let ewCard = $(".wholesaler-search .wholesaler-card.external");
                        populateWholeSalerDetails(ewCard, ewPhone, ewEmail, ewFirstName, ewLastName);
                    } else {
                        $(".results-not-found__message").html('<p>No results found for Zip Code ' + $(SELECTOR_WHOLESALER_SEARCH_ZIP_CODE).val() + '.</p><p>Call (800) 777-7900 to contact a representative on our Sales Desk.</p>');
                        $(SELECTOR_RESULTS_NOT_FOUND).removeClass('hidden');
                    }
                }
            }
        }

        let processWholesalerErrorResponse = function (msg) {
            $(".results-not-found__message").text('The request could not be completed at this time. Please try again later.');
            $(SELECTOR_RESULTS_NOT_FOUND).removeClass('hidden');
        }

        let populateWholeSalerDetails = function (wholesalerCard, phone, email, firstName, lastName) {
            if (firstName != null && lastName != null && firstName != '' && lastName != '') {
                wholesalerCard.find(".wholesaler-name").text((firstName + ' ' + lastName).replace(/\([^()]*\)/g, ''));
                if (phone != null && phone != '') {
                    let formattedPhone = formatPhone(phone);
                    wholesalerCard.find(".phone-number").text(formattedPhone);
                    wholesalerCard.find(".phone-number").attr("href", "tel:" + formattedPhone);
                    wholesalerCard.find(".card-contact-phone").removeClass('hidden');
                }
                if (email != null && email != '') {
                    wholesalerCard.find(".email").text(email);
                    wholesalerCard.find(".email").attr("href", "mailto:" + email);
                    wholesalerCard.find(".card-contact-email").removeClass('hidden');
                }
                wholesalerCard.removeClass('hidden');
            }
        }

        let formatPhone = function (phoneNumber) {
            const phoneString = phoneNumber.replace(/\D/g, '');
            if (phoneNumber.startsWith("+1") && phoneString.length === 11) {
                return `+1 (${phoneString.substr(1, 3)}) ${phoneString.substr(4, 3)}-${phoneString.substr(7)}`;
            } else if (phoneString.length === 10) {
                return `(${phoneString.substr(0, 3)}) ${phoneString.substr(3, 3)}-${phoneString.substr(6)}`;
            } else {
                return phoneNumber;
            }
        }

        let init = function () {
            let zipCode = $(SELECTOR_WHOLESALER_SEARCH_ZIP_CODE);
            if (zipCode.length) {
                $('#wholesaler-search-button').on('click', function () {
                    searchForWholesaler(zipCode.val());
                });
                $(SELECTOR_WHOLESALER_SEARCH_ZIP_CODE).on('keyup', function (e) {
                    e.preventDefault();
                    if ([key.enter, key.space].indexOf(e.key) > -1) {
                        searchForWholesaler(zipCode.val());
                    }
                });
            }
        }

        return {
            init: init
        }
    }();
})($j);
(function ($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.ResourceFilterListing = (function () {
        const TAG_SPAN_STR = "span[class=resource-filter-listing__header-text]";
        const TAG_H4_STR = "h4[class=resource-filter-listing__mobile-header-text]";
        const TAG_SPAN_STR_MOBILE = "span[class=resource-filter-listing__mobile-caption]";
        const HTML_EMPTY_DIV = "<div></div>";
        const SELECTOR_LINK_INSTRUCTIONS = "span[class=addtl-integration-link-instructions]";
        const SELECTOR_DESELECT_ALL_CHECKBOX = ".deselect-all-checkbox";
        const SELECTOR_DESELECT_ALL_TEXT = ".deselect-all-text";
        const SELECTOR_BLOCK_WRAPPER = ".resource-filter-listing__block-wrapper";
        const SELECTOR_BLOCK = "div[class*=resource-filter-listing__block";
        const SELECTOR_TPA_BLOCK = ".tpa-pseudo-block";

        const checkBoxNameArr = ["di", "fm", "tpa"];

        const currentCardCount = $(".resource-filter-listing__block").length - 1;
        const currentDICardCount = $(".resource-filter-listing__tag--orange").length;
        const currentFMCardCount = $(".resource-filter-listing__tag--turquoise").length;
        const currentTPACardCount = $(".resource-filter-listing__tag--blue").length - 1;

        const initialDIHeaderText = $(`${SELECTOR_BLOCK}--di`).eq(0).find(TAG_SPAN_STR).text();
        const initialFMHeaderText = $(`${SELECTOR_BLOCK}--fm`).eq(0).find(TAG_SPAN_STR).text();
        const initialTPAHeaderText = $(`${SELECTOR_BLOCK}--tpa`).eq(0).find(TAG_SPAN_STR).text();

        let mobileCardBreakpoint = window.matchMedia("(min-width: 0px) and (max-width: 720px)");

        const hideDupeTagsForMobile = () => {
            checkBoxNameArr.forEach((intType) => {
                let dynamicHeaderText = $(`${SELECTOR_BLOCK}--${intType}`).eq(0).find("span").text();
                const selectBlockByInt = $(`${SELECTOR_BLOCK}--${intType}]`);

                if (mobileCardBreakpoint.matches || $(window).width() < 720) {
                    selectBlockByInt.each(function (index) {
                        switch (intType) {
                            case "di":
                                dynamicHeaderText = `${initialDIHeaderText} (${currentDICardCount})`;
                                break;
                            case "fm":
                                dynamicHeaderText = `${initialFMHeaderText} (${currentFMCardCount})`;
                                break;
                            case "tpa":
                                dynamicHeaderText = `${initialTPAHeaderText} (${currentTPACardCount})`;
                        }

                        selectBlockByInt.find(TAG_H4_STR).removeClass("hidden");

                        selectBlockByInt.eq(index).find(TAG_SPAN_STR).addClass("hidden");

                        if (index >= 1) {
                            selectBlockByInt.eq(index).find(TAG_SPAN_STR_MOBILE).addClass("hidden");
                            selectBlockByInt
                                .eq(index)
                                .find(".resource-filter-listing__header-container")
                                .addClass("hidden");
                        } else {
                            selectBlockByInt.eq(index).find(TAG_H4_STR).css("display", "block");
                            selectBlockByInt.eq(index).find(TAG_H4_STR).removeClass("hidden");
                            selectBlockByInt.eq(index).find(TAG_H4_STR).text(dynamicHeaderText);
                            $(this).css("margin-top", "10px");
                        }
                    });
                } else {
                    selectBlockByInt.find(TAG_H4_STR).css("display", "none");
                    selectBlockByInt.find("span").removeClass("hidden");
                    selectBlockByInt.css("margin-top", "0px");
                    selectBlockByInt.find(".resource-filter-listing__header-container").removeClass("hidden");

                    switch (intType) {
                        case "di":
                            selectBlockByInt.find(TAG_SPAN_STR).text(initialDIHeaderText);
                            break;
                        case "fm":
                            selectBlockByInt.find(TAG_SPAN_STR).text(initialFMHeaderText);
                            break;
                        case "tpa":
                            selectBlockByInt.find(TAG_SPAN_STR).text(initialTPAHeaderText);
                    }
                }
            });
        };

        const shuffleAddtlCardsForMobile = () => {
            $(`.mobile-shuffle-card`).each(function () {
                if (mobileCardBreakpoint.matches) {
                    $(this).css({ "max-width": "320px", "text-align": "center", "vertical-align": "center" });
                    checkBoxNameArr.forEach((intType) => {
                        if ($(this).hasClass(`resource-filter-listing__block--${intType}`)) {
                            $(this)
                                .detach()
                                .appendTo(`.resource-filter-listing__block--${intType} div:last`)
                                .after(HTML_EMPTY_DIV);
                            $(`.mobile-shuffle-card--${intType}`)
                                .find(SELECTOR_LINK_INSTRUCTIONS)
                                .addClass("hidden");
                            $(`.mobile-shuffle-card--${intType}`)
                                .find(SELECTOR_LINK_INSTRUCTIONS)
                                .eq(0)
                                .removeClass("hidden");
                        }
                        if (intType === "tpa") {
                            $(SELECTOR_TPA_BLOCK).removeClass("hidden");
                        }

                        if ($(window).width() < 720) {
                            $(`.mobile-shuffle-card--tpa`)
                                .find(SELECTOR_LINK_INSTRUCTIONS)
                                .addClass("hidden");
                        }
                    });
                } else {
                    $(this)
                        .detach()
                        .appendTo(".resource-filter-listing__additional-options-block-sub-wrapper");
                    $(this).css({ "max-width": "438px" });
                    $(SELECTOR_LINK_INSTRUCTIONS).addClass("hidden");
                }
            });
        };

        const displayIntegrationCountMsg = () => {
            const hiddenShuffleCards =
                $(`.mobile-shuffle-card--di:hidden`).length +
                $(`.mobile-shuffle-card--fm:hidden`).length +
                $(`.mobile-shuffle-card--tpa:hidden`).length;
            const currentCardCount2 = $(".resource-filter-listing__block").length - 1;
            let visibleCards =
                currentCardCount2 -
                ($(`.resource-filter-listing__block-sub-wrapper > :hidden`).length + hiddenShuffleCards);
            $("#insert-count")
                .html(`Showing all ${visibleCards} out of ${currentCardCount2}  integrations by type. 
            <span class = "integration-msg-mobile"> For integration setup, please use the text link inside the cards below.</span>`);
        };

        const toggleIntegrationsByType = () => {
            checkBoxNameArr.forEach((intType) => {
                const thisCheck = $(`.${intType}-checkbox`);
                $(document.body).on("click", thisCheck, () => {
                    if (thisCheck.is(":checked")) {
                        $(SELECTOR_DESELECT_ALL_CHECKBOX).prop("checked", false);
                        $(`.resource-filter-listing__block--${intType}`).removeClass("hidden");
                        $(`.addtl-integration-desktop-container`).removeClass("hidden");
                        $(`.integration-result-header-container`).removeClass("hidden");
                        $(SELECTOR_BLOCK_WRAPPER).removeClass("hidden");
                        if (!mobileCardBreakpoint.matches) {
                            $(SELECTOR_TPA_BLOCK).addClass("hidden");
                        }
                    } else {
                        $(`.resource-filter-listing__block--${intType}`).addClass("hidden");
                    }
                    displayIntegrationCountMsg();
                    if ($(".select-integration-type-container").find("input:checked").length === 0) {
                        $(SELECTOR_DESELECT_ALL_TEXT).text("Select All");
                        $(SELECTOR_DESELECT_ALL_CHECKBOX).prop("checked", false);
                    } else {
                        $(SELECTOR_DESELECT_ALL_TEXT).text("Deselect All");
                        $(SELECTOR_DESELECT_ALL_CHECKBOX).prop("checked", true);
                    }
                });
            });
        };

        const toggleAllIntegrationTypes = () => {
            const thisDeselectAllCheck = $(SELECTOR_DESELECT_ALL_CHECKBOX);

            $(document.body).on("click", SELECTOR_DESELECT_ALL_CHECKBOX, () => {
                if (
                    thisDeselectAllCheck.is(":checked") &&
                    $(".select-integration-type-container").find("input:checked").length === 0
                ) {
                    checkBoxNameArr.forEach((intType) => {
                        $(`.${intType}-checkbox`).prop("checked", true);
                        $(`.resource-filter-listing__block--${intType}`).removeClass("hidden");
                        $(SELECTOR_DESELECT_ALL_TEXT).text("Deselect All");
                        $(SELECTOR_BLOCK_WRAPPER).removeClass("hidden");
                        $(`.integration-result-header-container`).removeClass("hidden");
                        if (!mobileCardBreakpoint.matches) {
                            $(SELECTOR_TPA_BLOCK).addClass("hidden");
                            $(`.addtl-integration-desktop-container`).removeClass("hidden");
                        }
                    });
                } else {
                    checkBoxNameArr.forEach((intType) => {
                        $(`.${intType}-checkbox`).prop("checked", false);
                        $(`.resource-filter-listing__block--${intType}`).addClass("hidden");
                        $(SELECTOR_DESELECT_ALL_TEXT).text("Select All");
                        $(SELECTOR_DESELECT_ALL_CHECKBOX).css("accent-color", "#fff");
                        $(SELECTOR_BLOCK_WRAPPER).addClass("hidden");
                        $(`.addtl-integration-desktop-container`).addClass("hidden");
                        $(`.integration-result-header-container`).addClass("hidden");
                    });
                }
            });

            $(SELECTOR_DESELECT_ALL_CHECKBOX).click(function () {
                displayIntegrationCountMsg();
            });
        };

        const sortCardsByClass = (suffix) => {
            const searchObject = $(`div[class*='resource-filter-listing__block--${suffix}']`);
            const elem = $(".resource-filter-listing__block-sub-wrapper")
                .find(searchObject)
                .sort((a, b) => {
                    return a.className < b.className;
                });
            $(".resource-filter-listing__block-sub-wrapper").append(elem);
        };

        const sortAllCards = () => {
            checkBoxNameArr.forEach((intType) => {
                sortCardsByClass(intType);
            });
        };

        const intialCardCounter = () => {
            $("#di-card-count").text(`(${currentDICardCount})`);
            $("#fm-card-count").text(`(${currentFMCardCount})`);
            $("#tpa-card-count").text(`(${currentTPACardCount})`);
            $("#insert-count")
                .html(`Showing all ${currentCardCount} out of ${currentCardCount}  integrations by type.
                <span class = "integration-msg-mobile"> For integration setup, please use the text link inside the cards below.</span>`);
        };

        mobileCardBreakpoint.addEventListener("change", () => {
            hideDupeTagsForMobile();
            shuffleAddtlCardsForMobile();

            if (!mobileCardBreakpoint.matches) {
                $(SELECTOR_TPA_BLOCK).addClass("hidden");
            }
        });

        const init = function () {
            var resourceFilterListing = $(".resource-filter-listing");
            if (resourceFilterListing.length > 0) {
                intialCardCounter();
                toggleIntegrationsByType();
                toggleAllIntegrationTypes();
                sortAllCards();
                hideDupeTagsForMobile();
                shuffleAddtlCardsForMobile();
            }
        };

        return {
            init: init,
        };
    })();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.SocialShare = function() {
        function setShareLink() {
            var extPagePath = window.location.href;
            var shareLocation = $(this).data("aaName");
            var shareLinkCorrect = this.href.indexOf("jackson.com");

            var emailSubject = "subject=" + encodeURIComponent(window.pageTitle);
            var emailBody = "&body=View Here " + encodeURIComponent(extPagePath);

            if ((shareLocation == 'email') && (shareLinkCorrect == -1)){
                this.href +=  emailSubject + emailBody;
            } else if (shareLinkCorrect == -1) {
                this.href += extPagePath;
            }
        }
        
        var init = function() {
            $(document.body).on('click', '.share-tool a', setShareLink);
        }
        
        return {
            init : init
        }
    }();
})($j);
let productExclusionQueryParamVal = '';

(function ($, window, document) {
    window.JCOM = window.JCOM || {};
    window.JCOM.PersonaHeader = function () {

        const SELECTOR_PERSONA_HEADER = '.persona-header';
        const SELECTOR_RILA_TOOL = '#rila-tool';
        // Accessibility Helpers - Scenarios Tab
        $('#scenarios-tab').each(function () {
            $(this).attr('aria-live', 'polite');
        })

        let personaElements;

        let baseIFrameUrl = $('.external iframe').attr('src');

        let hidePersonas = function () {
            personaElements.parent(SELECTOR_PERSONA_HEADER).addClass('hidden');
        };

        let showPersona = function (persona) {
            hidePersonas();
            personaElements.filter('[data-persona-id="' + persona + '"]').parent(SELECTOR_PERSONA_HEADER).removeClass('hidden');
            $('[data-scenario-id="' + persona + '"]').parent().addClass('active');
        };

        let updateRILAIframeResults = function (scenarioId) {
            let rilaTool = $(SELECTOR_RILA_TOOL);
            /* Only run this code for persona interactions tied to RILA tool */
            if (rilaTool.length) {
                let personaJson = $('data[id="' + scenarioId + '_persona_json"]');
                let newUrl = baseIFrameUrl + '?investmentAmount=' + personaJson.data('investment-amount') + productExclusionQueryParamVal + '&results=true&persona=[' + personaJson.text().slice(0, -1) + ']';
                rilaTool.prop('src', newUrl);
            }
        }

        let updateInitialView = function () {
            if (!('authorRunMode' in window)) {
                personaElements.not(':eq(0)').parent(SELECTOR_PERSONA_HEADER).addClass('hidden');
            }
        };

        let attachEventListeners = function () {
            $(document.body).on('persona-select', function (event, personaId) {
                showPersona(personaId);
                updateUrlQueryParam(document.location.href, 'persona', determinePersonaIndex(personaId));
            });

            if ($(SELECTOR_RILA_TOOL).length) {
                if (window.ContextHub && ContextHub.SegmentEngine) {
                    ContextHubJQ(function() {
                        ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                            setProductExclusions();
                        });
                    });
                }
                setProductExclusions();

                $('.persona-header__content .primary-cta-button').on('click', function (event) {
                    event.preventDefault();
                    let scenarioId = $(this).parents('.persona-header__content').attr('data-persona-id');
                    updateUrlQueryParam(document.location.href, 'persona', determinePersonaIndex(scenarioId));

                    let destination = document.location.pathname + document.location.search + '#tool';
                    window.location = destination;
                    showPersona(scenarioId);
                    updateRILAIframeResults(scenarioId);
                });
            }
        };

        let setProductExclusions = function () {
            let jacksonCookie;
            let v = document.cookie.match('(^|;) ?jackson=([^;]*)(;|$)');
            let cookie = v ? v[2] : null;
            if (cookie != null) {
                try {
                    jacksonCookie = JSON.parse(atob(cookie.split(/\./)[1]));
                } catch (e) { }
            }
            let productExclusionVal;
            if (typeof jacksonCookie !== 'undefined' && jacksonCookie != null && !jacksonCookie.firm && jacksonCookie.jacksonhub === 'statefarm') {
                // Temporary workaround to exclude advisory products if a user is authenticated through internal SSO for StateFarm
                productExclusionVal = 'advisory';
            } else {
                productExclusionVal = getProductExclusionValue(jacksonCookie);
            }
            if (productExclusionVal && productExclusionVal.length > 0 && !productExclusionQueryParamVal.includes('excludeProducts=')) {
                productExclusionQueryParamVal = "&excludeProducts=" + productExclusionVal;
            } 
            if (typeof jacksonCookie !== 'undefined' && jacksonCookie !== null && jacksonCookie.firm !== null && jacksonCookie.firm === 'CHASE' && !productExclusionQueryParamVal.includes('firm=chase')) {
                productExclusionQueryParamVal += "&firm=chase";
            }
        };

        let getProductExclusionValue = function (jCookie) {
            let result;
            let jwtTokenString = "PUBLIC";
            let navCookie = getCookie('NAV_COOKIE');

            if (jCookie || navCookie === riaEntryUrl) {
                let urlArray = [];
                let marketLinkProUrl = '/annuities/registered-index-linked-annuities.html#marketlinkpro-iii';
                let marketLinkProAdvisoryUrl =
                    '/annuities/registered-index-linked-annuities.html#marketlinkpro-advisory-iii';
                urlArray.push(marketLinkProUrl);
                urlArray.push(marketLinkProAdvisoryUrl);
                jwtTokenString = navCookie === riaEntryUrl ? riaEntryUrl : jwtTokenString;

                $.ajax({
                    type: 'POST',
                    url: '/external/accessManagerService',
                    async: false,
                    data: 'jwtTokenString=' + jwtTokenString + '&checkUrls=' + JSON.stringify(urlArray),
                    success: function (data) {
                        if (data instanceof Array && data.length > 0) {
                            $.each(data, function (index, element) {
                                if (element.access == 'false') {
                                    if (element.url == marketLinkProUrl) {
                                        result = "nonAdvisory";
                                    } else if (element.url == marketLinkProAdvisoryUrl) {
                                        result = "advisory";
                                    }
                                }
                            });
                        }
                    },
                    error: function (msg) {
                        console.log(msg);
                    }
                });
            }
            return result;
        }

        //Update the persona query param to reflect a specific persona
        let updateUrlQueryParam = function (url, key, value) {
            let currentUrl = document.location.pathname + document.location.search;
            let hash = document.location.hash;
            let re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
            let separator = currentUrl.indexOf('?') !== -1 ? "&" : "?";
            let newHref;
            if (currentUrl.match(re)) {
                newHref = (hash === '#undefined' ? currentUrl.replace(re, '$1' + key + "=" + value + '$2') : currentUrl.replace(re, '$1' + key + "=" + value + '$2') + hash);
            }
            else {
                newHref = (hash === '#undefined' ? currentUrl + separator + key + "=" + value : currentUrl + separator + key + "=" + value + hash);
            }
            window.history.pushState({ path: newHref }, '', newHref);
        }

        let determinePersonaIndex = function (personaId) {
            let personaIndex = $("[data-persona-id='" + personaId + "']").index('.persona-header__content');
            //Incrmenting variable to translate from base 0 index
            personaIndex++;
            return personaIndex;
        }

        let init = function () {

            personaElements = $('[data-persona-id]');
            attachEventListeners();

            if ($(SELECTOR_RILA_TOOL).length === 0) {
                updateInitialView();
            }
        }

        return {
            init: init
        };

    }();

})($j, window, document);

(function($, window, document) {
    window.JCOM = window.JCOM || {};
    window.JCOM.PersonaScenario = function() {
        const ATTRIBUTE_SCENARIO_ID = 'data-scenario-id';
        const ATTRIBUTE_ARIA_SELECTED= 'aria-selected';
        const SELECTOR_PERSONA_SCENARIO = '.persona-scenario';
        const SELECTOR_ACTIVE_SCENARIO_CONTENT = '.persona-scenario.active .persona-scenario__content';
        const QUERY_INVESTMENT_AMOUNT = '?investmentAmount=';
        const INVESTMENT_AMOUNT = 'investment-amount';
        const HASH_UNDEFINED = '#undefined';
        const SELECTOR_SCENARIO_ID = '[data-scenario-id]';
        const SELECTOR_PERSONA_HEADER = '.persona-header';
        let baseIFrameUrl = $('.external iframe').attr('src');
        let rilaTool = $('#rila-tool');
        let scenarioTab = $('#scenarios-tab');
        let iframe = $('.external iframe');
        let personaElements = $('[data-persona-id]');
        let onLoadShowResults = false;

        // Add data attributes to persona cards in Overview
        let personaOptions = $('.step-progress-bar .promo-card-wrapper .promo-card');
        let addPersonaAttributes = function() {
            personaOptions.each(function() {
                personaOptions[0].setAttribute(ATTRIBUTE_SCENARIO_ID,'Optimistic American');
                personaOptions[1].setAttribute(ATTRIBUTE_SCENARIO_ID,'Cautious Globalist');
                personaOptions[2].setAttribute(ATTRIBUTE_SCENARIO_ID,'Good Neighbor');
            })
        }

        // Add data attributes to person cards in Add-on Benefits
        let personaAddOnOptions = $('.step-progress-bar #add-on-benefits-tab .cta-headline-text-wrapper');
        let addPersonaAddOnAttributes = function() {
            personaAddOnOptions.each(function() {
                personaAddOnOptions[0].setAttribute(ATTRIBUTE_SCENARIO_ID,'Cautious Globalist');
                personaAddOnOptions[1].setAttribute(ATTRIBUTE_SCENARIO_ID,'Good Neighbor');
            })
        }

        // Accessibility Helpers - Persona Selectors (Scenarios/Tool)
        let accessibilityHelpers = function() {
            let personaScenarioWrapper = $('.persona-scenario-wrapper');
            let personaSelectors = $(SELECTOR_PERSONA_SCENARIO);

            personaScenarioWrapper.each(function() {
                $(this).attr('role', 'group');
                $(this).attr('aria-label', 'Select a persona');
            })

            personaSelectors.each(function() {
                $(this).attr('role', 'button');
                $(this).attr('tabindex', '0');
                $(this).attr(ATTRIBUTE_ARIA_SELECTED, 'false');
            })
        }

        let updateIframeUrl = function() {
            /* Only run this code for persona interactions tied to Halo tool */
            if (rilaTool.length) {
                let personaId = $(SELECTOR_ACTIVE_SCENARIO_CONTENT).attr(ATTRIBUTE_SCENARIO_ID);
                let personaJson = $('data[id="'+personaId+'_persona_json"]');
                let iframeURL = "";
                /*Check if this is the inital navigation to the tool page after loading the tool using a persona query parametere */
                if (!onLoadShowResults) {
                    iframeURL = baseIFrameUrl+QUERY_INVESTMENT_AMOUNT+personaJson.data(INVESTMENT_AMOUNT)+productExclusionQueryParamVal+'&amp;persona=['+personaJson.text().slice(0, -1)+']';
                } else {
                    iframeURL = baseIFrameUrl+QUERY_INVESTMENT_AMOUNT+personaJson.data(INVESTMENT_AMOUNT)+productExclusionQueryParamVal+'&amp;results=true&amp;persona=['+personaJson.text().slice(0, -1)+']';
                    onLoadShowResults = false;
                }
                iframe.prop('src', iframeURL);
            }
        }

        let rilaUpdateIframeUrl = function() {
            let rilaTools = $('[id*="rila-tool"]');

            if (productExclusionQueryParamVal && productExclusionQueryParamVal.length > 0) {
                rilaTools.each(function () {
                    let element = $(this);

                    if (this.hasAttribute('src')) {
                        if (!element.attr('src').includes(productExclusionQueryParamVal.substring(1))) { 
                            element.attr('src', element.attr('src')+'?'+productExclusionQueryParamVal.substring(1));
                        }
                    } else if (this.hasAttribute('data-src')) {
                        element.attr('data-src', element.attr('data-src')+'?'+productExclusionQueryParamVal.substring(1));
                    }
                });
            }
        }

        let updateUrlQueryParam = function(url, key, value) {
            let currentUrl = document.location.pathname + document.location.search;
            let hash = document.location.hash;
            let re = new RegExp("([?&amp;])" + key + "=.*?(&amp;|$)", "i");
            let separator = currentUrl.indexOf('?') !== -1 ? "&amp;" : "?";
            let newHref;
            if (currentUrl.match(re)) {
                newHref = (hash === HASH_UNDEFINED ? currentUrl.replace(re, '$1' + key + "=" + value + '$2') : currentUrl.replace(re, '$1' + key + "=" + value + '$2') + hash);
            } else {
                newHref = (hash === HASH_UNDEFINED ? currentUrl + separator + key + "=" + value : currentUrl + separator + key + "=" + value + hash);
            }
            window.history.pushState({path:newHref},'',newHref);
        }

        let deleteUrlQueryParam = function(url, key) {
            let currentUrl = document.location.pathname;
            let hash = document.location.hash;
            let re = new RegExp("([?&amp;])" + key + "=.*?(&amp;|$)", "i");
            let newHref;
            if (currentUrl.match(re)) {
                newHref = (hash === HASH_UNDEFINED ? currentUrl.replace(re, '$1' + '$2').slice(0, -1) : currentUrl.replace(re, '$1' + '$2').slice(0, -1) + hash);
            } else {
                newHref = (hash === HASH_UNDEFINED ? currentUrl : currentUrl + hash);
            }
            window.history.pushState({path:newHref},'',newHref);
        }

        let determinePersonaIndex = function(personaId) {
            let personaIndex = $("[data-persona-id='" + personaId + "']").index('.persona-header__content');
            //Incrmenting variable to translate from base 0 index
            personaIndex++;
            return personaIndex;
        }

        // Scenarios View
        let showPersona = function (personaId) {
            $(SELECTOR_SCENARIO_ID).parent().removeClass('active').attr(ATTRIBUTE_ARIA_SELECTED, 'false');
            $('[data-scenario-id="' + personaId + '"]').parent().addClass('active').attr(ATTRIBUTE_ARIA_SELECTED, 'true');
        }

        let handleOverviewPromoNavigation = function (selectedPersona) {
            updateUrlQueryParam(document.location.href, 'persona', determinePersonaIndex(selectedPersona));
            let destination = document.location.pathname + document.location.search + '#scenarios';
            // Navigate to Scenarios view and select persona header and content
            window.location = destination;
            showPersona(selectedPersona);
            personaElements.parent(SELECTOR_PERSONA_HEADER).addClass('hidden');
            personaElements.filter('[data-persona-id="' + selectedPersona + '"]').parent(SELECTOR_PERSONA_HEADER).removeClass('hidden');
            //If a different persona was selected after loading the page with a persona query parameter set the show results variable to false
            if (onLoadShowResults) onLoadShowResults = false;
        }

        let handleSelectedPersona = function(selectedPersona) {
            $(document.body).trigger('persona-select', $(SELECTOR_SCENARIO_ID, selectedPersona).attr(ATTRIBUTE_SCENARIO_ID));
            //If a different persona was selected after loading the page with a persona query parameter set the show results variable to false
            if (onLoadShowResults) onLoadShowResults = false;
        }

        let attachEventListeners = function () {
            // Overview event listeners
            $('.step-progress-bar *[data-scenario-id] .primary-cta-button').on('click', function (event) {
                if (scenarioTab.length) {
                    event.preventDefault();
                    let selectedPersona = event.currentTarget.closest(SELECTOR_SCENARIO_ID).dataset.scenarioId;
                    handleOverviewPromoNavigation(selectedPersona);
                }
            });

            // Scenarios event listeners
            $(SELECTOR_PERSONA_SCENARIO).on('click', function (event) {
                let selectedPersona = event.currentTarget;
                handleSelectedPersona(selectedPersona);
            });

            $(SELECTOR_PERSONA_SCENARIO).on('keypress', function (event) {
                if (
                    event.key === window.JCOM.Utility.Constants.Key.space ||
                    event.key === window.JCOM.Utility.Constants.Key.enter
                ) {
                    let selectedPersona = event.currentTarget;
                    handleSelectedPersona(selectedPersona);
                }
            });

            $(document.body).on('persona-select', function (event, personaId) {
                showPersona(personaId);
                updateUrlQueryParam(document.location.href, 'persona', determinePersonaIndex(personaId));
                //If a different persona was selected after loading the page with a persona query parameter set the show results variable to false
                if(onLoadShowResults) onLoadShowResults = false;
            });

            // Reset persona selections when Halo tool is updated
            $(window).on('message', function(e) {
                if (e.originalEvent.data.message === 'allocation-reset' || e.originalEvent.data.message === 'allocation-added' || e.originalEvent.data.message === 'allocation-deleted' || e.originalEvent.data.message === 'allocation-changed') {
                    $('.persona-scenario.active').removeClass('active');
                    $('.persona-header.hidden').removeClass('hidden'); // Affects persona-header component
                    //Remove persona query string from url when persona is cleared
                    deleteUrlQueryParam(document.location.href, 'persona');
                    if (e.originalEvent.data.message === 'allocation-reset') {
                        iframe.prop('src', baseIFrameUrl + '?investmentAmount=100000')
                    }
                }
            });

            $('#tool').on('click', function () {
                updateIframeUrl();
            });
        };

        let init = function () {
            addPersonaAttributes();
            addPersonaAddOnAttributes();
            accessibilityHelpers();
            attachEventListeners();

            if (window.ContextHub && ContextHub.SegmentEngine) {
            	ContextHubJQ(function() {
            		ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
            			rilaUpdateIframeUrl();
            		});
            	});
            }
            rilaUpdateIframeUrl();
        }

        return {
            init: init
        };

    }();

})($j, window, document);

var JCOM = JCOM || {};
var safariBetweenViewportBreakpoint = window.matchMedia("(min-width: 1000px) and (max-width: 1025px)");

function showBackgroundMask(forceHiddenOverflow) {
	$('#background-mask').show();
	
	if(forceHiddenOverflow == undefined) {
		forceHiddenOverflow = false;
	}

    if(JCOM.Constants.isSafari && safariBetweenViewportBreakpoint.matches && !forceHiddenOverflow) {
        $('body').css('position','fixed').css('overflow-y','scroll');
    } else {
		$('body').css('overflow','hidden').css('padding-right','17px');
    }
}

function hideBackgroundMask() {
	$('#background-mask').hide();
    $('body').css({
    	'position' : 'static',
    	'overflow-y' : 'auto',
    	'overflow' : 'auto',
    	'padding-right' : ''
    });
}

function vh(v) {
	var h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
	return (v * h) / 100;
}

function vw(v) {
	var w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
	return (v * w) / 100;
}
(function ($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.SupplierManagement = (function () {

        const SELECTOR_FORM = '.supplier-registration-form, .supplier-update-form';
        const COMPANY_PREFIX = 'company';
        const PRIMARY_CONTACT_PREFIX = 'primaryContact';
        const ADDRESS_FIELDS = ['StreetAddress', 'City', 'State', 'ZipCode'];
        const SYNC_ADDRESS_CHECKBOX = '[name="addressSameAsCorpAddress"]';
        const DROWPDOWN_FIELD = 'select.cmp-form-options__field';

        $(document).on('change', SYNC_ADDRESS_CHECKBOX, function(event) {
            let target = $(event.target);
            if (target.is(':checked')) {
                syncAddressCheck();
            } else {
                syncAddressUncheck();
            }
        });

        const syncAddressCheck = function() {
            for (let field of ADDRESS_FIELDS) {
                let companyField = $("[name='" + COMPANY_PREFIX + field + "']");
                setSyncFieldValue(companyField, field);
                companyField.on('input', syncAddressUpdate);
            }
        };

        const syncAddressUncheck = function() {
            for (let field of ADDRESS_FIELDS) {
                let syncField = $("[name='" + PRIMARY_CONTACT_PREFIX + field + "']");
                syncField.val("");
                syncField.off('input', syncAddressUpdate);
                if (syncField.is(DROWPDOWN_FIELD)) {
                    syncField.removeAttr('hidden');
                } else {
                    syncField.prop('type', 'text');
                }
            }
        };

        const setSyncFieldValue = function(companyField, fieldName) {
            let syncField = $("[name='" + PRIMARY_CONTACT_PREFIX + fieldName + "']");
            syncField.parent().removeClass('invalid');
            if (companyField.is(DROWPDOWN_FIELD)) {
                syncField.val(companyField.val()).prop('selected', true);
                syncField.attr('hidden', true);
            } else {
                syncField.val(companyField.val());
                syncField.prop('type', 'hidden');
            }
        };

        const syncAddressUpdate = function(event) {
            let target = $(event.target);
            let field = target.attr("name").substring(COMPANY_PREFIX.length);
            setSyncFieldValue(target, field);
        };

        const supplierManagementResetHandler = function (event) {
            window.JCOM.Validation.resetForm(event);
            $(SYNC_ADDRESS_CHECKBOX).prop('checked', false);
            syncAddressUncheck();
            $(':focusable', SELECTOR_FORM)[0].focus();
        };

        const attachEventListeners = () => {
            $('button[name=submit]', SELECTOR_FORM).on('click', window.JCOM.Validation.submitForm);
            $('button[name=reset]', SELECTOR_FORM).on('click', supplierManagementResetHandler);
        };

        const init = () => {
            attachEventListeners();
        };

        return {
            init: init,
        };
    })();
})($j);

(function ($) {
    window.JCOM = window.JCOM || {};

    window.JCOM.FpSiteWelcomeContent = (function () {
       const dialog = document.querySelector(".auto-open-dialog-container .auto-open-dialog");     

        const scrollToElement = function () {
            window.scrollTo({
                top: 0,
                behavior: 'smooth',
            });
        };
     
        const setCookie = function () {
             const futureDate = new Date();
            futureDate.setFullYear(futureDate.getFullYear() + 20);
            document.cookie = 'FPSiteWelcome=' + 'shown' + '; expires=' + futureDate.toGMTString() + '; path=/';
        }

        const updateFPWelcomeContentVisibility = function (e) {
            const hash = window.location.hash;

            if (hash === '#closeDialog') {
                if (e !== undefined) {
                    e.preventDefault();
                }
                dialog.close();
                history.replaceState(null, null, ' ');
            } else if (hash === '#fpDialog') {
                if (e !== undefined) {
                    e.preventDefault();
                }
                dialog.showModal();
                history.replaceState(null, null, ' ');
            }
        };

        const attachFPWelcomContentListeners = function () {
            //X button Close onclick
            $('.auto-open-dialog-container .controls .close').on('click', function (e) {
                e.preventDefault();
                dialog.close();
                history.replaceState(null, null, ' ');
            });

            //Hash change event to open or close dialog
            $(window).on('hashchange', updateFPWelcomeContentVisibility);
        };

        const init = function () {
            attachFPWelcomContentListeners();

            //Check if OptanonAlertBoxClosed cookie is set, if its not let that message show and not the FP welcome dialog
            const OptanonAlertBoxClosedCookie = getCookie('OptanonAlertBoxClosed');
            if (OptanonAlertBoxClosedCookie === null || OptanonAlertBoxClosedCookie === '') {
                return;
            }

            const OptanonConsentCookie = getCookie('OptanonConsent');
            if (OptanonConsentCookie !== 'undefined' && OptanonConsentCookie.indexOf('C0003:1') === -1 && OptanonConsentCookie.indexOf('CC0003%3A1') === -1) {
                // If the cookie is set and does not contain the required consent, do not show the dialog
                return;
            }
             
            //Only want to show the fp welcome dialog once so checking for cookie
            let cookieValue = getCookie('FPSiteWelcome');
            if (cookieValue === 'shown') {
                return;
            }

            if (dialog.length < 1) {
                return;
            }

            dialog.showModal();
            setCookie();
            scrollToElement();
        };

        return {
            init: init,
        };
    })();
})($j);

(function($) {
    window.JCOM = window.JCOM || {};
    window.JCOM.NotificationMessage = function() {

        var checkForIe11NotificationMessage = function() {
            var ua = window.navigator.userAgent;
            //IE 11 Check
            if (ua.indexOf('Trident/') > 0) {
                $(".notification-message__wrapper--ie11").css("display", "flex");
            }
        };
        
        var init = function () {
            checkForIe11NotificationMessage();
        };

        return {
            init : init
        }
    }();
})($j);
(function($) {
    window.JCOM = window.JCOM || {};
    function hideSocialLinksForChase() {
        if (typeof jacksonCookie !== 'undefined' && jacksonCookie !== null && jacksonCookie.firm !== null && jacksonCookie.firm === 'CHASE') {
            $('.social-links').addClass('hidden')
        }
    }
    $('a[href*="_tel_"]').each(function () {
		var element = $(this);
        element.attr('href', element.attr('href').replace('_tel_','tel:'));
    });
    if (window.ContextHub && ContextHub.SegmentEngine) {
        ContextHubJQ(function() {
            ContextHub.eventing.on(ContextHub.Constants.EVENT_TEASER_LOADED, function(event, data){
                hideSocialLinksForChase();
            });
        });
    }
    hideSocialLinksForChase();
    $.each(window.JCOM, function(key, obj) {
        if(obj.init) {
            try {
                obj.init();
            } catch (e) {
                console.log('init failed');
            }
        }
    });
})($j);



